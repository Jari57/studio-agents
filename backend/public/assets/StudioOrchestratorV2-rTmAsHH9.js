const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PreviewModal-DotGS0b2.js","assets/react-vendor-03wl4UEb.js","assets/vendor-DPgDnBIk.js","assets/StudioView-BfdKxcrP.js","assets/index-CeFgmZMl.js","assets/constants-hRVrvfLk.js","assets/icons-DT0eBrXO.js","assets/index-BQbz1uWo.css","assets/firebase-DgNc3hGb.js","assets/firebase-C6j5ZoHL.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-CeFgmZMl.js";import{r as i,z as t,j as r,R as o}from"./react-vendor-03wl4UEb.js";import{A as a,B as n,g as l}from"./constants-hRVrvfLk.js";import{d as s,a as d}from"./firebase-DgNc3hGb.js";import{x as c,f as p,y as u,z as g,A as x,g as m,u as b,B as y,C as h}from"./firebase-C6j5ZoHL.js";import{f,a as v,b as j}from"./StudioView-BfdKxcrP.js";import{Z as S,X as w,p as k,v as C,S as z,aS as I,$ as R,n as U,aT as T,M as D,Q as $,U as A,K as V,a0 as B,u as W,a8 as F,z as E,W as P,ac as O,I as M,ap as N,aq as L,aP as H,a7 as G,al as Y,e as J,V as _,ab as q,ad as K}from"./icons-DT0eBrXO.js";import"./vendor-DPgDnBIk.js";const Q=o.lazy(()=>e(()=>import("./PreviewModal-DotGS0b2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),X=e=>{if(!e)return{intro:"",content:""};if("string"!=typeof e)return{intro:"",content:JSON.stringify(e,null,2)};const i=[/\[Verse/i,/\[Chorus/i,/\[Hook/i,/\[Bridge/i,/\[Intro/i,/\[Lyrics/i,/\[Style/i,/\[Hard/i,/\[Soft/i,/\[Fast/i,/\[Slow/i,/\(Verse/i,/\(Chorus/i,/Verse \d+:/i,/Chorus:/i,/Hook:/i,/^\s*Lyrics:\s*$/im,/Visual:/i,/Concept:/i,/Description:/i,/Beat Description:/i,/BPM:/i,/Storyboard:/i,/^\[[A-Z]/];let t=-1;for(const o of i){const i=e.match(o);i&&(-1===t||i.index<t)&&(t=i.index)}if(-1!==t)return{intro:e.substring(0,t).trim(),content:e.substring(t).trim()};const r=[/^Sure! Here (is|are) some (lyrics|content|a song).*:/i,/^Here (is|are) (the|your) (lyrics|song).*:/i,/^Okay, here's a concept.*:/i];for(const o of r)if(o.test(e)){const i=e.match(o);return{intro:i[0].trim(),content:e.substring(i[0].length).trim()}}if(e.includes("Summary:")){const i=e.split("Summary:");return{intro:i[0].trim(),content:("Summary: "+i[1]).trim()}}return{intro:"",content:e}},Z={Trap:{bpm:140,mood:"Dark",structure:"Full Song",duration:180},Drill:{bpm:140,mood:"Dark",structure:"Full Song",duration:180},"Modern Hip-Hop":{bpm:130,mood:"Energetic",structure:"Full Song",duration:180},"90s Boom Bap":{bpm:90,mood:"Chill",structure:"Full Song",duration:180},"R&B / Soul":{bpm:100,mood:"Dreamy",structure:"Full Song",duration:180},Pop:{bpm:120,mood:"Happy",structure:"Full Song",duration:180},Rock:{bpm:130,mood:"Energetic",structure:"Full Song",duration:180},"Electronic / EDM":{bpm:128,mood:"Energetic",structure:"Full Song",duration:180},"Lo-Fi":{bpm:80,mood:"Chill",structure:"Loop",duration:120},Afrobeat:{bpm:110,mood:"Energetic",structure:"Full Song",duration:180},Reggaeton:{bpm:95,mood:"Energetic",structure:"Full Song",duration:180},"K-Pop":{bpm:125,mood:"Happy",structure:"Full Song",duration:180},"J-Pop":{bpm:130,mood:"Happy",structure:"Full Song",duration:180},Amapiano:{bpm:113,mood:"Chill",structure:"Full Song",duration:180},Phonk:{bpm:140,mood:"Dark",structure:"Full Song",duration:180},Dancehall:{bpm:100,mood:"Energetic",structure:"Full Song",duration:180},"Latin Trap":{bpm:140,mood:"Dark",structure:"Full Song",duration:180},Country:{bpm:110,mood:"Happy",structure:"Full Song",duration:180},Jazz:{bpm:120,mood:"Chill",structure:"Full Song",duration:180},Classical:{bpm:100,mood:"Epic",structure:"Full Song",duration:240},Gospel:{bpm:110,mood:"Epic",structure:"Full Song",duration:180},Reggae:{bpm:80,mood:"Chill",structure:"Full Song",duration:180},Metal:{bpm:160,mood:"Dark",structure:"Full Song",duration:180},Punk:{bpm:170,mood:"Energetic",structure:"Full Song",duration:120},Funk:{bpm:110,mood:"Energetic",structure:"Full Song",duration:180},Disco:{bpm:120,mood:"Happy",structure:"Full Song",duration:180},Synthwave:{bpm:118,mood:"Dreamy",structure:"Full Song",duration:180},Indie:{bpm:115,mood:"Dreamy",structure:"Full Song",duration:180},Acoustic:{bpm:100,mood:"Chill",structure:"Full Song",duration:180},Bollywood:{bpm:130,mood:"Energetic",structure:"Full Song",duration:180},"Afro-Pop":{bpm:105,mood:"Happy",structure:"Full Song",duration:180},Cumbia:{bpm:95,mood:"Happy",structure:"Full Song",duration:180}},ee=Object.keys(Z),ie=["English","Spanish","French","German","Japanese","Korean","Portuguese","Chinese (Mandarin)","Chinese (Cantonese)","Hindi","Arabic","Turkish","Russian","Italian","Dutch","Swedish","Norwegian","Danish","Finnish","Polish","Czech","Greek","Hebrew","Thai","Vietnamese","Indonesian","Malay","Filipino/Tagalog","Swahili","Yoruba","Zulu","Amharic","Persian/Farsi","Urdu","Bengali","Tamil","Telugu","Punjabi","Ukrainian","Romanian","Hungarian","Croatian","Serbian"],te={"Full Song Release":{duration:180,structure:"Full Song",outputFormat:"music",useBars:!1,icon:"ðŸ’¿"},"TikTok / Reels":{duration:30,structure:"Chorus",outputFormat:"social",useBars:!1,icon:"ðŸ“±"},"YouTube Music Video":{duration:180,structure:"Full Song",outputFormat:"music",useBars:!1,icon:"ðŸŽ¬"},"Spotify Single":{duration:180,structure:"Radio Edit",outputFormat:"music",useBars:!1,icon:"ðŸŽ§"},"Ad / Commercial":{duration:30,structure:"Loop",outputFormat:"tv",useBars:!1,icon:"ðŸ“º"},"Podcast Intro":{duration:15,structure:"Intro",outputFormat:"podcast",useBars:!1,icon:"ðŸŽ™ï¸"},"Instagram Story":{duration:15,structure:"Chorus",outputFormat:"social",useBars:!1,icon:"ðŸ“·"},"DJ Loop":{duration:60,structure:"Loop",outputFormat:"music",useBars:!0,icon:"ðŸŽ›ï¸"}},re=({height:e="14px",width:i="100%",marginBottom:t="8px",opacity:o=.1})=>r.jsx("div",{style:{height:e,width:i,marginBottom:t,borderRadius:"4px",background:`linear-gradient(90deg, rgba(255,255,255,${o}) 25%, rgba(255,255,255,${2*o}) 50%, rgba(255,255,255,${o}) 75%)`,backgroundSize:"200% 100%",animation:"shimmer 2s infinite linear"}});function oe({slot:e,agentId:n,icon:s,title:d,subtitle:c,color:p,output:u,isLoading:g,mediaType:x=null,mediaUrl:m=null,onGenerateMedia:b=null,isGeneratingMedia:y=!1,onRegenerate:h=null,onEdit:k=null,onDelete:z=null,onDownload:I=null,onSpeak:T=null,isSpeaking:A=!1,onMaximize:W=null,onUploadDna:E=null,onClearDna:N=null,dnaUrl:L=null,isUploadingDna:H=!1,provider:G=null}){const[Z,ee]=i.useState(!1),[ie,te]=i.useState(!1),[oe,ae]=i.useState(u||""),[ne,le]=i.useState(!1),[se,de]=i.useState(!1),{intro:ce,content:pe}=X(u),ue=se?ce:pe,[ge,xe]=i.useState("undefined"!=typeof window&&window.innerWidth<768);i.useEffect(()=>{const e=()=>xe(window.innerWidth<768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const me=i.useRef(u);i.useEffect(()=>{me.current!==u&&(me.current=u,ae(u||""))},[u]);const be=a.find(e=>e.id===n),ye=be?l(be):p;return r.jsxs("div",{className:`generator-card-unified ${be?.colorClass||""}`,style:{minHeight:ge?"auto":"380px",padding:0,touchAction:"manipulation",WebkitTapHighlightColor:"transparent",borderTop:`3px solid ${ye}`},children:[r.jsx("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:`radial-gradient(circle at center, ${ye}08 0%, transparent 50%)`,pointerEvents:"none"}}),r.jsxs("div",{className:"generator-card-header",style:{padding:ge?"8px":"1.25rem",display:"flex",alignItems:"center",gap:ge?"10px":"12px",position:"relative",zIndex:1},children:[r.jsx("div",{className:"generator-icon-box",children:o.createElement(s,{size:ge?20:24})}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("h3",{style:{margin:0,fontSize:ge?"0.95rem":"1.125rem",fontWeight:"700",color:"white",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d}),r.jsxs("p",{style:{margin:"2px 0 0",fontSize:"0.75rem",color:"var(--text-secondary)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"6px"},children:[be?.name||c,be?.isBeta&&r.jsx("span",{style:{fontSize:"0.6rem",padding:"1px 5px",background:"rgba(245, 158, 11, 0.1)",color:"#f59e0b",borderRadius:"4px",border:"1px solid rgba(245, 158, 11, 0.2)",fontWeight:"800",letterSpacing:"0.05em"},children:"BETA"})]}),be?.capabilities&&be.capabilities.length>0&&r.jsxs("div",{className:"agent-cap-pills",style:{display:"flex",gap:"4px",flexWrap:"wrap",marginTop:"4px"},children:[be.category&&r.jsx("span",{style:{padding:"1px 5px",background:`${ye}1A`,color:ye,borderRadius:"4px",fontSize:"0.55rem",fontWeight:"600"},children:be.category}),be.capabilities.slice(0,2).map((e,i)=>r.jsx("span",{style:{padding:"1px 5px",background:"rgba(255,255,255,0.06)",color:"var(--text-secondary)",borderRadius:"4px",fontSize:"0.55rem"},children:e},i)),L&&r.jsx("span",{style:{padding:"1px 6px",background:"rgba(34, 197, 94, 0.15)",color:"#22c55e",borderRadius:"4px",fontSize:"0.55rem",fontWeight:"700",border:"1px solid rgba(34, 197, 94, 0.3)"},children:"DNA REF"}),G&&!g&&(u||m)&&(()=>{const e={"elevenlabs-premium":{label:"ElevenLabs",tier:"Premium",color:"#818cf8"},elevenlabs:{label:"ElevenLabs",tier:"Premium",color:"#818cf8"},"gemini-tts":{label:"Gemini TTS",tier:"Standard",color:"#60a5fa"},bark:{label:"Bark",tier:"Standard",color:"#60a5fa"},suno:{label:"Suno",tier:"Premium",color:"#818cf8"},udio:{label:"Udio",tier:"Premium",color:"#818cf8"},"replicate-flux":{label:"Flux",tier:"Premium",color:"#818cf8"},"flux-1.1-pro":{label:"Flux Pro",tier:"Premium",color:"#818cf8"},"nano-banana":{label:"Gemini",tier:"Standard",color:"#60a5fa"},"imagen-4":{label:"Imagen 4",tier:"Premium",color:"#818cf8"},"veo-3.0-fast":{label:"Veo 3.0",tier:"Premium",color:"#818cf8"},"veo-2.0":{label:"Veo 2.0",tier:"Standard",color:"#60a5fa"},"replicate-minimax":{label:"Minimax",tier:"Standard",color:"#60a5fa"}}[G]||{label:G,tier:"",color:"#94a3b8"};return r.jsxs("span",{style:{padding:"1px 6px",background:`${e.color}1A`,color:e.color,borderRadius:"4px",fontSize:"0.55rem",fontWeight:"600",border:`1px solid ${e.color}33`},children:[e.label,e.tier?` (${e.tier})`:""]})})()]})]}),E&&r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[r.jsx("input",{type:"file",id:`dna-upload-${e}`,accept:"audio"===e?"audio/*":"lyrics"===e?".txt,.doc,.docx,.pdf":"image/*",onChange:E,style:{display:"none"}}),r.jsxs("button",{onClick:()=>document.getElementById(`dna-upload-${e}`).click(),disabled:H,title:`${"video"===e?"Image":e.charAt(0).toUpperCase()+e.slice(1)} DNA (Reference)`,style:{padding:"8px",borderRadius:"8px",background:L?`${p}20`:"rgba(255,255,255,0.05)",border:"1px solid "+(L?p+"80":"rgba(255,255,255,0.1)"),color:L?p:"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.2s",fontSize:"0.7rem",fontWeight:"600"},children:[H?r.jsx(C,{size:14,className:"spin"}):r.jsx(S,{size:14}),L&&!ge&&"DNAâœ“"]}),L&&r.jsx("button",{onClick:e=>{e.stopPropagation(),N&&N()},style:{background:"none",border:"none",color:"rgba(255,255,255,0.3)",cursor:"pointer",padding:"4px"},children:r.jsx(w,{size:12})})]}),(g||y)&&r.jsxs("div",{style:{padding:"6px 12px",borderRadius:"20px",background:`${p}20`,display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx(C,{size:14,color:p,className:"spin"}),r.jsx("span",{style:{fontSize:"0.7rem",color:p,fontWeight:"600"},children:g?"Generating...":"Creating Media..."})]})]}),r.jsxs("div",{style:{flex:1,padding:ge?"10px 12px":"16px 20px",display:"flex",flexDirection:"column",gap:ge?"8px":"12px",position:"relative",zIndex:1},children:[!g&&u?r.jsx(r.Fragment,{children:ie?r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"8px"},children:[r.jsx("textarea",{value:oe,onChange:e=>ae(e.target.value),style:{flex:1,padding:ge?"8px":"12px",borderRadius:"10px",background:"rgba(0,0,0,0.3)",border:`1px solid ${p}40`,color:"white",fontSize:ge?"0.8rem":"0.9rem",lineHeight:"1.5",resize:"none",outline:"none",minHeight:"120px"},autoFocus:!0}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx("button",{onClick:()=>te(!1),style:{flex:1,padding:"8px",borderRadius:"8px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer",fontSize:"0.8rem"},children:"Cancel"}),r.jsx("button",{onClick:()=>{k&&k(oe),te(!1)},style:{flex:1,padding:"8px",borderRadius:"8px",background:p,border:"none",color:"white",cursor:"pointer",fontWeight:"600",fontSize:"0.8rem"},children:"Save"})]})]}):r.jsxs("div",{onClick:()=>le(!ne),className:"lyrics-stanza-view",style:{background:"rgba(0,0,0,0.3)",borderRadius:ge?"8px":"12px",padding:ge?"10px":"16px",flex:1,overflow:"auto",cursor:"pointer",maxHeight:ne?ge?"50vh":"400px":ge?"200px":"280px",transition:"max-height 0.3s ease",position:"relative"},children:[ce&&r.jsxs("button",{onClick:e=>{e.stopPropagation(),de(!se)},style:{position:"absolute",top:"8px",right:"8px",background:se?p:"rgba(255,255,255,0.1)",border:"none",borderRadius:"6px",padding:"4px 8px",fontSize:"0.65rem",fontWeight:"700",color:"white",zIndex:2,display:"flex",alignItems:"center",gap:"4px",boxShadow:se?`0 2px 8px ${p}44`:"none"},children:[se?r.jsx(J,{size:10}):r.jsx(U,{size:10}),se?"SHOW LYRICS":"SHOW PROMPT"]}),r.jsx("p",{style:{fontSize:ge?"0.85rem":"1rem",lineHeight:ge?"1.5":"1.8",color:"rgba(255,255,255,0.95)",margin:0,whiteSpace:"pre-wrap",fontFamily:"'Georgia', 'Times New Roman', serif",letterSpacing:"0.01em"},children:ue?.split(/\n\n+/).map((e,i)=>r.jsx("span",{style:{display:"block",marginBottom:i<ue.split(/\n\n+/).length-1?"1em":0},children:e},i))})]})}):g?r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"12px",padding:"4px"},children:[r.jsx(re,{width:"40%",height:"20px",marginBottom:"12px",opacity:.15}),r.jsx(re,{width:"100%",height:"14px"}),r.jsx(re,{width:"90%",height:"14px"}),r.jsx(re,{width:"95%",height:"14px"}),r.jsx(re,{width:"70%",height:"14px",marginBottom:"20px"}),r.jsx(re,{width:"100%",height:"14px"}),r.jsx(re,{width:"85%",height:"14px"}),r.jsx(re,{width:"40%",height:"14px"}),r.jsxs("div",{style:{marginTop:"auto",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",padding:"12px",background:"rgba(255,255,255,0.02)",borderRadius:"8px"},children:[r.jsx(C,{size:16,className:"spin",color:p}),r.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",fontWeight:"500"},children:be?.name?`${be.name} is writing...`:"AI is thinking..."})]})]}):r.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"8px",color:"var(--text-secondary)",textAlign:"center",padding:"20px"},children:[o.createElement(s,{size:32,style:{opacity:.3}}),r.jsx("span",{style:{fontSize:"0.85rem",opacity:.5},children:'Click "Generate All" to create content'})]}),u&&x&&r.jsx("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"12px",padding:"12px",border:`1px solid ${p}22`},children:m?r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:r.jsxs("div",{onClick:()=>ee(!0),style:{cursor:"pointer",position:"relative",borderRadius:"8px",overflow:"hidden"},children:["audio"===x&&m&&r.jsxs("div",{onClick:e=>e.stopPropagation(),style:{display:"flex",alignItems:"center",gap:"12px",padding:"8px"},children:[r.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:`linear-gradient(135deg, ${p}, ${p}88)`,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 12px ${p}44`},children:r.jsx(D,{size:18,color:"white"})}),r.jsx("audio",{src:f(m),controls:!0,style:{flex:1,height:"32px"},onPlay:e=>{document.querySelectorAll("audio, video").forEach(i=>{i!==e.target&&i.pause()})}})]}),"image"===x&&m&&r.jsxs("div",{style:{position:"relative"},children:[r.jsx("img",{src:v(m),alt:"Generated",style:{width:"100%",maxHeight:"120px",objectFit:"cover",borderRadius:"8px"},onError:e=>{e.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="120" viewBox="0 0 200 120"%3E%3Crect fill="%231a1a2e" width="200" height="120"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23666" font-size="12" font-family="sans-serif"%3EImage unavailable%3C/text%3E%3C/svg%3E'}}),r.jsx("div",{className:"image-hover-overlay",style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,borderRadius:"8px",pointerEvents:"none"},children:r.jsx(F,{size:24,color:"white"})})]}),"video"===x&&m&&r.jsx("video",{src:j(m),style:{width:"100%",maxHeight:"120px",objectFit:"cover",borderRadius:"8px"},controls:!0})]})}):y?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[r.jsx(re,{height:"image"===x||"video"===x?"120px":"44px",width:"100%",opacity:.2}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"4px"},children:[r.jsx(C,{size:14,className:"spin",color:p}),r.jsx("span",{style:{fontSize:"0.75rem",color:p,fontWeight:"600"},children:"lyrics"===e?"Cloning vocals...":`Synthesizing ${x}...`})]})]}):b?r.jsxs("button",{className:y?"":"pulse-next-btn",onClick:b,disabled:y,style:{width:"100%",padding:"12px",borderRadius:"10px",background:`rgba(255,255,255,${y?"0.03":"0.07"})`,border:`1px solid ${p}60`,color:p,fontSize:"0.85rem",fontWeight:"700",cursor:y?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s"},children:[y?r.jsx(C,{size:16,className:"spin"}):r.jsxs(r.Fragment,{children:["lyrics"===e&&r.jsx(R,{size:16}),"audio"===x&&r.jsx(D,{size:16}),"image"===x&&r.jsx(V,{size:16}),"video"===x&&r.jsx(B,{size:16})]}),y?"Creating...":"lyrics"===e?"Next: Create Vocals":"audio"===e?"Next: Create Beat Audio":"visual"===e?"Next: Create Artwork":"Next: Create Video"]}):null})]}),u&&!ie&&r.jsxs("div",{style:{padding:ge?"6px 8px 8px":"12px 20px 16px",borderTop:"1px solid rgba(255,255,255,0.05)",display:"flex",gap:ge?"6px":"8px",flexWrap:"wrap",position:"relative",zIndex:1,touchAction:"manipulation"},children:[r.jsxs("button",{onClick:T,title:A?"Stop":"lyrics"===e&&m?"Play AI Vocals":"Text to Speech",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:A?`${p}30`:"rgba(255,255,255,0.05)",border:`1px solid ${A?p:"rgba(255,255,255,0.1)"}`,color:A?p:"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"500",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:[A?r.jsx(_,{size:14}):r.jsx(P,{size:14}),!ge&&(A?"Stop":"lyrics"===e&&m?"Hear Vocals":"TTS")]}),r.jsxs("button",{onClick:()=>{if(u){const i="lyrics"!==e||se?u:pe;navigator.clipboard.writeText(i),t.success("lyrics"!==e||se?"Copied to clipboard":"Lyrics copied")}},title:"Copy to Clipboard",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"500",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:[r.jsx(O,{size:14}),!ge&&"Copy"]}),r.jsxs("button",{onClick:()=>te(!0),title:"Edit Output",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"500",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:[r.jsx(q,{size:14}),!ge&&"Edit"]}),(m||u&&!x)&&r.jsxs("button",{onClick:()=>ee(!0),title:"Preview",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:`${p}20`,border:`1px solid ${p}40`,color:p,cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"600",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:[r.jsx(F,{size:14}),!ge&&"Preview"]}),h&&r.jsxs("button",{onClick:h,title:"Regenerate",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"500",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:[r.jsx($,{size:14}),!ge&&"Redo"]}),!ge&&r.jsx("div",{style:{flex:1}}),u&&W&&r.jsx("button",{onClick:W,title:"Expand to Fullscreen",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"500",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:r.jsx(Y,{size:14})}),(u||m)&&r.jsx("button",{onClick:I,title:"Download",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:"rgba(34, 197, 94, 0.15)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#22c55e",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"600",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:r.jsx(M,{size:14})}),z&&r.jsx("button",{onClick:z,title:"Delete",style:{padding:ge?"8px 10px":"8px 12px",borderRadius:"8px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",color:"#ef4444",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:ge?"0.7rem":"0.75rem",fontWeight:"500",minHeight:ge?"36px":"auto",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"},children:r.jsx(K,{size:14})})]}),r.jsx(i.Suspense,{fallback:null,children:r.jsx(Q,{isOpen:Z,onClose:()=>ee(!1),mediaUrl:m,mediaType:x||"text",title:d,textContent:x?null:u})}),r.jsx("style",{children:"\n        /* Desktop-only hover effects */\n        @media (hover: hover) and (pointer: fine) {\n          .generator-card:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 10px 40px rgba(0,0,0,0.3);\n          }\n          .image-hover-overlay {\n            transition: opacity 0.2s ease;\n          }\n          .generator-card:hover .image-hover-overlay {\n            opacity: 1 !important;\n          }\n        }\n        /* Mobile touch optimization */\n        @media (hover: none) {\n          .generator-card {\n            transform: none !important;\n          }\n          .generator-card:active {\n            opacity: 0.9;\n          }\n        }\n      "})]})}function ae({outputs:e,mediaUrls:i,songIdea:o,finalMixPreview:a,creatingFinalMix:n,musicVideoUrl:l,generatingMusicVideo:s,handleGenerateProfessionalMusicVideo:d,handleCreateFinalMix:c,handleCreateProject:p,setShowPreviewModal:u,setMaximizedSlot:g,visualType:x,setVisualType:m,isMobile:b,orchestratorBpm:y=120,mixVocalVolume:h,mixBeatVolume:f,setMixVocalVolume:v,setMixBeatVolume:j}){const w=Object.values(e).filter(Boolean).length,z=4===w,I=w>0,R=w/4*100,U=!!i.audio,D=!!i.vocals||!!i.lyricsVocal,A=D||!!e.lyrics,V=!!i.video,W=!!i.image,E=U&&(V||A||W),P=!!l;return r.jsxs("div",{style:{background:z?"linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98))":"rgba(15, 23, 42, 0.4)",borderRadius:b?"16px":"24px",padding:b?"14px":"28px",border:"1px solid rgba(255,255,255,0.1)",marginTop:"32px",position:"relative",overflow:"visible",boxShadow:z?"0 10px 40px rgba(0,0,0,0.4), 0 0 0 1px rgba(79, 70, 229, 0.3)":"none",transition:"all 0.5s cubic-bezier(0.4, 0, 0.2, 1)"},children:[z&&r.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"4px",background:"linear-gradient(90deg, #4f46e5, #9333ea, #ec4899)",boxShadow:"0 0 15px rgba(79, 70, 229, 0.5)"}}),r.jsxs("div",{style:{display:"flex",flexDirection:b?"column":"row",justifyContent:"space-between",alignItems:b?"stretch":"center",gap:"24px",position:"relative",zIndex:1},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[r.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:z?"rgba(79, 70, 229, 0.2)":"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",color:z?"#818cf8":"rgba(255,255,255,0.3)",border:"1px solid "+(z?"rgba(79, 70, 229, 0.4)":"rgba(255,255,255,0.1)")},children:z?r.jsx(S,{size:20}):r.jsx(k,{size:20})}),r.jsxs("div",{children:[r.jsxs("h3",{style:{margin:0,fontSize:"1.25rem",fontWeight:"700",color:z?"white":"rgba(255,255,255,0.5)",display:"flex",alignItems:"center",gap:"8px"},children:[z?"Production Complete":"Production Status",z&&r.jsx(T,{size:18,color:"#22c55e"})]}),r.jsx("p",{style:{margin:"4px 0 0",fontSize:"0.85rem",color:"rgba(255,255,255,0.4)"},children:z?"All assets are master-ready":`${w}/4 assets finalized â€¢ ${4-w} remaining`})]})]}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:["lyrics","audio","visual","video"].map(t=>{const o=t.charAt(0).toUpperCase()+t.slice(1),a=!!e[t],n=!!i["lyrics"===t?"vocals":t];return r.jsxs("div",{style:{padding:"6px 12px",borderRadius:"100px",fontSize:"0.75rem",fontWeight:"600",background:a?"rgba(34, 197, 94, 0.1)":"rgba(255,255,255,0.03)",color:a?"#4ade80":"rgba(255,255,255,0.2)",border:"1px solid "+(a?"rgba(34, 197, 94, 0.2)":"rgba(255,255,255,0.05)"),display:"flex",alignItems:"center",gap:"6px"},children:[a?"â—":"â—‹"," ",o,n&&r.jsx("span",{title:"Media Created",children:"ðŸ’Ž"})]},t)})}),r.jsxs("div",{style:{marginTop:"24px",background:"linear-gradient(135deg, rgba(0,0,0,0.5), rgba(30,30,40,0.5))",borderRadius:"16px",padding:"20px",border:"2px solid rgba(34, 211, 238, 0.3)",boxShadow:"0 8px 32px rgba(34, 211, 238, 0.1)",display:"block"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[r.jsxs("div",{children:[r.jsx("span",{style:{fontSize:"0.85rem",color:"#22d3ee",fontWeight:"900",textTransform:"uppercase",letterSpacing:"0.1em"},children:"ðŸŽšï¸ Production Timeline"}),r.jsx("div",{style:{fontSize:"0.65rem",color:"rgba(255,255,255,0.4)",marginTop:"4px"},children:"Billboard-Quality Multi-Track Sync"})]}),r.jsxs("span",{style:{fontSize:"0.75rem",color:"#818cf8",fontWeight:"700",background:"rgba(129, 140, 248, 0.1)",padding:"6px 12px",borderRadius:"8px"},children:[y," BPM â€¢ STEREO"]})]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{label:"BEAT",type:"audio",color:"#22d3ee"},{label:"VOCALS",type:"lyrics",color:"#a78bfa"},{label:"VISUALS",type:"visual",color:"#fb923c"},{label:"IMG TO VIDEO",type:"video",color:"#f87171"}].map(t=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("div",{style:{width:"70px",fontSize:"0.65rem",fontWeight:"800",color:e[t.type]?t.color:"rgba(255,255,255,0.2)",letterSpacing:"0.05em"},children:t.label}),r.jsx("div",{style:{flex:1,height:"24px",background:"rgba(255,255,255,0.03)",borderRadius:"4px",position:"relative",overflow:"hidden",border:"1px solid rgba(255,255,255,0.05)"},children:e[t.type]&&r.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:i["lyrics"===t.type?"vocals":"visual"===t.type?"image":t.type]?"100%":"30%",background:`linear-gradient(90deg, ${t.color}40, ${t.color}80)`,borderRight:`2px solid ${t.color}`,transition:"width 1s ease-in-out"},children:("audio"===t.type||"lyrics"===t.type)&&r.jsx("div",{style:{display:"flex",alignItems:"center",gap:"2px",height:"100%",paddingLeft:"8px",opacity:.5},children:[...Array(20)].map((e,i)=>r.jsx("div",{style:{width:"2px",height:80*Math.random()+"%",background:t.color,borderRadius:"2px"}},i))})})}),r.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",background:e[t.type]?"#22c55e":"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center"},children:e[t.type]&&r.jsx(T,{size:10,color:"white"})})]},t.label))})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:b?"column":"row",gap:"12px",alignItems:"stretch"},children:[E&&!P&&r.jsxs("button",{onClick:d,disabled:s,style:{padding:"14px 24px",borderRadius:"16px",background:"rgba(236, 72, 153, 0.1)",border:"1px solid rgba(236, 72, 153, 0.3)",color:"#f472b6",fontWeight:"600",fontSize:"0.9rem",cursor:s?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s ease"},children:[s?r.jsx($,{size:18,className:"spin"}):l?r.jsx(S,{size:18,fill:"#22c55e"}):r.jsx(B,{size:18}),s?"Syncing...":l?"Image to Video Sync âœ“":"Image to Video Sync"]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",flex:1},children:[r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[{key:"beat",label:"Beat",available:U,color:"#22d3ee"},{key:"vocals",label:"Vocals",available:D,color:"#a78bfa"},{key:"artwork",label:"Artwork",available:W,color:"#fb923c"},{key:"video",label:"Video",available:V||P,color:"#f87171"}].map(e=>{const i=e.available;return r.jsxs("div",{style:{padding:"8px 14px",borderRadius:"10px",fontSize:"0.8rem",fontWeight:"700",background:i?`${e.color}18`:"rgba(255,255,255,0.03)",border:"1.5px solid "+(i?`${e.color}50`:"rgba(255,255,255,0.08)"),color:i?e.color:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",gap:"6px",opacity:i?1:.5},children:[i?r.jsx(T,{size:13}):r.jsx("div",{style:{width:13,height:13,borderRadius:"50%",border:"1.5px solid rgba(255,255,255,0.15)"}}),e.label]},e.key)})}),U&&D&&v&&j&&r.jsxs("div",{style:{display:"flex",gap:b?"12px":"20px",flexWrap:"wrap",padding:"10px 14px",background:"rgba(255,255,255,0.03)",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.06)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1,minWidth:"120px"},children:[r.jsx("span",{style:{fontSize:"0.7rem",fontWeight:"700",color:"#22d3ee",width:"40px"},children:"Beat"}),r.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:f,onChange:e=>j(parseFloat(e.target.value)),style:{flex:1,accentColor:"#22d3ee",height:"4px"}}),r.jsxs("span",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.5)",width:"30px",textAlign:"right"},children:[Math.round(100*f),"%"]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1,minWidth:"120px"},children:[r.jsx("span",{style:{fontSize:"0.7rem",fontWeight:"700",color:"#a78bfa",width:"40px"},children:"Vocal"}),r.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:h,onChange:e=>v(parseFloat(e.target.value)),style:{flex:1,accentColor:"#a78bfa",height:"4px"}}),r.jsxs("span",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.5)",width:"30px",textAlign:"right"},children:[Math.round(100*h),"%"]})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[r.jsx("button",{onClick:()=>{U||D?c():t("Generate beat or vocals first to create a mix",{icon:"â„¹ï¸"})},disabled:!U&&!D||n,style:{padding:"12px 24px",borderRadius:"14px",background:U||D?"linear-gradient(135deg, #4f46e5, #7c3aed)":"rgba(255,255,255,0.05)",border:U||D?"none":"1px solid rgba(255,255,255,0.1)",color:U||D?"white":"rgba(255,255,255,0.3)",fontWeight:"700",fontSize:"0.9rem",cursor:!U&&!D||n?"default":"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:U||D?"0 6px 20px rgba(79, 70, 229, 0.35)":"none",transition:"all 0.3s ease",flex:1,justifyContent:"center",minHeight:"44px"},children:n?r.jsxs(r.Fragment,{children:[r.jsx(C,{size:16,className:"spin"})," Mixing..."]}):r.jsxs(r.Fragment,{children:[r.jsx(S,{size:16})," Create Mix"]})}),a&&r.jsxs("button",{onClick:()=>{g(null),u(!0)},style:{padding:"12px 20px",borderRadius:"14px",background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",fontWeight:"600",fontSize:"0.85rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",minHeight:"44px"},children:[r.jsx(F,{size:16})," Preview"]})]})]}),I&&r.jsxs("button",{onClick:p,style:{padding:"14px 24px",borderRadius:"16px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontWeight:"600",fontSize:"0.9rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:z?1:.7},children:[r.jsx(G,{size:18}),!b&&"Publish to Hub"]})]})]}),!z&&r.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"4px",background:"rgba(255,255,255,0.05)"},children:r.jsx("div",{style:{width:`${R}%`,height:"100%",background:"linear-gradient(90deg, #3b82f6, #6366f1)",transition:"width 0.8s cubic-bezier(0.16, 1, 0.3, 1)"}})})]})}function ne({isOpen:e,onClose:o,onCreateProject:l,onSaveToProject:_,onGoToHub:q=null,authToken:K=null,existingProject:Q=null,userPlan:re="Free"}){const[ne,le]=i.useState("undefined"!=typeof window&&window.innerWidth<768),[se,de]=i.useState(Q?.name||""),[ce,pe]=i.useState(Q?.language||"English"),[ue,ge]=i.useState(Q?.style||"Modern Hip-Hop"),[xe,me]=i.useState(Q?.duration||90),[be,ye]=i.useState(Q?.musicalBars||16),[he,fe]=i.useState(Q?.useBars??!0),[ve,je]=i.useState(Q?.model||"Gemini 2.0 Flash"),[Se,we]=i.useState(Q?.musicEngine||"music-gpt"),[ke,Ce]=i.useState(Q?.mood||"Energetic"),[ze,Ie]=i.useState(Q?.structure||"Full Song"),[Re,Ue]=i.useState(!0),[Te,De]=i.useState(-1),[$e,Ae]=i.useState("Full Mix"),[Ve,Be]=i.useState(Q?.bpm||Q?.settings?.bpm||120),[We,Fe]=i.useState({lyrics:"ghost",audio:"beat",visual:"album",video:"video-creator"}),[Ee,Pe]=i.useState(!1),[Oe,Me]=i.useState({lyrics:!1,audio:!1,visual:!1,video:!1}),[Ne,Le]=i.useState({lyrics:null,audio:null,visual:null,video:null}),[He,Ge]=i.useState({audio:null,image:null,video:null,vocals:null,lyricsVocal:null,mixedAudio:null}),[Ye,Je]=i.useState({}),_e=i.useRef(He);_e.current=He;const qe=i.useRef(!1),Ke=i.useRef(null),Qe=i.useRef(null),[Xe,Ze]=i.useState({audio:!1,image:!1,video:!1,vocals:!1}),[ei,ii]=i.useState(null),[ti,ri]=i.useState(""),[oi,ai]=i.useState(!1),[ni,li]=i.useState(!1),[si,di]=i.useState("rapper"),[ci,pi]=i.useState("premium"),[ui,gi]=i.useState("music"),[xi,mi]=i.useState("aggressive"),[bi,yi]=i.useState("hip-hop"),[hi,fi]=i.useState("full"),[vi,ji]=i.useState(null),[Si,wi]=i.useState(!1),[ki,Ci]=i.useState(null),[zi,Ii]=i.useState(!1),[Ri,Ui]=i.useState(null),[Ti,Di]=i.useState(.85),[$i,Ai]=i.useState(.6),[Vi,Bi]=i.useState(!1),[Wi,Fi]=i.useState(null),[Ei,Pi]=i.useState(!1),[Oi,Mi]=i.useState(!1),[Ni,Li]=i.useState(!1),[Hi,Gi]=i.useState(!1),[Yi,Ji]=i.useState(!1),[_i,qi]=i.useState(!1),[Ki,Qi]=i.useState(!!Q),[Xi,Zi]=i.useState("image"),[et,it]=i.useState(!0),[tt,rt]=i.useState("Modern Hip-Hop"),[ot,at]=i.useState("Full Song Release"),[nt,lt]=i.useState([]),[st,dt]=i.useState(null),[ct,pt]=i.useState(localStorage.getItem("studio_elevenlabs_voice_id")||""),[ut,gt]=i.useState(!1),[xt,mt]=i.useState([]),[bt,yt]=i.useState(!1),[ht,ft]=i.useState([]),[vt,jt]=i.useState(!1),[St,wt]=i.useState([]),[kt,Ct]=i.useState(!1),[zt,It]=i.useState(null),[Rt,Ut]=i.useState(!0),[Tt,Dt]=i.useState(null),[$t,At]=i.useState(null),[Vt,Bt]=i.useState(null),[Wt,Ft]=i.useState(null),[Et,Pt]=i.useState({visual:!1,audio:!1,video:!1,lyrics:!1}),Ot=i.useRef(Ne),Mt=i.useRef(null),Nt=i.useRef(null),Lt=Ne||{lyrics:null,audio:null,visual:null,video:null},Ht=He||{audio:null,image:null,video:null};i.useEffect(()=>{const e=e=>{"Escape"===e.key&&(_i?qi(!1):Yi?Ji(!1):Ni?Li(!1):oi?ai(!1):Ei?Pi(!1):vi&&ji(null))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[_i,Yi,Ni,oi,Ei,vi]);const Gt=i.useCallback(e=>{const i=Z[e];i&&(ge(e),Be(i.bpm),Ce(i.mood),Ie(i.structure),me(i.duration))},[]),Yt=i.useCallback(e=>{const i=te[e];i&&(at(e),me(i.duration),Ie(i.structure),gi(i.outputFormat),fe(i.useBars))},[]),Jt=i.useCallback((e,i)=>{lt(t=>t.map(t=>t.id===e?{...t,status:i,..."active"===i?{startTime:Date.now()}:{},..."done"===i||"error"===i?{endTime:Date.now()}:{}}:t))},[]),_t=i.useCallback(async(e,i,r)=>{const o=async()=>{const t=await fetch(`${n}/api/mux-audio-video`,{method:"POST",headers:r,body:JSON.stringify({audioUrl:i,videoUrl:e,title:(se||"song").substring(0,50)})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error||`Mux failed (${t.status})`)}return t.json()};try{let e;try{e=await o()}catch(a){await new Promise(e=>setTimeout(e,3e3)),e=await o()}return!!e?.muxedVideoUrl&&(Ge(i=>({...i,video:e.muxedVideoUrl})),!0)}catch(l){return t.error("Video created but audio sync failed â€” video may be silent",{duration:6e3}),!1}},[se]);i.useEffect(()=>{const e=()=>le(window.innerWidth<768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),i.useEffect(()=>{Ot.current=Ne},[Ne]),i.useEffect(()=>{if(Le({lyrics:null,audio:null,visual:null,video:null}),Ge({audio:null,image:null,video:null,vocals:null,lyricsVocal:null,mixedAudio:null}),Je({}),Fi(null),Ui(null),lt([]),Ze({audio:!1,image:!1,video:!1,vocals:!1}),Dt(null),At(null),Bt(null),Ft(null),Qi(!!Q),de(Q?.name||""),pe(Q?.language||"English"),ge(Q?.style||"Modern Hip-Hop"),me(Q?.duration||90),ye(Q?.musicalBars||16),fe(Q?.useBars??!0),Be(Q?.bpm||Q?.settings?.bpm||120),Ce(Q?.mood||"Energetic"),Ie(Q?.structure||"Full Song"),!Q?.assets?.length)return;const e={},i={};for(const t of Q.assets)"beat"!==t.type&&"audio"!==t.type||(t.audioUrl&&!e.audio&&(e.audio=t.audioUrl),t.content&&!i.audio&&(i.audio=t.content)),"vocal"===t.type&&t.audioUrl&&!e.vocals&&(e.vocals=t.audioUrl,e.lyricsVocal=t.audioUrl),"image"!==t.type&&"cover"!==t.type&&"visual"!==t.type||(!t.imageUrl&&!t.url||e.image||(e.image=t.imageUrl||t.url),t.content&&!i.visual&&(i.visual=t.content)),"video"===t.type&&(t.videoUrl&&!e.video&&(e.video=t.videoUrl),t.isPremium&&t.videoUrl&&Fi(t.videoUrl),t.content&&!i.video&&(i.video=t.content)),"lyrics"===t.type&&t.content&&!i.lyrics&&(i.lyrics=t.content);Object.keys(e).length>0&&Ge(i=>({...i,...e})),Object.keys(i).length>0&&Le(e=>({...e,...i}));for(const t of Q.assets)if(("vocal"===t.type||"mix"===t.type)&&t.settings){t.settings.voiceStyle&&di(t.settings.voiceStyle),t.settings.elevenLabsVoiceId&&pt(t.settings.elevenLabsVoiceId),t.settings.voiceSampleUrl&&dt(t.settings.voiceSampleUrl),t.settings.vocalQuality&&pi(t.settings.vocalQuality),t.settings.outputFormat&&gi(t.settings.outputFormat);break}},[Q?.id]),i.useEffect(()=>{e&&(async()=>{if(d.currentUser){yt(!0);try{const e=u(g(s,"users",d.currentUser?.uid,"voices")),i=(await x(e)).docs.map(e=>({id:e.id,...e.data()}));mt(i)}catch(e){}finally{yt(!1)}}})()},[e]),i.useEffect(()=>{e&&(async()=>{jt(!0);try{const e=await Xt(),i=await fetch(`${n}/api/v2/voices`,{headers:e});if(i.ok){const e=await i.json();ft(e)}}catch(e){}finally{jt(!1)}})()},[e]),i.useEffect(()=>{(async()=>{if(d.currentUser&&e)try{const e=p(s,"users",d.currentUser?.uid),i=await m(e);if(i.exists()){const e=i.data();e.visualDnaUrl&&Dt(e.visualDnaUrl),e.audioDnaUrl&&At(e.audioDnaUrl),e.videoDnaUrl&&Bt(e.videoDnaUrl),e.lyricsDnaUrl&&Ft(e.lyricsDnaUrl),e.voiceSampleUrl&&dt(e.voiceSampleUrl),e.clonedVoiceId&&(It(e.clonedVoiceId),pt(e.clonedVoiceId),di("cloned"))}}catch(i){}})()},[e]),i.useEffect(()=>(document.body.style.overflow=e?"hidden":"auto",()=>{document.body.style.overflow="auto"}),[e]),i.useEffect(()=>{if(he){const e=Math.round(4*be*60/Ve);me(e)}},[be,Ve,he]),i.useEffect(()=>{he||me("Full Song"===ze?90:"Radio Edit"===ze?150:"Extended"===ze?180:"Loop"===ze?30:15)},[ze,he]);const qt=[{key:"lyrics",title:"Ghostwriter",subtitle:"Lyrics & Hook",icon:z,color:"#8b5cf6",mediaType:null},{key:"audio",title:"Beat Lab",subtitle:"Music Production",icon:S,color:"#06b6d4",mediaType:"audio"},{key:"visual",title:"Album Artist",subtitle:"Cover Identity",icon:V,color:"#ec4899",mediaType:"image"},{key:"video",title:"Video Creator",subtitle:"Motion & Sync",icon:B,color:"#f59e0b",mediaType:"video"}],Kt=(e,i)=>{let t=e;if("lyrics"===i||"content"===i){const{content:i}=X(e);i&&(t=i)}if(ei===i)return window.speechSynthesis.cancel(),Nt.current&&(Nt.current.pause(),Nt.current.currentTime=0),void ii(null);if("lyrics"===i&&He.vocals)try{Nt.current&&Nt.current.pause(),window.speechSynthesis.cancel();const e=document.createElement("audio");return e.src=f(He.vocals),Nt.current=e,e.play().catch(e=>{Qt(t,i)}),e.onended=()=>ii(null),void ii(i)}catch(r){}Qt(t,i)},Qt=(e,i)=>{try{if(window.speechSynthesis.cancel(),"undefined"==typeof SpeechSynthesisUtterance)return;const t=new SpeechSynthesisUtterance(e),r=window.speechSynthesis.getVoices();if("rapper"===si||"rapper-female"===si){t.rate="fast"===xi?1.3:"chill"===xi?.85:1,t.pitch="rapper-female"===si?1.2:.9;const e=r.find(e=>"rapper-female"===si?e.name.toLowerCase().includes("female")||e.name.toLowerCase().includes("zira")||e.name.toLowerCase().includes("samantha"):e.name.toLowerCase().includes("male")||e.name.toLowerCase().includes("david")||e.name.toLowerCase().includes("alex"));e&&(t.voice=e)}else if("singer"===si||"singer-female"===si){t.rate=.85,t.pitch="singer-female"===si?1.3:1;const e=r.find(e=>"singer-female"===si?e.name.toLowerCase().includes("female")||e.name.toLowerCase().includes("zira"):e.name.toLowerCase().includes("male")||e.name.toLowerCase().includes("david"));e&&(t.voice=e)}else if("narrator"===si){t.rate=.9,t.pitch=.8;const e=r.find(e=>e.name.toLowerCase().includes("david")||e.name.toLowerCase().includes("male"));e&&(t.voice=e)}else t.rate=.9;t.onend=()=>ii(null),t.onerror=()=>ii(null),window.speechSynthesis.speak(t),ii(i)}catch(t){ii(null)}},Xt=i.useCallback(async()=>{const e={"Content-Type":"application/json"};return K&&(e.Authorization=`Bearer ${K}`),e},[K]),Zt=i.useCallback(()=>{Le({lyrics:null,audio:null,visual:null,video:null}),Ge({audio:null,image:null,video:null,vocals:null,lyricsVocal:null,mixedAudio:null}),Je({}),Fi(null),Ui(null),Dt(null),At(null),Bt(null),Ft(null),Qi(!1),lt([]),qi(!1),qe.current=!0,setTimeout(()=>Ke.current?.(),0)},[]),er=i.useCallback(()=>{qi(!1),Qe.current?.(),Le({lyrics:null,audio:null,visual:null,video:null}),Ge({audio:null,image:null,video:null,vocals:null,lyricsVocal:null,mixedAudio:null}),Je({}),Fi(null),Ui(null),Dt(null),At(null),Bt(null),Ft(null),lt([]),qe.current=!0,setTimeout(()=>Ke.current?.(),0)},[]),ir=async()=>{if(Ee)return;let e=!1;if(qe.current)e=!0;else{const i=Object.values(Ne).some(Boolean)||Object.values(He).some(e=>e);if(i&&!Ki)return void qi(!0);i&&Ki&&(Le({lyrics:null,audio:null,visual:null,video:null}),Ge({audio:null,image:null,video:null,vocals:null,lyricsVocal:null,mixedAudio:null}),Fi(null),Ui(null),Dt(null),At(null),Bt(null),Ft(null),Qi(!1),lt([]),e=!0)}if(qe.current=!1,!se.trim())return void t.error("Please enter a song idea");const i=Object.entries(We).filter(([,e])=>e);if(0===i.length)return void t.error("Please select at least one agent");Pe(!0),t.loading("Generating content...",{id:"gen-all"});const o=[];We.lyrics&&o.push({id:"lyrics",label:"Writing lyrics",status:"pending",startTime:null,endTime:null}),We.audio&&o.push({id:"beat-desc",label:"Composing beat description",status:"pending",startTime:null,endTime:null}),We.visual&&o.push({id:"visual-desc",label:"Designing album art concept",status:"pending",startTime:null,endTime:null}),We.audio&&o.push({id:"beat-audio",label:"Generating beat audio",status:"pending",startTime:null,endTime:null}),We.visual&&o.push({id:"image",label:"Creating album artwork",status:"pending",startTime:null,endTime:null}),We.lyrics&&o.push({id:"vocals",label:"Recording AI vocals",status:"pending",startTime:null,endTime:null}),We.video&&o.push({id:"video",label:"Producing music video",status:"pending",startTime:null,endTime:null}),We.video&&We.audio&&o.push({id:"mux",label:"Syncing audio to video",status:"pending",startTime:null,endTime:null}),o.push({id:"final",label:"Creating final mix",status:"pending",startTime:null,endTime:null}),lt(o);try{const r=await Xt(),o="Gemini 2.0 Flash"===ve?"gemini-2.0-flash":"Gemini 2.0 Pro (Exp)"===ve?"gemini-2.0-flash-exp":"Gemini 1.5 Pro"===ve?"gemini-1.5-pro":"gemini-2.0-flash",l=async(e,i,l="")=>{const s=a.find(e=>e.id===i);if(!s)return null;Me(i=>({...i,[e]:!0}));const d=qt.find(i=>i.key===e),p="audio"===e?"beat-desc":"visual"===e?"visual-desc":e;Jt(p,"active");const u=`You are ${s.name}, an elite Billboard-standard ${s.category} specialist with multiple Grammy and Billboard #1 credits.\n        Your mission: create content for a ${ue} track about "${se}" in ${ce} that is indistinguishable from a major-label release.\n        Output Format: ${ui||"music"} â€” tailor all output to match ${ui} broadcast/distribution standards.\n        ${l?`LYRICS CONTEXT â€” use these to match the emotional arc, tempo, and vibe:\n"${String(l).substring(0,1500)}"`:""}\n        ${"lyrics"===e?`LYRICS AGENT INSTRUCTIONS:\nWrite ONLY the lyrics with clear section labels: [Verse 1], [Pre-Chorus], [Chorus], [Verse 2], [Bridge], [Outro].\nSONG STRUCTURE: ${"single"===hi?"SHORT FORMAT â€” 1 Verse + 1 Chorus + 1 Verse (radio single, ~2 minutes)":"extended"===hi?"EXTENDED FORMAT â€” 3 Verses + 2 Choruses + Bridge + Outro (full album track, ~4 minutes)":"FULL TRACK â€” 2 Verses + Chorus + Bridge + Final Chorus (standard release, ~3 minutes)"}\nREQUIREMENTS:\n- The CHORUS/HOOK must be catchy enough to get stuck in someone's head after one listen\n- Use multi-syllable rhyme schemes (AABB or ABAB), internal rhymes, and wordplay\n- Include Suno-style performance/vocal tags: [Hard Hitting Rap], [Soulful Vocals], [Building Intensity], [Ad-lib: yeah!], [Whispered]\n- Every line must have rhythmic cadence that locks to the beat's groove\n- Use vivid metaphors, emotional specificity, and cultural references â€” zero generic filler\n- Match the flow and delivery style of current chart-topping ${ue} artists\n- NO intro text, NO commentary, NO explanations â€” ONLY lyrics with section labels`:""}\n        ${"audio"===e?`BEAT DNA AGENT INSTRUCTIONS:\nDescribe a Billboard-ready instrumental concept (${he?be+" bars":xe+" seconds"}, BPM: ${Ve}).\nREQUIREMENTS:\n- Reference specific production techniques: drum patterns, bass type, synth textures, FX\n- Name the sonic palette: what instruments, what key, what mood progression\n- Describe the arrangement arc: how the beat builds from intro through drops\n- Use producer-level terminology (808 glides, sidechain, hi-hat rolls, vocal chops, etc.)\n- Keep under 60 words for maximum AI audio model compatibility\n- Think: what would Metro Boomin, Pharrell, or Max Martin describe for this track?`:""}\n        ${"visual"===e?"Describe a striking, iconic album cover concept with specific visual direction: color palette, composition, typography style, mood lighting, and cultural aesthetic. Think major-label art direction.":""}\n        ${"video"===e?"Write a cinematic music video storyboard with precise scene descriptions, camera movements, lighting, wardrobe, locations, and narrative arc. Think Hype Williams or Dave Meyers visual storytelling.":""}`;try{const i=await fetch(`${n}/api/generate`,{method:"POST",headers:r,body:JSON.stringify({prompt:`Create ${d.title.toLowerCase()} content for: "${se}"`,systemInstruction:u,model:o,duration:xe,language:ce,referenceUrl:"lyrics"===e?Wt:"audio"===e?$t:"visual"===e?Tt:"video"===e?Vt:null})});if(i.ok){const t=await i.json();return Le(i=>{const r={...i,[e]:t.output};return Ot.current=r,r}),Me(i=>({...i,[e]:!1})),Jt(p,"done"),"audio"===e?(Jt("beat-audio","active"),c.beatAudio=rr(t.output).then(()=>Jt("beat-audio","done")).catch(()=>Jt("beat-audio","error"))):"visual"===e?(Jt("image","active"),c.image=lr(t.output).then(()=>Jt("image","done")).catch(()=>Jt("image","error"))):"video"===e&&(c.videoDescription=t.output),t.output}await i.text();return Me(i=>({...i,[e]:!1})),Jt(p,"error"),t.error(`Agent ${s.name} failed: ${i.status}`,{icon:"âŒ"}),null}catch(g){return Me(i=>({...i,[e]:!1})),Jt(p,"error"),t.error(`Connection Error: ${e} generation failed.`,{icon:"ðŸ“¡"}),null}},s=i.find(([e])=>"lyrics"===e);let d="";if(s)d=!e&&Ne.lyrics&&(He.vocals||He.lyricsVocal)?Ne.lyrics:await l(s[0],s[1]);else if(Q?.assets){const e=Q.assets.find(e=>"lyrics"===e.type||e.id?.includes("lyrics")||e.agent?.toLowerCase().includes("ghost"));e&&(d=e.content||e.snippet||"")}const c={beatAudio:null,image:null,videoDescription:null},p=i=>!e&&("audio"===i?He.audio:"visual"===i?He.image:"video"===i?He.video:"lyrics"===i&&(He.vocals||He.lyricsVocal)),u=i.filter(([e])=>"lyrics"!==e).filter(([e])=>!Ne[e]||!p(e));await Promise.all(u.map(([e,i])=>l(e,i,d))),c.beatAudio&&await c.beatAudio,d&&i.find(([e])=>"lyrics"===e)&&(e||!He.vocals&&!He.lyricsVocal)&&(Jt("vocals","active"),await or(d),Jt("vocals","done")),c.image&&await c.image,c.videoDescription&&!_e.current.video&&(Jt("video","active"),await dr(c.videoDescription),Jt("video","done"));const g=_e.current.video,x=_e.current.mixedAudio||_e.current.audio;if(g&&x){Jt("mux","active");const e=await _t(g,x,r);Jt("mux",e?"done":"error")}else g&&Jt("mux","done");Jt("final","active"),setTimeout(()=>{cr(),Jt("final","done")},500),t.dismiss("gen-all"),t.success("Generation complete!")}catch(l){t.error(r.jsxs("div",{children:[r.jsx("strong",{children:"Generation failed"}),r.jsx("p",{style:{fontSize:"12px",marginTop:"4px"},children:l.message||"Check your connection and try again"})]}),{duration:5e3})}finally{Pe(!1),Me({lyrics:!1,audio:!1,visual:!1,video:!1}),setTimeout(()=>lt([]),3e3)}},tr=async e=>{if(Ee||Oe[e])return;if(!We[e])return;const i=a.find(i=>i.id===We[e]);if(i){Me(i=>({...i,[e]:!0})),Le(i=>({...i,[e]:null}));try{const a=await Xt(),d=qt.find(i=>i.key===e),c="Gemini 2.0 Flash"===ve?"gemini-2.0-flash":"Gemini 2.0 Pro (Exp)"===ve?"gemini-2.0-flash-exp":"Gemini 1.5 Pro"===ve?"gemini-1.5-pro":"gemini-2.0-flash",p=await fetch(`${n}/api/generate`,{method:"POST",headers:a,body:JSON.stringify({prompt:`Create fresh ${d.title.toLowerCase()} content for: "${se}"`,systemInstruction:`You are ${i.name}. Create NEW and DIFFERENT content for a ${ue} song about: "${se}". Be creative and fresh.\n          ${"lyrics"!==e&&Ne.lyrics?`HERE ARE THE CURRENT LYRICS - USE THEM FOR CONTEXT: "${Ne.lyrics.substring(0,500)}"`:""}\n          ${"lyrics"===e?"Write ONLY the lyrics (verses, hooks, chorus) with clear labels like [Verse] or [Chorus]. No intro fluff.":""}\n          ${"audio"===e?`Briefly describe a high-quality beat/instrumental concept (${he?be+" bars":xe+" seconds"}) with BPM: ${Ve}. Focus on mood, instrumentation, and energy. Keep it under 80 words for an AI music generator.`:""}`,model:c,duration:xe,language:ce})});let u;if(!p.headers.get("content-type")?.includes("application/json"))throw new Error(`Invalid server response (${p.status})`);if(u=await p.json(),p.ok){if(Le(i=>({...i,[e]:u.output})),Ot.current[e]=u.output,t.success(`${d.title} regenerated!`),"lyrics"===e&&u.output)try{t.loading("Re-generating vocals with new lyrics...",{id:"regen-lyrics"}),await or(u.output),t.success("Vocals regenerated with new lyrics!",{id:"regen-lyrics"})}catch(r){t.error("Lyrics updated but vocal generation failed. Try generating vocals manually.",{id:"regen-lyrics"})}else if("video"===e&&u.output){t.loading("Regenerating video...",{id:"regen-video"});try{await dr(u.output);const e=_e.current.mixedAudio||_e.current.audio,i=_e.current.video;i&&e&&(t.loading("Syncing audio to video...",{id:"regen-video"}),await _t(i,e,a)),t.success("Video regenerated with audio!",{id:"regen-video"})}catch(o){t.error("Video description updated but media generation failed",{id:"regen-video"})}}else if("audio"===e&&u.output)try{await rr(u.output),t.success("Beat regenerated!",{id:"regen-audio"})}catch(l){}else if("visual"===e&&u.output)try{await lr(u.output),t.success("Image regenerated!",{id:"regen-image"})}catch(s){}}else t.error(u.error||`Failed to regenerate ${d.title}`)}catch(d){t.error("Regeneration failed")}finally{Me(i=>({...i,[e]:!1}))}}};Ke.current=ir;const rr=async(e=null)=>{if(Xe.audio)return;const i=("string"==typeof e?e:null)||Ot.current.audio||Ne.audio;if(!i)return void t.error("Generate Beat DNA first");Ze(e=>({...e,audio:!0}));const o=xe>120?"3 minutes":xe>60?"2 minutes":"60 seconds";t.loading(`Synthesizing AI beat (${o})...`,{id:"gen-audio"});try{const e=await Xt(),{content:o}=X(i),a=o||i,s=await fetch(`${n}/api/generate-audio`,{method:"POST",headers:e,body:JSON.stringify({prompt:"string"==typeof a?a.substring(0,1e3):"Professional music production",genre:(ue||"hip-hop").toLowerCase().split("/")[0].trim(),mood:ke.toLowerCase()||"energetic",bpm:parseInt(Ve)||90,durationSeconds:parseInt(xe)||("Full Song"===ze?90:"Radio Edit"===ze?150:"Extended"===ze?180:"Loop"===ze?15:30),referenceAudio:$t||null,engine:Se||"music-gpt",quality:"premium",outputFormat:ui,highMusicality:Re,seed:Te,stem:$e})});let d;const c=s.headers.get("content-type");if(!c||!c.includes("application/json")){await s.text();throw new Error(`Invalid audio response (${s.status})`)}if(d=await s.json(),s.ok){const e=d.audioUrl||d.output;if(e){if(Ge(i=>({...i,audio:e})),Je(e=>({...e,audio:d.source||d.provider||"ai"})),Le(e=>({...e,audio:e.audio||`Professional ${ue} beat generated at ${Ve} BPM`})),Q&&(_||l)){const i=_||l,t=(Q.assets||[]).filter(e=>"audio"===e.type).length,r=t>0?` (Take ${t+1})`:"",o={id:`audio-${crypto.randomUUID()}`,title:`Beat Lab Production${r}`,type:"audio",agent:"Beat Lab",content:a.substring(0,500),audioUrl:e,mimeType:d.mimeType||"audio/mpeg",version:t+1,settings:{genre:ue,mood:ke,bpm:Ve,engine:Se,referencedAudioId:$t?"dna-ref":null},createdAt:(new Date).toISOString()};i({...Q,assets:[o,...Q.assets||[]],updatedAt:(new Date).toISOString()}),Qi(!0)}t.success("AI beat generated!",{id:"gen-audio"})}else t.error("No audio returned from server",{id:"gen-audio"})}else{const e=d||{};e.isSystemCreditIssue||503===s.status?t.error(r.jsxs("div",{style:{padding:"4px"},children:[r.jsxs("div",{style:{fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(S,{size:14,color:"#fbbf24",fill:"#fbbf24"}),"System Maintenance"]}),r.jsx("p",{style:{fontSize:"12px",marginTop:"4px",opacity:.9},children:"The AI engine is currently being refilled with credits. Your personal balance was not affected."})]}),{id:"gen-audio",duration:8e3,style:{borderLeft:"4px solid #fbbf24"}}):e.isUserCreditIssue||403===s.status?t.error(r.jsxs("div",{style:{padding:"4px"},children:[r.jsx("div",{style:{fontWeight:"bold"},children:"Insufficient Credits"}),r.jsx("p",{style:{fontSize:"12px",marginTop:"4px"},children:"You have run out of generation credits. Please buy more to continue creating."})]}),{id:"gen-audio",duration:6e3}):t.error(e.details||e.error||`Audio generation failed (${s.status})`,{id:"gen-audio"})}}catch(a){t.error(`Generation failed: ${a.message}`,{id:"gen-audio"})}finally{Ze(e=>({...e,audio:!1}))}},or=async(e=null)=>{if(Xe.vocals)return;const i=("string"==typeof e?e:null)||Ot.current.lyrics||Ne.lyrics;if(i){Ze(e=>({...e,vocals:!0})),t.loading("Generating AI Vocals (up to 2 mins)...",{id:"gen-vocals"});try{const e=await Xt(),{content:r}=X(i),o=r||i,a={rapper:"rapper-male-1","rapper-melodic":"rapper-male-1","rapper-young":"rapper-male-1","rapper-female":"rapper-female-1","rapper-female-melodic":"rapper-female-1",singer:"singer-male","singer-pop":"singer-male","singer-female":"singer-female","singer-female-pop":"singer-female",narrator:"narrator",whisper:"whisper",spoken:"spoken"}[si]||"rapper-male-1";let s=si,d=xi;"rapper-melodic"===si?(s="rapper",d="melodic"):"rapper-young"===si?(s="rapper",d="trap"):"rapper-female-melodic"===si?(s="rapper-female",d="melodic"):"singer-pop"===si?s="singer":"singer-female-pop"===si&&(s="singer-female");const c=await fetch(`${n}/api/generate-speech`,{method:"POST",headers:e,body:JSON.stringify({prompt:o.substring(0,1500),voice:a,style:s,rapStyle:d,genre:"singer-pop"===si||"singer-female-pop"===si?"pop":bi,language:ce||"English",duration:xe||30,quality:ci,outputFormat:ui,speakerUrl:"cloned"!==si||zt?null:st,elevenLabsVoiceId:"cloned"===si&&zt?zt:"premium"===ci||"cloned"===si?ct:null,backingTrackUrl:(()=>{const e=_e.current?.audio||He.audio;return e&&"string"==typeof e&&e.startsWith("http")?e:null})()})});let p;const u=c.headers.get("content-type");if(!u||!u.includes("application/json"))throw new Error(`Invalid vocal response (${c.status})`);if(p=await c.json(),c.ok&&p.audioUrl){const e=!!He.audio;if(Ge(i=>({...i,vocals:p.audioUrl,lyricsVocal:p.audioUrl,...e?{mixedAudio:p.audioUrl}:{}})),Je(e=>({...e,lyrics:p.provider||"ai"})),Le(e=>({...e,vocals:e.vocals||`AI Vocal Performance generated for "${se||"song"}"`})),Q&&(_||l)){const e=_||l,i=(Q.assets||[]).filter(e=>"vocal"===e.type).length,t=i>0?` (Take ${i+1})`:"",r={id:`vocal-${crypto.randomUUID()}`,title:`Vocal Performance${t}`,type:"vocal",agent:"Ghostwriter",content:o.substring(0,500),audioUrl:p.audioUrl,mimeType:p.mimeType||"audio/wav",version:i+1,settings:{voice:a,voiceStyle:si,vocalQuality:ci,outputFormat:ui,elevenLabsVoiceId:ct||null,voiceSampleUrl:"cloned"===si?st:null,provider:p.provider||"unknown",referencedAudioId:"cloned"===si?st:null},createdAt:(new Date).toISOString()};e({...Q,assets:[r,...Q.assets||[]],updatedAt:(new Date).toISOString()}),Qi(!0)}const i={suno:"Suno AI Singing","bark-singing":"Bark Singing Engine","elevenlabs-premium":"ElevenLabs Premium",bark:"Bark Speech","xtts-v2-clone":"XTTS Voice Clone","gemini-tts":"Gemini TTS","uberduck-tts":"Uberduck TTS"}[p.provider]||p.provider||"AI";t.success(`Vocals generated via ${i}`,{id:"gen-vocals"})}else{const e=p||{};t.error(e.details||e.error||"Vocal generation failed",{id:"gen-vocals"})}}catch(r){t.error("Vocal generation failed",{id:"gen-vocals"})}finally{Ze(e=>({...e,vocals:!1}))}}else t.error("Generate Lyrics & Hook DNA first")},ar=async(e,i)=>{if(Et[e])return;const r=i.target.files[0];if(!r)return;if(r.size>10485760)return void t.error("File too large (max 10MB)");Pt(i=>({...i,[e]:!0}));const o=t.loading(`Uploading ${e} DNA...`,{id:`upload-dna-${e}`});try{const i=await Xt(),a=new FileReader;a.readAsDataURL(r),a.onload=async()=>{try{const c=a.result,u=await fetch(`${n}/api/upload-asset`,{method:"POST",headers:i,body:JSON.stringify({data:c,fileName:`${e}-dna-${Date.now()}-${r.name.replace(/\s+/g,"-")}`,mimeType:r.type,assetType:"visual"===e||"video"===e?"image":"audio"===e?"audio":"document"})}),g=await u.json();if(!u.ok||!g.url)throw new Error(g.error||"Upload failed");{const i=g.url;if("visual"===e&&Dt(i),"audio"===e&&At(i),"video"===e&&Bt(i),"lyrics"===e&&Ft(i),d.currentUser?.uid&&s)try{const t=p(s,"users",d.currentUser.uid);await b(t,{[`${e}DnaUrl`]:i,lastDnaUpdate:Date.now()})}catch(l){}t.success(`${"video"===e?"Image":e.charAt(0).toUpperCase()+e.slice(1)} DNA attached!`,{id:o})}}catch(c){t.error(`Failed to upload ${e} DNA`,{id:o})}finally{Pt(i=>({...i,[e]:!1}))}},a.onerror=()=>{t.error("Failed to read file"),Pt(i=>({...i,[e]:!1}))}}catch(a){t.error("Upload failed",{id:o}),Pt(i=>({...i,[e]:!1}))}},nr=e=>new Promise((i,t)=>{try{const r=document.createElement("video");r.crossOrigin="anonymous",r.muted=!0,r.onloadeddata=()=>{r.currentTime=Math.min(1,.1*r.duration)},r.onseeked=()=>{try{const e=document.createElement("canvas");e.width=r.videoWidth||640,e.height=r.videoHeight||360;e.getContext("2d").drawImage(r,0,0,e.width,e.height);const t=e.toDataURL("image/jpeg",.9);r.remove(),i(t)}catch(e){t(e)}},r.onerror=()=>{t(new Error("Video load failed"))},r.src=e,r.load(),setTimeout(()=>{r.remove(),t(new Error("Frame extraction timeout"))},1e4)}catch(r){t(r)}}),lr=async(e=null)=>{if(Xe.image)return;const i=("string"==typeof e?e:null)||Ot.current.visual||Ne.visual;if(i){Ze(e=>({...e,image:!0})),t.loading("Generating image (~10 seconds)...",{id:"gen-image"});try{const e=await Xt(),{content:r}=X(i),o=r||i,a=await fetch(`${n}/api/generate-image`,{method:"POST",headers:e,body:JSON.stringify({prompt:`Iconic Billboard-standard album cover art, hyper-detailed, professional photography or elite digital art, righteous quality, award-winning composition: ${o.substring(0,800)}`,referenceImage:Tt})});let l;if(!a.headers.get("content-type")?.includes("application/json"))throw new Error(`Invalid image response (${a.status})`);if(l=await a.json(),a.ok){let e=null;if(l.output?e=l.output:l.images&&l.images.length>0?e=l.images[0]:l.imageData&&(e=l.imageData),e){if(Ge(i=>({...i,image:e})),Je(e=>({...e,visual:l.model||l.source||"ai"})),t.success("Image created!",{id:"gen-image"}),Q){const i={id:`img-${crypto.randomUUID()}`,title:`Album Art - ${(new Date).toLocaleTimeString()}`,type:"image",agent:"Visual Artist",imageUrl:e,date:(new Date).toLocaleDateString(),createdAt:(new Date).toISOString()},t=[...Q.assets||[],i];_?.({...Q,assets:t,updatedAt:(new Date).toISOString()}),Qi(!0)}}else await sr()}else{await a.text();await sr()}}catch(r){await sr()}finally{Ze(e=>({...e,image:!1}))}}else t.error("Generate Visual DNA first")},sr=async()=>{const e=He.video||Wi;if(e){t.loading("Extracting frame from video...",{id:"gen-image"});try{const i=await Xt(),r=await fetch(`${n}/api/extract-video-frame`,{method:"POST",headers:i,body:JSON.stringify({videoUrl:e,timestamp:1})});if(r.ok){const i=await r.json();if(i.extractClientSide){const i=await nr(e);if(Ge(e=>({...e,image:i})),t.success("Frame extracted from video!",{id:"gen-image"}),Q){const e={id:`img-${crypto.randomUUID()}`,type:"image",url:i,name:`Video Frame Cover - ${(new Date).toLocaleTimeString()}`,createdAt:(new Date).toISOString()},t=[...Q.assets||[],e];_?.({...Q,assets:t,updatedAt:(new Date).toISOString()}),Qi(!0)}return}if(i.output||i.imageData){const e=i.output||`data:${i.mimeType||"image/jpeg"};base64,${i.imageData}`;if(Ge(i=>({...i,image:e})),t.success("Frame extracted from video!",{id:"gen-image"}),Q){const i={id:`img-${crypto.randomUUID()}`,type:"image",url:e,name:`Video Frame Cover - ${(new Date).toLocaleTimeString()}`,createdAt:(new Date).toISOString()},t=[...Q.assets||[],i];_?.({...Q,assets:t,updatedAt:(new Date).toISOString()}),Qi(!0)}return}}const o=await nr(e);Ge(e=>({...e,image:o})),t.success("Frame extracted from video!",{id:"gen-image"})}catch(i){t.error("Could not extract frame from video",{id:"gen-image"})}}else t.error("No image or video available",{id:"gen-image"})},dr=async(e=null)=>{if(Xe.video)return;const i=("string"==typeof e?e:null)||Ot.current.video||Ne.video||`${ue||"cinematic"} music video for "${se||"original song"}", ${ke||"energetic"} mood, professional quality`;Ze(e=>({...e,video:!0}));try{const e=await Xt(),{content:l}=X(i),s=l||i,d=He.mixedAudio||He.audio;if(d){const i=Math.max(xe||60,60);t.loading(`Creating ${i}s music video (3-10 min)...`,{id:"gen-video",duration:6e5});const r=e.Authorization?"/api/generate-synced-video":"/api/generate-synced-video-test",l=await fetch(`${n}${r}`,{method:"POST",headers:{"Content-Type":"application/json",...e},body:JSON.stringify({audioUrl:d,videoPrompt:`${Tt||Vt?"Feature the artist from the reference image. ":""}Elite cinematic music video, professional motion design, high-fidelity quality: ${s.substring(0,700)}`,imageUrl:He.image,videoUrl:He.video,referenceImage:Tt||Vt,songTitle:se||"Untitled",style:ue||"cinematic",duration:i})});if(!l.ok){const e=await l.json().catch(()=>({}));return void(503===l.status?t.error("Video API not configured",{id:"gen-video"}):t.error(e.error||"Video generation failed",{id:"gen-video"}))}const c=await l.json();if(c.jobId){t.loading("Music video rendering... 0%",{id:"gen-video",duration:12e5});const r=120;let a=!1;for(let l=0;l<r;l++){await new Promise(e=>setTimeout(e,1e4));try{const r=await fetch(`${n}/api/video-job-status/${c.jobId}`,{headers:e}),o=await r.json();if("completed"===o.status&&o.videoUrl){if(Ge(e=>({...e,video:o.videoUrl})),Je(e=>({...e,video:"synced-music-video"})),t.success(`Music video created! (${o.duration||i}s)`,{id:"gen-video"}),a=!0,Q){const e={id:`vid-${crypto.randomUUID()}`,title:`Music Video - ${(new Date).toLocaleTimeString()}`,type:"video",agent:"Video Director",videoUrl:o.videoUrl,duration:o.duration,bpm:o.bpm,date:(new Date).toLocaleDateString(),createdAt:(new Date).toISOString()},i=[...Q.assets||[],e];_?.({...Q,assets:i,updatedAt:(new Date).toISOString()}),Qi(!0)}break}if("failed"===o.status){t.error(o.error||"Video generation failed",{id:"gen-video"});break}t.loading(`Music video rendering... ${o.progress||0}%`,{id:"gen-video"})}catch(o){}}return void(a||t.error("Video generation timed out â€” check back later",{id:"gen-video"}))}if(c.videoUrl){if(Ge(e=>({...e,video:c.videoUrl})),Je(e=>({...e,video:"synced-music-video"})),t.success(`Music video created! (${c.duration||i}s, ${c.bpm||"?"} BPM)`,{id:"gen-video"}),Q){const e={id:`vid-${crypto.randomUUID()}`,title:`Music Video - ${(new Date).toLocaleTimeString()}`,type:"video",agent:"Video Director",videoUrl:c.videoUrl,duration:c.duration,bpm:c.bpm,date:(new Date).toLocaleDateString(),createdAt:(new Date).toISOString()},i=[...Q.assets||[],e];_?.({...Q,assets:i,updatedAt:(new Date).toISOString()}),Qi(!0)}if(!He.image)try{const e=await nr(c.videoUrl);Ge(i=>({...i,image:e}))}catch(a){}return}return void t.error("Unexpected video response",{id:"gen-video"})}t.loading("Generating video clip (this takes ~2 min)...",{id:"gen-video"});const c=await fetch(`${n}/api/generate-video`,{method:"POST",headers:e,body:JSON.stringify({prompt:`Elite cinematic music video visual, professional motion design, high-fidelity righteous quality, award-winning storyboard: ${s.substring(0,700)}`,referenceImage:Tt||Vt,referenceVideo:Vt,duration:xe,audioDuration:xe,audioUrl:He.mixedAudio||He.audio,vocalUrl:He.mixedAudio?null:He.vocals||He.lyricsVocal})});if(c.ok){let i=await c.json();if("processing"===i.status&&i.operationId){t.loading("Video rendering in progress...",{id:"gen-video",duration:3e5});const r=60;let a=!1;for(let l=0;l<r;l++){await new Promise(e=>setTimeout(e,5e3));try{const r=await fetch(`${n}/api/video-status/${i.operationId}`,{headers:e}),o=await r.json();if("processing"===o.status)continue;if("completed"===o.status){i=o,a=!0;break}return void t.error(o.error||"Video generation failed",{id:"gen-video"})}catch(o){}}if(!a)return void t.error("Video generation timed out â€” please try again",{id:"gen-video"})}if("image"===i.type||i.mimeType&&i.mimeType.startsWith("image/")){const e=i.output||i.imageUrl;if(e&&"string"==typeof e){const r=e.startsWith("data:")||e.startsWith("http")?e:`data:${i.mimeType||"image/png"};base64,${e}`;Ge(e=>({...e,image:r})),t.success("Cover image generated! (Video generation unavailable)",{id:"gen-video",duration:5e3})}else t.error("Video generation unavailable",{id:"gen-video"})}else{const e=i.videoUrl||i.output||i.video;if(e&&"string"==typeof e&&(e.startsWith("http")||e.startsWith("blob:")||e.startsWith("/api/"))){if(Ge(i=>({...i,video:e})),Je(e=>({...e,video:i.source||i.provider||"ai"})),t.success(i.isDemo?"Demo video loaded!":"Video created!",{id:"gen-video"}),Q){const i={id:`vid-${crypto.randomUUID()}`,title:`Music Video - ${(new Date).toLocaleTimeString()}`,type:"video",agent:"Video Director",videoUrl:e,date:(new Date).toLocaleDateString(),createdAt:(new Date).toISOString()},t=[...Q.assets||[],i];_?.({...Q,assets:t,updatedAt:(new Date).toISOString()}),Qi(!0)}if(!He.image){t.loading("Extracting cover frame...",{id:"extract-frame"});try{const i=await nr(e);Ge(e=>({...e,image:i})),t.success("Cover image extracted!",{id:"extract-frame"})}catch(a){t.dismiss("extract-frame")}}}else t.error(i.message||"Video generation unavailable",{id:"gen-video"})}}else{const e=await c.json().catch(()=>({}));503===c.status&&e.setup?t.error(r.jsxs("div",{children:[r.jsx("strong",{children:"Video API Not Ready"}),r.jsx("p",{style:{fontSize:"12px",marginTop:"4px"},children:e.details})]}),{id:"gen-video",duration:8e3}):t.error(e.details||e.error||"Video generation failed",{id:"gen-video"})}}catch(l){t.error("Video generation failed",{id:"gen-video"})}finally{Ze(e=>({...e,video:!1}))}},cr=async()=>{if(zi)return;const e=!(!He.vocals&&!He.lyricsVocal),i=!!He.audio;if(e||i){Ii(!0);try{let r=He.mixedAudio,o=!!r;if(!r&&e&&i){t.loading("Mixing vocals + beat into master (~15s)...",{id:"final-mix"});const e=await Xt(),i=await fetch(`${n}/api/create-final-mix`,{method:"POST",headers:e,body:JSON.stringify({vocalUrl:He.vocals||He.lyricsVocal,beatUrl:He.audio,style:si||"rapper",outputFormat:ui||"music",genre:bi||ue,vocalVolume:Ti,beatVolume:$i})});if(i.ok){const e=await i.json();r=e.mixedAudioUrl,o=!0,Ge(e=>({...e,mixedAudio:r}))}else{const e=await i.json().catch(()=>({}));t.error(`Mix failed: ${e.error||"Server error"} â€” using individual tracks`,{id:"final-mix"})}}r||(r=He.vocals||He.lyricsVocal||He.audio);const l={id:`mix-${crypto.randomUUID()}`,title:`${se} - Complete Mix`,description:`Full production of "${se}" with lyrics, beat, visual, and video`,created:(new Date).toISOString(),mixedAudioUrl:r,components:{lyrics:{content:Ne.lyrics,agent:a.find(e=>e.id===We.lyrics)?.name||"Ghostwriter",vocalUrl:He.lyricsVocal||null},audio:{content:Ne.audio,agent:a.find(e=>e.id===We.audio)?.name||"Beat Maker",audioUrl:He.audio||null,mixedAudioUrl:r||null},visual:{content:Ne.visual,agent:a.find(e=>e.id===We.visual)?.name||"Designer",imageUrl:He.image||null},video:{content:Ne.video,agent:a.find(e=>e.id===We.video)?.name||"Video Creator",videoUrl:Wi||He.video||null,musicVideoUrl:Wi||null,isSynced:!!Wi}},settings:{language:ce,style:ue,model:ve,bpm:Ve,musicVideoUrl:Wi||null}};Ui(l);const s=_||(()=>{});if(Q&&r){const e={id:`mix-${crypto.randomUUID()}`,title:`${se||"Untitled"} - Master Mix`,type:"mix",agent:"Final Mix",content:"Master mix: vocals + beat"+(Wi?" + music video":""),audioUrl:r,mimeType:"audio/mpeg",version:1,settings:{voiceStyle:si||"rapper",outputFormat:ui||"music",genre:bi||ue,hasMusicVideo:!!Wi},createdAt:(new Date).toISOString()},i=(Q.assets||[]).filter(e=>"mix"!==e.type);s({...Q,assets:[e,...i],updatedAt:(new Date).toISOString()}),Qi(!0)}t.success(o?"Master mix ready!":"Project compiled (generate both vocals & beat for full mix)",{id:"final-mix"})}catch(r){t.error("Failed to create final mix",{id:"final-mix"})}finally{Ii(!1)}}else t.error("Generate vocals and/or beat first")},pr=async e=>{const i=Ne[e];if(!i&&!He["visual"===e?"image":"lyrics"===e?"vocals":e])return;const t=qt.find(i=>i.key===e),r=se||"media";if(i){const o="string"==typeof i?i:JSON.stringify(i,null,2),a=new Blob([o],{type:"text/plain"}),n=URL.createObjectURL(a),l=document.createElement("a");l.href=n,l.download=`${r}-${t?.title||e}.txt`,l.click(),URL.revokeObjectURL(n)}const o={audio:He.audio,visual:He.image,video:He.video,lyrics:He.vocals}[e];if(o){let i=o;"visual"===e&&(i=v(o)),"audio"===e&&(i=f(o)),"video"===e&&(i=j(o)),"lyrics"===e&&(i=f(o));const t=`${r}-${e}${{audio:".mp3",visual:".png",video:".mp4",lyrics:".wav"}[e]||""}`;try{if(i.startsWith("data:")||i.startsWith("blob:")){const e=document.createElement("a");e.href=i,e.download=t,e.click()}else{const e=await fetch(i),r=await e.blob(),o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=t,a.click(),URL.revokeObjectURL(o)}}catch(a){window.open(i,"_blank","noopener")}}if("video"===e&&o){const e={title:se||"Untitled",createdAt:(new Date).toISOString(),genre:ue||bi||"Unknown",bpm:Ve||null,duration:xe||null,language:ce||"English",mood:ke||null,structure:ze||null,voiceStyle:si||null,videoUrl:o,audioUrl:He.mixedAudio||He.audio||null,imageUrl:He.image||null,vocalsUrl:He.vocals||He.lyricsVocal||null,musicVideoUrl:Wi||null,lyrics:Ne.lyrics||null,beatDescription:Ne.audio||null,visualConcept:Ne.visual||null,videoDescription:Ne.video||null,agents:{lyrics:We.lyrics||null,audio:We.audio||null,visual:We.visual||null,video:We.video||null}},i=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(i),a=document.createElement("a");a.href=t,a.download=`${r}-project-metadata.json`,setTimeout(()=>{a.click(),URL.revokeObjectURL(t)},500)}},ur=e=>{Le(i=>({...i,[e]:null})),Ot.current[e]=null,"audio"===e&&Ge(e=>({...e,audio:null})),"visual"===e&&Ge(e=>({...e,image:null})),"video"===e&&(Ge(e=>({...e,video:null})),Fi(null)),"lyrics"===e&&Ge(e=>({...e,vocals:null})),t.success("Deleted")},gr=(e,i)=>{Le(t=>({...t,[e]:i})),Ot.current[e]=i,t.success("Saved")},xr=()=>{const e=Object.values(Ne).some(e=>null!==e),i=Object.values(He).some(e=>null!==e);if(!e&&!i)return void t.error("No content to save! Generate some content first.");const r=[];if(qt.forEach(e=>{const i=Ne[e.key];if(i){const t=a.find(i=>i.id===We[e.key]);let o="string"==typeof i?i:JSON.stringify(i);if("lyrics"===e.key){const{content:e}=X(o);e&&(o=e)}const n={id:`${e.key}-${crypto.randomUUID()}`,title:e.title,type:e.key,agent:t?.name||e.subtitle,content:o,snippet:o.substring(0,100),audioUrl:"audio"===e.key?He.audio||null:"lyrics"===e.key&&He.vocals||null,imageUrl:"visual"===e.key&&v(He.image)||null,videoUrl:"video"===e.key&&He.video||null,date:(new Date).toLocaleDateString(),createdAt:(new Date).toISOString(),color:`agent-${(e.color||"").replace("#","")}`};r.push(n)}}),Wi){const e={id:`mvideo-${crypto.randomUUID()}`,title:"Professional Music Video",type:"video",agent:"Orchestrator Sync",content:`Professional synced production for "${se}"`,videoUrl:j(Wi),date:(new Date).toLocaleDateString(),createdAt:(new Date).toISOString(),isPremium:!0,color:"agent-ec4899"};r.push(e)}if(Ri){const e={id:`fmix-${crypto.randomUUID()}`,title:"Full Production Master",type:"pro",agent:"Studio Orchestrator",content:"string"==typeof Ri?Ri:JSON.stringify(Ri),audioUrl:f(He.audio),videoUrl:j(Wi||He.video),imageUrl:v(He.image),date:(new Date).toLocaleDateString(),createdAt:(new Date).toISOString(),color:"agent-4f46e5"};r.push(e)}const o={id:Q?.id||crypto.randomUUID(),name:ti||se||Q?.name||"Untitled Project",description:`Created with Studio Orchestrator: "${se}"`,category:Q?.category||"Music",language:ce,style:ue,model:ve,bpm:Ve,structure:ze,duration:xe,musicalBars:be,useBars:he,date:Q?.date||(new Date).toLocaleDateString(),createdAt:Q?.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString(),agents:Object.values(We).filter(Boolean).map(e=>{const i=a.find(i=>i.id===e);return i?.name||e}),assets:[...Q?.assets||[],...r],coverImage:v(He.image)||Q?.coverImage||null},n=!!Q?.id?_||l:l||_;if(n)try{return n(o),t.success(`Saved ${o.assets.length} assets to "${o.name}"!`),Qi(!0),ai(!1),void Li(!0)}catch(s){t.error("Save failed - callback error")}else t.error("Save failed - no backend connection");ai(!1)};return Qe.current=xr,e?r.jsxs("div",{className:"studio-orchestrator-overlay animate-fadeIn",style:{position:"fixed",top:0,left:0,right:0,height:"100dvh",background:"linear-gradient(180deg, rgba(0,0,0,0.98) 0%, rgba(10,10,20,0.98) 100%)",zIndex:1e4,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:ne?"12px 16px":"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid rgba(255,255,255,0.1)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",position:"sticky",top:0,zIndex:10},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("div",{style:{width:ne?"40px":"48px",height:ne?"40px":"48px",borderRadius:"14px",background:"linear-gradient(135deg, #8b5cf6, #06b6d4)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 20px rgba(139, 92, 246, 0.3)"},children:r.jsx(S,{size:ne?22:26,color:"white"})}),r.jsxs("div",{children:[r.jsxs("h2",{style:{margin:0,fontSize:ne?"1.1rem":"1.4rem",fontWeight:"700"},children:["Studio Orchestrator ",r.jsx("span",{style:{color:"var(--color-purple)",fontSize:"0.6em",border:"1px solid var(--color-purple)",padding:"1px 4px",borderRadius:"4px",marginLeft:"6px"},children:"V3.5"})]}),r.jsx("p",{style:{margin:0,fontSize:ne?"0.75rem":"0.8rem",color:"var(--text-secondary)"},children:"4 AI Generators â€¢ One Unified Pipeline"})]})]}),r.jsx("button",{onClick:()=>{!Object.values(Lt).some(Boolean)&&!Object.values(Ht).some(Boolean)||Ki?o?.():Ji(!0)},style:{background:"rgba(255,255,255,0.1)",border:"none",borderRadius:"12px",width:ne?"38px":"44px",height:ne?"38px":"44px",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},children:r.jsx(w,{size:20,color:"white"})})]}),r.jsxs("div",{className:"orchestrator-scroll-container",style:{flex:1,padding:ne?"6px 2px":"10px 12px",maxWidth:"1200px",margin:"0 auto",width:"100%",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch"},children:[r.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:ne?"10px":"14px",padding:ne?"6px":"12px",marginBottom:ne?"8px":"14px",border:"1px solid rgba(255,255,255,0.06)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"8px"},children:r.jsxs("button",{onClick:()=>it(!et),style:{background:"none",border:"none",color:"rgba(139, 92, 246, 0.8)",fontSize:"0.75rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",padding:"4px 8px",borderRadius:"6px",transition:"all 0.2s"},children:[r.jsx(k,{size:12}),et?"Advanced Mode":"Quick Mode"]})}),et?r.jsxs("div",{style:{display:"flex",flexDirection:ne?"column":"row",gap:"10px",alignItems:ne?"stretch":"center"},children:[r.jsx("input",{value:se,onChange:e=>de(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),Fe({lyrics:"ghost",audio:"beat",visual:"album",video:"video-creator"}),Gt(tt),ir())},placeholder:"Describe your song in one line...",style:{flex:1,padding:"14px 20px",borderRadius:"12px",background:"rgba(0,0,0,0.5)",border:"1px solid rgba(255,255,255,0.15)",color:"white",fontSize:ne?"0.9rem":"1rem",outline:"none",minHeight:"52px",fontFamily:"inherit"}}),r.jsx("select",{value:tt,onChange:e=>{rt(e.target.value),Gt(e.target.value)},style:{padding:"14px 16px",borderRadius:"12px",background:"rgba(0,0,0,0.5)",border:"1px solid rgba(139, 92, 246, 0.3)",color:"#a78bfa",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",outline:"none",minHeight:"52px",minWidth:ne?"auto":"160px",WebkitAppearance:"none",appearance:"none",backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238b5cf6' d='M6 8L1 3h10z'/%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center"},children:ee.map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))}),r.jsx("button",{onClick:()=>{Fe({lyrics:"ghost",audio:"beat",visual:"album",video:"video-creator"}),Gt(tt),ir()},disabled:Ee||!se.trim(),style:{padding:"14px 28px",borderRadius:"12px",background:Ee?"rgba(139, 92, 246, 0.3)":"linear-gradient(135deg, #8b5cf6, #06b6d4)",border:"none",color:"white",fontWeight:"700",fontSize:"1rem",cursor:Ee||!se.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:se.trim()?1:.5,boxShadow:Ee?"none":"0 4px 20px rgba(139, 92, 246, 0.4)",minHeight:"52px",whiteSpace:"nowrap",minWidth:ne?"auto":"160px"},children:Ee?r.jsxs(r.Fragment,{children:[r.jsx(C,{size:18,className:"spin"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(z,{size:18}),"Create Song"]})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:ne?"8px":"12px",marginBottom:ne?"12px":"16px"},children:[r.jsx("textarea",{value:se,onChange:e=>de(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ir())},placeholder:"Describe your song idea, vibe, or concept...",rows:ne?3:2,style:{width:"100%",padding:ne?"10px 12px":"16px 20px",borderRadius:"12px",background:"rgba(0,0,0,0.5)",border:"1px solid rgba(255,255,255,0.15)",color:"white",fontSize:ne?"0.9rem":"1rem",outline:"none",minHeight:ne?"100px":"56px",resize:"none",fontFamily:"inherit",lineHeight:"1.5"}}),r.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[{id:"single",label:"Single",desc:"1V + Chorus"},{id:"full",label:"Full Track",desc:"2V + Chorus + Bridge"},{id:"extended",label:"Extended",desc:"3V + 2C + Bridge + Outro"}].map(e=>r.jsxs("button",{onClick:()=>fi(e.id),style:{padding:"6px 12px",borderRadius:"8px",background:hi===e.id?"rgba(139, 92, 246, 0.25)":"rgba(255,255,255,0.05)",border:"1px solid "+(hi===e.id?"#8b5cf6":"rgba(255,255,255,0.1)"),color:hi===e.id?"#a78bfa":"var(--text-secondary)",fontSize:"0.75rem",fontWeight:hi===e.id?"600":"400",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[e.label,r.jsx("span",{style:{fontSize:"0.65rem",opacity:.6},children:e.desc})]},e.id))}),r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:ni?()=>{Mt.current&&Mt.current.stop(),li(!1)}:()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const i=window.SpeechRecognition||window.webkitSpeechRecognition;if(!i||"function"!=typeof i)return void t.error("Voice recognition not supported");try{Mt.current=new i,Mt.current.continuous=!1,Mt.current.interimResults=!0,Mt.current.onresult=e=>{const i=Array.from(e.results).map(e=>e[0].transcript).join("");de(i)},Mt.current.onend=()=>li(!1),Mt.current.onerror=e=>{li(!1)},Mt.current.start(),li(!0),t.success("Listening...")}catch(e){t.error("Voice input failed")}}else t.error("Speech recognition not supported")},style:{padding:"14px 16px",borderRadius:"12px",background:ni?"rgba(239, 68, 68, 0.2)":"rgba(255,255,255,0.05)",border:"1px solid "+(ni?"#ef4444":"rgba(255,255,255,0.15)"),color:ni?"#ef4444":"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"52px",minHeight:"52px"},title:ni?"Stop Listening":"Voice Input",children:ni?r.jsx(I,{size:22}):r.jsx(R,{size:22})}),r.jsx("button",{onClick:ir,disabled:Ee||!se.trim()||0===Object.values(We).filter(Boolean).length,style:{flex:1,padding:"14px 24px",borderRadius:"12px",background:Ee?"rgba(139, 92, 246, 0.3)":"linear-gradient(135deg, #8b5cf6, #06b6d4)",border:"none",color:"white",fontWeight:"700",fontSize:"1rem",cursor:Ee||!se.trim()||0===Object.values(We).filter(Boolean).length?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",opacity:se.trim()&&0!==Object.values(We).filter(Boolean).length?1:.5,boxShadow:Ee?"none":"0 4px 20px rgba(139, 92, 246, 0.4)",minHeight:"52px"},children:Ee?r.jsxs(r.Fragment,{children:[r.jsx(C,{size:20,className:"spin"}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(z,{size:20}),"Generate ",4===Object.values(We).filter(Boolean).length?"All":`${Object.values(We).filter(Boolean).length} Output${1!==Object.values(We).filter(Boolean).length?"s":""}`]})})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",alignItems:"center",paddingBottom:"4px"},children:[r.jsxs("button",{onClick:()=>Gi(!Hi),style:{padding:"8px 14px",borderRadius:"10px",background:Hi?"rgba(139, 92, 246, 0.2)":"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:Hi?"#a855f7":"var(--text-secondary)",fontSize:"0.8rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",minHeight:"40px",whiteSpace:"nowrap"},children:[r.jsx(U,{size:14}),Hi?"Hide Ideas":"Need Ideas?"]}),Hi&&["Summer love in Brooklyn","Trap anthem about success","Lo-fi study beats","Emotional R&B ballad"].map((e,i)=>r.jsx("button",{onClick:()=>{de(e),Gi(!1)},style:{padding:"10px 16px",borderRadius:"20px",background:"rgba(139, 92, 246, 0.15)",border:"1px solid rgba(139, 92, 246, 0.3)",color:"rgba(255,255,255,0.8)",fontSize:"0.85rem",cursor:"pointer",whiteSpace:"nowrap",minHeight:"40px"},children:e},i))]})]})]}),(()=>{const e={audio:"Beat Audio",vocals:"Vocals",image:"Artwork",video:"Video"},i={audio:"#22d3ee",vocals:"#a78bfa",image:"#fb923c",video:"#f87171"},t=Object.entries(Xe).filter(([,e])=>e),o=Object.entries(Oe).filter(([,e])=>e),a=[...t.map(([t])=>({key:t,label:`Creating ${e[t]||t}...`,color:i[t]||"#8b5cf6"})),...o.filter(([e])=>!t.some(([i])=>i===e)).map(([e])=>({key:`slot-${e}`,label:`Generating ${e} concept...`,color:"#8b5cf6"}))];return 0===a.length||Ee&&nt.length>0?null:r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"16px",padding:"12px 16px",background:"rgba(139, 92, 246, 0.06)",borderRadius:"12px",border:"1px solid rgba(139, 92, 246, 0.15)",alignItems:"center"},children:[r.jsx(C,{size:14,className:"spin",style:{color:"#8b5cf6",flexShrink:0}}),a.map(e=>r.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:e.color,background:`${e.color}15`,padding:"4px 10px",borderRadius:"6px",border:`1px solid ${e.color}30`},children:e.label},e.key))]})})(),Ee&&nt.length>0&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:"12px",padding:ne?"12px":"16px",marginBottom:"16px",border:"1px solid rgba(139, 92, 246, 0.15)"},children:[r.jsxs("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(C,{size:14,className:"spin",style:{color:"#8b5cf6"}}),"Pipeline Progress"]}),nt.map(e=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"6px 0",opacity:"pending"===e.status?.4:1,transition:"opacity 0.3s"},children:["done"===e.status?r.jsx(T,{size:16,style:{color:"#22c55e",flexShrink:0}}):"active"===e.status?r.jsx(C,{size:16,className:"spin",style:{color:"#8b5cf6",flexShrink:0}}):"error"===e.status?r.jsx(w,{size:16,style:{color:"#ef4444",flexShrink:0}}):r.jsx("div",{style:{width:16,height:16,borderRadius:"50%",border:"2px solid rgba(255,255,255,0.15)",flexShrink:0}}),r.jsx("span",{style:{fontSize:"0.8rem",color:"active"===e.status?"#a78bfa":"done"===e.status?"#22c55e":"error"===e.status?"#ef4444":"rgba(255,255,255,0.5)",fontWeight:"active"===e.status?"600":"400",flex:1},children:e.label}),"done"===e.status&&e.startTime&&e.endTime&&r.jsxs("span",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.3)"},children:[((e.endTime-e.startTime)/1e3).toFixed(1),"s"]}),"error"===e.status&&r.jsx("button",{onClick:async()=>{Jt(e.id,"active");try{const i=await Xt();if("beat-audio"===e.id)await rr(Ne.audio);else if("vocals"===e.id)await or(Ne.lyrics);else if("image"===e.id)await lr(Ne.visual);else if("video"===e.id)await dr(Ne.video);else if("mux"===e.id){const e=_e.current.video,t=_e.current.mixedAudio||_e.current.audio;e&&t&&await _t(e,t,i)}else"final"===e.id&&await cr();Jt(e.id,"done")}catch(i){Jt(e.id,"error"),t.error(`Retry failed for: ${e.label}`)}},style:{padding:"2px 8px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)",color:"#ef4444",fontSize:"0.65rem",fontWeight:"600",cursor:"pointer"},children:"Retry"}),"active"===e.status&&e.startTime&&r.jsx("span",{style:{fontSize:"0.7rem",color:"rgba(139, 92, 246, 0.6)"},children:"..."})]},e.id))]}),!et&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(130px, 1fr))",gap:"10px",marginBottom:"20px"},children:[[{label:"Language",value:ce,setter:pe,options:ie},{label:"Genre",value:ue,setter:e=>Gt(e),options:ee},{label:"Project BPM",value:Ve,setter:Be,options:[70,80,90,100,110,120,130,140,150,160]},{label:"Timing Mode",value:he?"Bars":"Seconds",setter:e=>fe("Bars"===e),options:["Bars","Seconds"]},{label:"Musical Bars",value:be,setter:ye,options:[4,8,16,32,64],hidden:!he},{label:"Target Duration",value:xe,setter:me,options:[15,30,60,90,120,180,240,300],hidden:he},{label:"Structure",value:ze,setter:Ie,options:["Full Song","Radio Edit","Extended","Loop","Intro","Verse","Chorus","Outro"]},{label:"AI Model",value:ve,setter:je,options:["Gemini 2.0 Flash","Gemini 2.0 Pro (Exp)","Gemini 1.5 Pro"]},{label:"Mood",value:ke,setter:Ce,options:["Chill","Energetic","Dark","Happy","Epic","Mysterious","Dreamy"]},{label:"Music Engine",value:Se,setter:we,options:["Beat Lab (MusicGen)","Mureaka","Riffusion (Visual)","Stability Pro","Uberduck","Auto-Selection"]},{label:"Stem Mode",value:$e,setter:Ae,options:["Full Mix","Drums Only","No Drums","Melody Only","Bass Only"]}].filter(e=>!e.hidden).map(e=>r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"0.7rem",color:"var(--text-secondary)",marginBottom:"6px",textTransform:"uppercase",fontWeight:"600",letterSpacing:"0.05em"},children:e.label}),r.jsx("select",{value:"Music Engine"===e.label?"music-gpt"===Se?"Beat Lab (MusicGen)":"mureka"===Se?"Mureaka":"riffusion"===Se?"Riffusion (Visual)":"stability"===Se?"Stability Pro":"uberduck"===Se?"Uberduck":"Auto-Selection":e.value,onChange:i=>{const t=i.target.value;"Music Engine"===e.label?we("Beat Lab (MusicGen)"===t?"music-gpt":"Mureaka"===t?"mureka":"Riffusion (Visual)"===t?"riffusion":"Stability Pro"===t?"stability":"Uberduck"===t?"uberduck":"auto"):["Musical Bars","Project BPM","Target Duration"].includes(e.label)?e.setter(parseInt(t)):e.setter(t)},style:{width:"100%",padding:"12px 14px",borderRadius:"10px",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.85rem",cursor:"pointer",outline:"none",minHeight:"48px",WebkitAppearance:"none",appearance:"none",backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23888' d='M6 8L1 3h10z'/%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center"},children:e.options.map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))})]},e.label)),r.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[r.jsx("label",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginBottom:"6px",textTransform:"uppercase",fontWeight:"600"},children:"High Musicality (Udio)"}),r.jsxs("button",{onClick:()=>Ue(!Re),style:{height:"48px",borderRadius:"10px",background:Re?"rgba(139, 92, 246, 0.2)":"rgba(0,0,0,0.4)",border:"1px solid "+(Re?"#8b5cf6":"rgba(255,255,255,0.1)"),color:Re?"#a78bfa":"var(--text-secondary)",display:"flex",alignItems:"center",gap:"8px",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},children:[r.jsx(D,{size:14}),Re?"Enabled":"Disabled"]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("label",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginBottom:"6px",textTransform:"uppercase",fontWeight:"600"},children:"Generation Seed"}),r.jsxs("div",{style:{display:"flex",gap:"4px"},children:[r.jsx("input",{type:"number",value:Te,onChange:e=>De(parseInt(e.target.value)),style:{flex:1,height:"48px",padding:"0 12px",borderRadius:"10px 0 0 10px",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.8rem",outline:"none"},placeholder:"Random"}),r.jsx("button",{onClick:()=>De(Math.floor(1e6*Math.random())),style:{padding:"0 12px",borderRadius:"0 10px 10px 0",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderLeft:"none",color:"var(--text-secondary)",cursor:"pointer"},title:"Randomize Seed",children:r.jsx($,{size:14})})]})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginBottom:"20px",alignItems:"center"},children:[r.jsx("span",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em",marginRight:"4px"},children:"Output For:"}),Object.entries(te).map(([e,i])=>r.jsxs("button",{onClick:()=>Yt(e),style:{padding:"6px 12px",borderRadius:"20px",background:ot===e?"rgba(139, 92, 246, 0.25)":"rgba(255,255,255,0.04)",border:"1px solid "+(ot===e?"rgba(139, 92, 246, 0.5)":"rgba(255,255,255,0.1)"),color:ot===e?"#a78bfa":"rgba(255,255,255,0.6)",fontSize:"0.75rem",fontWeight:ot===e?"600":"400",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[r.jsx("span",{children:i.icon})," ",e]},e))]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:"16px",padding:ne?"16px":"20px",border:"1px solid rgba(255,255,255,0.06)",marginBottom:"24px"},children:[r.jsx("div",{style:{display:"flex",alignItems:ne?"flex-start":"center",justifyContent:"space-between",gap:"8px",marginBottom:"16px",flexWrap:"wrap",flexDirection:ne?"column":"row"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(A,{size:ne?14:16,color:"var(--text-secondary)"}),r.jsx("span",{style:{fontSize:ne?"0.75rem":"0.8rem",color:"var(--text-secondary)",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Choose Your Generators"}),r.jsxs("span",{style:{padding:"2px 8px",borderRadius:"10px",background:"rgba(139, 92, 246, 0.3)",color:"#a78bfa",fontSize:"0.7rem",fontWeight:"600"},children:[Object.values(We).filter(Boolean).length," / 4 active"]})]})}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px"},children:qt.map(e=>r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[r.jsx("label",{style:{fontSize:"0.7rem",color:e.color,fontWeight:"500"},children:e.title}),We[e.key]&&r.jsx("div",{title:`${a.find(i=>i.id===We[e.key])?.name} Capabilities:\nâ€¢ ${a.find(i=>i.id===We[e.key])?.capabilities?.join("\nâ€¢ ")}`,style:{color:"rgba(255,255,255,0.3)",cursor:"help"},children:r.jsx(W,{size:12})})]}),r.jsxs("select",{value:We[e.key]||"",onChange:i=>Fe(t=>({...t,[e.key]:i.target.value||null})),style:{width:"100%",padding:"10px 12px",borderRadius:"10px",background:We[e.key]?"rgba(0,0,0,0.4)":"rgba(0,0,0,0.2)",border:"1px solid "+(We[e.key]?e.color+"60":"rgba(255,255,255,0.1)"),color:We[e.key]?"white":"var(--text-muted)",fontSize:"0.85rem",cursor:"pointer",outline:"none"},children:[r.jsx("option",{value:"",style:{background:"#1a1a1a"},children:"â€” None â€”"}),a.filter(e=>"Pro"===re||("Monthly"===re?"free"===e.tier||"monthly"===e.tier:"free"===e.tier)).filter(i=>"lyrics"===e.key?"Music Creation"===i.category||"Pro Performer"===i.category||"ghost"===i.id||"vocal-arch"===i.id:"audio"===e.key?"Pro Producer"===i.category||"Music Creation"===i.category||"beat"===i.id||"beat-arch"===i.id:"visual"===e.key?"Visual Identity"===i.category||"album"===i.id:"video"!==e.key||("Visual Identity"===i.category||"video-creator"===i.id)).map(e=>r.jsxs("option",{value:e.id,style:{background:"#1a1a1a"},disabled:e.comingSoon,children:[e.name," ",e.comingSoon?"(Coming Soon)":e.isBeta?"(Beta)":""]},e.id))]})]},e.key))})]}),Ne.lyrics&&r.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(139, 92, 246, 0.05) 100%)",borderRadius:"16px",padding:"24px",border:"1px solid rgba(139, 92, 246, 0.4)",marginBottom:"24px"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:r.jsxs("div",{children:[r.jsx("h4",{style:{margin:"0 0 6px",fontSize:"1rem",fontWeight:"700",color:"#8b5cf6"},children:"ðŸŽ¤ Ghostwriter Vocal Performance"}),r.jsx("p",{style:{margin:0,fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Generate audio of the lyrics being recited or sung by different voice types"})]})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[r.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"12px",padding:"16px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:[r.jsx("div",{style:{fontSize:"0.7rem",color:"#8b5cf6",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"12px"},children:"ðŸ“ Lyrics Text"}),r.jsx("div",{style:{background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"12px",maxHeight:"150px",overflowY:"auto",fontSize:"0.9rem",lineHeight:"1.6",color:"rgba(255,255,255,0.85)",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"'Georgia', 'Times New Roman', serif"},children:Ne.lyrics})]}),r.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"12px",padding:"16px",border:"1px solid rgba(139, 92, 246, 0.3)",display:"flex",flexDirection:"column"},children:[r.jsx("div",{style:{fontSize:"0.7rem",color:"#8b5cf6",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"12px"},children:"ðŸŽµ Vocal Audio"}),He.lyricsVocal?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",flex:1},children:[r.jsx("audio",{src:f(He.lyricsVocal),controls:!0,style:{width:"100%",height:"38px",borderRadius:"8px"}}),r.jsxs("button",{onClick:()=>wi(!0),style:{padding:"10px 16px",borderRadius:"8px",background:"rgba(139, 92, 246, 0.3)",border:"1px solid rgba(139, 92, 246, 0.5)",color:"#8b5cf6",fontWeight:"600",fontSize:"0.85rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},"aria-label":"Open vocal audio fullscreen",children:[r.jsx(F,{size:14}),"Fullscreen"]})]}):r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"80px",color:"var(--text-secondary)",fontSize:"0.85rem",textAlign:"center"},children:'No audio yet â€¢ Click "Create Vocal" below'})]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexWrap:"wrap"},children:[r.jsxs("select",{value:"cloned"===si&&st?xt.find(e=>e.url===st)?`saved-${xt.find(e=>e.url===st).id}`:"cloned":si,onChange:e=>{const i=e.target.value;if(i.startsWith("saved-")){const e=i.replace("saved-",""),t=xt.find(i=>i.id===e);t&&(dt(t.url),di("cloned"))}else di(i)},style:{padding:"10px 14px",borderRadius:"10px",background:"rgba(0,0,0,0.3)",border:"1px solid rgba(139, 92, 246, 0.5)",color:"white",fontSize:"0.85rem",cursor:"pointer",outline:"none"},children:[r.jsxs("optgroup",{label:"ðŸ”¥ Male Rappers",children:[r.jsx("option",{value:"rapper",children:"ðŸŽ¤ Rapper (Deep / Aggressive)"}),r.jsx("option",{value:"rapper-melodic",children:"ðŸŽµ Rapper (Melodic / Smooth)"}),r.jsx("option",{value:"rapper-young",children:"âš¡ Rapper (Young / Trap)"})]}),r.jsxs("optgroup",{label:"ðŸ’œ Female Rappers",children:[r.jsx("option",{value:"rapper-female",children:"ðŸ’œ Female Rapper (Powerful)"}),r.jsx("option",{value:"rapper-female-melodic",children:"ðŸŽµ Female Rapper (Melodic)"})]}),r.jsxs("optgroup",{label:"ðŸŽµ Male Singers",children:[r.jsx("option",{value:"singer",children:"ðŸŽ¤ Male Singer (R&B/Soul)"}),r.jsx("option",{value:"singer-pop",children:"ðŸŒŸ Male Singer (Pop)"})]}),r.jsxs("optgroup",{label:"ðŸ’« Female Singers",children:[r.jsx("option",{value:"singer-female",children:"ðŸ’« Female Singer (R&B/Soul)"}),r.jsx("option",{value:"singer-female-pop",children:"ðŸŒŸ Female Singer (Pop)"})]}),r.jsxs("optgroup",{label:"ðŸ—£ï¸ Narration",children:[r.jsx("option",{value:"narrator",children:"ðŸ“¢ Narrator (Deep Voice)"}),r.jsx("option",{value:"spoken",children:"ðŸ’¬ Spoken Word"})]}),r.jsxs("optgroup",{label:"ðŸ§¬ Voice Cloning",children:[r.jsxs("option",{value:"cloned",disabled:!st&&!zt,children:["âœ¨ Cloned Voice ",!st&&!zt&&"(Upload sample first)"]}),xt.length>0&&r.jsx("optgroup",{label:"ðŸ—„ï¸ Saved Voices",children:xt.map(e=>r.jsxs("option",{value:`saved-${e.id}`,children:["ðŸ‘¤ ",e.name||"Unnamed Voice"]},e.id))})]})]}),r.jsxs("select",{value:ui,onChange:e=>gi(e.target.value),style:{padding:"10px 14px",borderRadius:"10px",background:"rgba(0,0,0,0.3)",border:"1px solid #fbbf24",color:"white",fontSize:"0.85rem",cursor:"pointer",outline:"none"},title:"Select Righteous Quality Output Format",children:[r.jsx("option",{value:"music",children:"ðŸŽµ Billboard Music Mix"}),r.jsx("option",{value:"social",children:"ðŸ“± Social Media Ready"}),r.jsx("option",{value:"podcast",children:"ðŸŽ™ï¸ Broadcast Podcast"}),r.jsx("option",{value:"tv",children:"ðŸ“º TV/Commercial Ready"})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("input",{type:"file",id:"voice-sample-upload",accept:"audio/*",onChange:async e=>{const i=e.target.files[0];if(i)if(i.size>10485760)t.error("File too large (max 10MB)");else{gt(!0),t.loading("Uploading voice sample...",{id:"voice-upload"});try{const e=await Xt(),r=new FileReader;r.readAsDataURL(i),r.onload=async()=>{try{const a=r.result,l=await fetch(`${n}/api/upload-asset`,{method:"POST",headers:e,body:JSON.stringify({data:a,fileName:`voice-sample-${Date.now()}-${i.name.replace(/\s+/g,"-")}`,mimeType:i.type||"audio/wav",assetType:"audio"})}),c=await l.json();if(!l.ok||!c.url)throw new Error(c.error||"Upload failed");if(dt(c.url),di("cloned"),t.success('Voice sample uploaded! Model set to "Cloned Voice"',{id:"voice-upload"}),d.currentUser)try{const e=p(s,"users",d.currentUser?.uid);await b(e,{voiceSampleUrl:c.url,lastVoiceUpdate:Date.now()});const r={url:c.url,name:i.name.replace(/\.[^/.]+$/,""),createdAt:y(),type:"cloned"},o=await h(g(s,"users",d.currentUser?.uid,"voices"),r);mt(e=>[{id:o.id,...r},...e]),t.success("Voice saved to library")}catch(o){}}catch(a){t.error("Failed to upload sample",{id:"voice-upload"})}finally{gt(!1)}},r.onerror=()=>{t.error("Failed to read file"),gt(!1)}}catch(r){t.error("Upload failed",{id:"voice-upload"}),gt(!1)}}},style:{display:"none"}}),r.jsxs("button",{onClick:()=>document.getElementById("voice-sample-upload").click(),disabled:ut,style:{padding:"10px 14px",borderRadius:"10px",background:st?"rgba(34, 197, 94, 0.1)":"rgba(255, 255, 255, 0.05)",border:st?"1px solid rgba(34, 197, 94, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",color:st?"#22c55e":"white",fontSize:"0.85rem",cursor:"pointer",flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",transition:"all 0.2s"},children:[ut?r.jsx(C,{size:16,className:"spin"}):r.jsx(R,{size:16}),st?"Voice Sample Attached âœ“":"Upload Voice Sample"]}),st&&r.jsx("button",{onClick:()=>{dt(null),"cloned"===si&&di("rapper")},style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",borderRadius:"10px",color:"#ef4444",cursor:"pointer",padding:"10px"},title:"Remove sample",children:r.jsx(w,{size:16})})]}),"cloned"===si&&zt?r.jsx("div",{style:{padding:"10px 14px",borderRadius:"10px",background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#22c55e",fontSize:"0.85rem"},children:"Using: Your Cloned Voice"}):("premium"===ci||"cloned"===si||si.startsWith("saved-"))&&r.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",gap:"8px"},children:[ht.length>0?r.jsxs("select",{value:ct,onChange:e=>{pt(e.target.value),localStorage.setItem("studio_elevenlabs_voice_id",e.target.value)},style:{width:"100%",padding:"10px 14px",borderRadius:"10px",background:"rgba(0,0,0,0.3)",border:ct?"1px solid #fbbf24":"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.85rem",outline:"none",cursor:"pointer"},children:[r.jsx("option",{value:"",children:"Auto (Best match for style)"}),(()=>{const e=ht.filter(e=>"male"===e.labels?.gender),i=ht.filter(e=>"female"===e.labels?.gender),t=ht.filter(e=>!e.labels?.gender||"male"!==e.labels.gender&&"female"!==e.labels.gender);return r.jsxs(r.Fragment,{children:[e.length>0&&r.jsx("optgroup",{label:"Male Voices",children:e.map(e=>r.jsxs("option",{value:e.voice_id,children:[e.name," (",e.labels?.accent||e.labels?.use_case||"Pro",")"]},e.voice_id))}),i.length>0&&r.jsx("optgroup",{label:"Female Voices",children:i.map(e=>r.jsxs("option",{value:e.voice_id,children:[e.name," (",e.labels?.accent||e.labels?.use_case||"Pro",")"]},e.voice_id))}),t.length>0&&r.jsx("optgroup",{label:"Other Voices",children:t.map(e=>r.jsxs("option",{value:e.voice_id,children:[e.name," (",e.labels?.accent||e.labels?.use_case||"Pro",")"]},e.voice_id))})]})})()]}):r.jsx("input",{type:"text",placeholder:"ElevenLabs Voice ID (Optional for Premium)",value:ct,onChange:e=>{pt(e.target.value),localStorage.setItem("studio_elevenlabs_voice_id",e.target.value)},style:{width:"100%",padding:"10px 14px",borderRadius:"10px",background:"rgba(0,0,0,0.3)",border:ct?"1px solid #fbbf24":"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.8rem",outline:"none"}}),ct&&r.jsxs("div",{style:{position:"absolute",right:ht.length>0?"30px":"10px",top:"50%",transform:"translateY(-50%)",display:"flex",alignItems:"center",gap:"4px",pointerEvents:"none"},children:[r.jsx(S,{size:10,color:"#fbbf24",fill:"#fbbf24"}),r.jsx("span",{style:{fontSize:"0.65rem",color:"#fbbf24",fontWeight:"bold"},children:"PREMIUM"})]})]})]}),xt.length>0&&r.jsxs("div",{style:{marginTop:"8px",background:"rgba(255,255,255,0.02)",borderRadius:"8px",padding:"10px"},children:[r.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)",marginBottom:"6px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em"},children:"My Voice Library"}),r.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:xt.map(e=>r.jsxs("div",{onClick:()=>{dt(e.url),di("cloned"),t.success(`Voice "${e.name}" loaded`)},style:{background:st===e.url?"rgba(139, 92, 246, 0.2)":"rgba(255,255,255,0.05)",border:st===e.url?"1px solid #8b5cf6":"1px solid rgba(255,255,255,0.1)",borderRadius:"16px",padding:"4px 10px",fontSize:"0.75rem",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s"},children:[r.jsx(E,{size:10}),e.name||"Voice",r.jsx(w,{size:12,onClick:i=>{i.stopPropagation(),Ci(e)},onMouseEnter:e=>e.currentTarget.style.color="#ef4444",onMouseLeave:e=>e.currentTarget.style.color="inherit",style:{marginLeft:"4px",opacity:.5,cursor:"pointer"},"aria-label":`Delete voice ${e.name||"Voice"}`})]},e.id))})]}),("rapper"===si||"rapper-female"===si||"rapper-melodic"===si||"rapper-young"===si||"rapper-female-melodic"===si)&&r.jsx("select",{value:xi,onChange:e=>mi(e.target.value),style:{padding:"10px 14px",borderRadius:"10px",background:"rgba(0,0,0,0.3)",border:"1px solid rgba(236, 72, 153, 0.5)",color:"white",fontSize:"0.85rem",cursor:"pointer",outline:"none"},children:r.jsxs("optgroup",{label:"ðŸ”¥ Rap Flow",children:[r.jsx("option",{value:"aggressive",children:"ðŸ’¥ Aggressive"}),r.jsx("option",{value:"melodic",children:"ðŸŽµ Melodic"}),r.jsx("option",{value:"trap",children:"ðŸ”¥ Trap (Triplets)"}),r.jsx("option",{value:"drill",children:"ðŸ‡¬ðŸ‡§ Drill (UK)"}),r.jsx("option",{value:"boom-bap",children:"ðŸ“» Boom-Bap"}),r.jsx("option",{value:"fast",children:"âš¡ Fast Flow"}),r.jsx("option",{value:"chill",children:"ðŸ˜Ž Chill"}),r.jsx("option",{value:"hype",children:"ðŸ”Š Hype"})]})}),("singer"===si||"singer-female"===si||"singer-pop"===si||"singer-female-pop"===si)&&r.jsx("select",{value:bi,onChange:e=>yi(e.target.value),style:{padding:"10px 14px",borderRadius:"10px",background:"rgba(0,0,0,0.3)",border:"1px solid rgba(139, 92, 246, 0.5)",color:"white",fontSize:"0.85rem",cursor:"pointer",outline:"none"},children:r.jsxs("optgroup",{label:"ðŸŽ¶ Genre",children:[r.jsx("option",{value:"r&b",children:"ðŸ’œ R&B / Soul"}),r.jsx("option",{value:"pop",children:"ðŸŒŸ Pop"}),r.jsx("option",{value:"hip-hop",children:"ðŸ”¥ Hip-Hop"}),r.jsx("option",{value:"soul",children:"ðŸŽ· Gospel/Soul"})]})}),r.jsx("button",{onClick:()=>{or()},disabled:Xe.vocals,style:{padding:"10px 20px",borderRadius:"10px",background:Xe.vocals?"rgba(139, 92, 246, 0.3)":"rgba(139, 92, 246, 0.5)",border:"1px solid rgba(139, 92, 246, 0.6)",color:"#8b5cf6",fontWeight:"600",fontSize:"0.9rem",cursor:Xe.vocals?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:Xe.vocals?.7:1},children:Xe.vocals?r.jsxs(r.Fragment,{children:[r.jsx(C,{size:16,className:"spin"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(P,{size:16}),"Create Vocal"]})}),r.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(Ne.lyrics),t.success("Lyrics copied!")},style:{padding:"10px 16px",borderRadius:"10px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"var(--text-secondary)",fontWeight:"500",fontSize:"0.85rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx(O,{size:14}),"Copy Lyrics"]}),He.lyricsVocal&&He.lyricsVocal.startsWith("data:audio")&&r.jsxs("button",{onClick:()=>{const e=document.createElement("a");e.href=He.lyricsVocal;const i=He.lyricsVocal.includes("audio/wav")?"wav":"mp3";e.download=`${se||"lyrics"}-${si}.${i}`,e.click()},style:{padding:"10px 16px",borderRadius:"10px",background:"rgba(34, 197, 94, 0.15)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#22c55e",fontWeight:"600",fontSize:"0.85rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx(M,{size:14}),"Download Audio"]})]})]})]}),r.jsxs("div",{style:{marginBottom:"1.2rem",background:"rgba(0,0,0,0.25)",borderRadius:"16px",border:"1px solid rgba(139, 92, 246, 0.2)",overflow:"hidden"},children:[r.jsxs("button",{onClick:()=>Ut(!Rt),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 18px",background:"rgba(139, 92, 246, 0.08)",border:"none",borderBottom:Rt?"1px solid rgba(139, 92, 246, 0.15)":"none",color:"white",cursor:"pointer",transition:"background 0.2s"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx(N,{size:18,color:"#a855f7"}),r.jsx("span",{style:{fontSize:"0.95rem",fontWeight:"700",fontFamily:"Georgia, serif",letterSpacing:"0.02em"},children:"YOUR ASSETS"}),(St.length>0||Tt||$t)&&r.jsx("span",{style:{fontSize:"0.65rem",padding:"2px 8px",borderRadius:"10px",background:"rgba(34, 197, 94, 0.15)",color:"#22c55e",fontWeight:"600"},children:[St.length>0&&"Voice",Tt&&"Image",$t&&"Audio"].filter(Boolean).join(" + ")})]}),Rt?r.jsx(L,{size:16,color:"rgba(255,255,255,0.5)"}):r.jsx(H,{size:16,color:"rgba(255,255,255,0.5)"})]}),Rt&&r.jsxs("div",{style:{padding:"16px 18px",display:"grid",gridTemplateColumns:ne?"1fr":"repeat(3, 1fr)",gap:"14px"},children:[r.jsxs("div",{style:{padding:"16px",background:"rgba(0,0,0,0.3)",borderRadius:"12px",border:"1px solid rgba(139, 92, 246, 0.15)",display:"flex",flexDirection:"column",gap:"10px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[r.jsx(R,{size:16,color:"#a855f7"}),r.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"700",color:"white",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Voice Samples"}),r.jsxs("span",{style:{fontSize:"0.65rem",color:"rgba(255,255,255,0.4)",marginLeft:"auto"},children:[St.length,"/3"]})]}),St.map((e,i)=>r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",background:"rgba(139, 92, 246, 0.08)",borderRadius:"8px",border:"1px solid rgba(139, 92, 246, 0.1)"},children:[r.jsx("span",{style:{fontSize:"0.75rem",color:"white",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"140px"},children:e.name}),r.jsx("button",{onClick:()=>wt(e=>e.filter((e,t)=>t!==i)),style:{background:"none",border:"none",color:"rgba(255,255,255,0.3)",cursor:"pointer",padding:"2px"},children:r.jsx(w,{size:12})})]},i)),St.length<3&&r.jsxs("label",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"10px",border:"1px dashed rgba(139, 92, 246, 0.3)",borderRadius:"8px",color:"rgba(255,255,255,0.6)",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.2s",background:"transparent"},children:[r.jsx("input",{type:"file",accept:"audio/*",multiple:!0,onChange:async e=>{const i=Array.from(e.target.files||[]);if(0===i.length)return;const r=3-St.length;if(r<=0)return void t.error("Maximum 3 voice samples allowed");const o=i.slice(0,r);for(const l of o){if(l.size>10485760){t.error(`${l.name} exceeds 10MB limit`);continue}const e=t.loading(`Uploading ${l.name}...`);try{const i=await new Promise((e,i)=>{const t=new FileReader;t.onload=()=>e(t.result),t.onerror=i,t.readAsDataURL(l)}),r=await Xt(),o=await fetch(`${n}/api/upload-asset`,{method:"POST",headers:r,body:JSON.stringify({data:i,fileName:`voice-sample-${Date.now()}-${l.name.replace(/\s+/g,"-")}`,mimeType:l.type||"audio/wav",assetType:"audio"})}),a=await o.json();if(!o.ok||!a.url)throw new Error(a.error||"Upload failed");wt(e=>[...e,{name:l.name,url:a.url,base64:i}]),t.success(`${l.name} uploaded`,{id:e})}catch(a){t.error(`Failed to upload ${l.name}`,{id:e})}}e.target.value=""},style:{display:"none"}}),r.jsx(N,{size:14}),0===St.length?"Upload 2-3 voice samples":"Add more samples"]}),r.jsxs("button",{onClick:async()=>{if(St.length<2)t.error("Upload at least 2 voice samples for best results");else{Ct(!0),t.loading("Cloning your voice...",{id:"voice-clone"});try{const e=await Xt(),i=await fetch(`${n}/api/voice-clone`,{method:"POST",headers:e,body:JSON.stringify({samples:St.map(e=>e.base64),voiceName:se?`${se} Voice`:"My Voice"})}),r=await i.json();if(!i.ok||!r.voiceId)throw new Error(r.error||r.details||"Voice cloning failed");{It(r.voiceId),pt(r.voiceId),di("cloned"),t.success("Voice cloned! Your voice is now active.",{id:"voice-clone"});const e={id:r.voiceId,voiceId:r.voiceId,name:r.name,provider:"elevenlabs-ivc",type:"cloned"};mt(i=>[e,...i])}}catch(e){t.error(e.message||"Voice cloning failed",{id:"voice-clone"})}finally{Ct(!1)}}},disabled:St.length<2||kt,style:{padding:"10px",borderRadius:"10px",border:zt?"1px solid rgba(34, 197, 94, 0.3)":"1px solid rgba(139, 92, 246, 0.4)",background:zt?"rgba(34, 197, 94, 0.1)":"rgba(139, 92, 246, 0.15)",color:zt?"#22c55e":St.length<2?"rgba(255,255,255,0.3)":"#a855f7",fontSize:"0.8rem",fontWeight:"700",cursor:St.length<2||kt?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",transition:"all 0.2s",opacity:St.length<2?.5:1},children:[kt?r.jsx(C,{size:14,className:"spin"}):zt?r.jsx(T,{size:14}):r.jsx(z,{size:14}),kt?"Cloning...":zt?"Voice Cloned":"Clone My Voice"]}),r.jsx("p",{style:{fontSize:"0.65rem",color:"rgba(255,255,255,0.35)",margin:0,lineHeight:1.4},children:"Upload vocal recordings so the AI learns your voice. Minimum 2 samples for best quality."})]}),r.jsxs("div",{style:{padding:"16px",background:"rgba(0,0,0,0.3)",borderRadius:"12px",border:"1px solid rgba(236, 72, 153, 0.15)",display:"flex",flexDirection:"column",gap:"10px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[r.jsx(V,{size:16,color:"#ec4899"}),r.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"700",color:"white",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Artist Image"})]}),Tt?r.jsxs("div",{style:{position:"relative"},children:[r.jsx("img",{src:Tt,alt:"Artist",style:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"8px",border:"1px solid rgba(236, 72, 153, 0.2)"}}),r.jsx("button",{onClick:()=>{Dt(null),Bt(null)},style:{position:"absolute",top:"6px",right:"6px",background:"rgba(0,0,0,0.7)",border:"none",borderRadius:"50%",color:"white",cursor:"pointer",padding:"4px",display:"flex"},children:r.jsx(w,{size:12})})]}):r.jsxs("label",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px",padding:"24px 10px",border:"1px dashed rgba(236, 72, 153, 0.3)",borderRadius:"8px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.2s",background:"transparent",flex:1},children:[r.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{const i=e.target.files[0];if(!i)return;if(i.size>10485760)return void t.error("File too large (max 10MB)");const r=t.loading("Uploading artist image...");try{const e=await new Promise((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(i)}),a=await Xt(),l=await fetch(`${n}/api/upload-asset`,{method:"POST",headers:a,body:JSON.stringify({data:e,fileName:`artist-image-${Date.now()}-${i.name.replace(/\s+/g,"-")}`,mimeType:i.type||"image/png",assetType:"image"})}),c=await l.json();if(!l.ok||!c.url)throw new Error(c.error||"Upload failed");if(Dt(c.url),Bt(c.url),t.success("Artist image uploaded!",{id:r}),d.currentUser?.uid&&s)try{const e=p(s,"users",d.currentUser.uid);await b(e,{visualDnaUrl:c.url,videoDnaUrl:c.url,lastDnaUpdate:Date.now()})}catch(o){}}catch(a){t.error("Failed to upload image",{id:r})}},style:{display:"none"}}),r.jsx(V,{size:24,color:"rgba(236, 72, 153, 0.5)"}),"Upload your photo"]}),r.jsx("p",{style:{fontSize:"0.65rem",color:"rgba(255,255,255,0.35)",margin:0,lineHeight:1.4},children:"Your photo or image for music videos. Videos will feature you instead of AI-generated visuals."})]}),r.jsxs("div",{style:{padding:"16px",background:"rgba(0,0,0,0.3)",borderRadius:"12px",border:"1px solid rgba(6, 182, 212, 0.15)",display:"flex",flexDirection:"column",gap:"10px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[r.jsx(D,{size:16,color:"#06b6d4"}),r.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"700",color:"white",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Reference Audio"})]}),$t?r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",background:"rgba(6, 182, 212, 0.08)",borderRadius:"8px",border:"1px solid rgba(6, 182, 212, 0.15)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(D,{size:14,color:"#06b6d4"}),r.jsx("span",{style:{fontSize:"0.75rem",color:"#06b6d4",fontWeight:"600"},children:"Reference Active"})]}),r.jsx("button",{onClick:()=>At(null),style:{background:"none",border:"none",color:"rgba(255,255,255,0.3)",cursor:"pointer",padding:"2px"},children:r.jsx(w,{size:12})})]}):r.jsxs("label",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px",padding:"24px 10px",border:"1px dashed rgba(6, 182, 212, 0.3)",borderRadius:"8px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.2s",background:"transparent",flex:1},children:[r.jsx("input",{type:"file",accept:"audio/*",onChange:async e=>{const i=e.target.files[0];if(!i)return;if(i.size>10485760)return void t.error("File too large (max 10MB)");const r=t.loading("Uploading reference audio...");try{const e=await new Promise((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(i)}),a=await Xt(),l=await fetch(`${n}/api/upload-asset`,{method:"POST",headers:a,body:JSON.stringify({data:e,fileName:`ref-audio-${Date.now()}-${i.name.replace(/\s+/g,"-")}`,mimeType:i.type||"audio/mpeg",assetType:"audio"})}),c=await l.json();if(!l.ok||!c.url)throw new Error(c.error||"Upload failed");if(At(c.url),t.success("Reference audio uploaded!",{id:r}),d.currentUser?.uid&&s)try{const e=p(s,"users",d.currentUser.uid);await b(e,{audioDnaUrl:c.url,lastDnaUpdate:Date.now()})}catch(o){}}catch(a){t.error("Failed to upload audio",{id:r})}},style:{display:"none"}}),r.jsx(D,{size:24,color:"rgba(6, 182, 212, 0.5)"}),"Upload song or vocals"]}),r.jsx("p",{style:{fontSize:"0.65rem",color:"rgba(255,255,255,0.35)",margin:0,lineHeight:1.4},children:"Upload a reference song or vocals. The AI matches your style, tone, and energy."})]})]})]}),r.jsx("div",{className:"generator-grid-unified",style:{gap:ne?"0.6rem":"1rem",touchAction:"pan-y"},children:qt.map(e=>r.jsx(oe,{slot:e.key,agentId:We[e.key],icon:e.icon,title:We[e.key]?a.find(i=>i.id===We[e.key])?.name:e.title,subtitle:e.subtitle,color:e.color,output:Ne[e.key],isLoading:Oe[e.key]&&We[e.key],mediaType:e.mediaType,mediaUrl:"audio"===e.key?He.audio:"lyrics"===e.key?He.vocals||He.lyricsVocal:"visual"===e.key?He.image:"video"===e.key?He.video:null,onGenerateMedia:"audio"===e.key?rr:"lyrics"===e.key?or:"visual"===e.key?lr:"video"===e.key?dr:null,isGeneratingMedia:"audio"===e.key?Xe.audio:"lyrics"===e.key?Xe.vocals:"visual"===e.key?Xe.image:"video"===e.key&&Xe.video,onRegenerate:()=>tr(e.key),onEdit:i=>gr(e.key,i),onDelete:()=>ur(e.key),onDownload:()=>pr(e.key),onSpeak:()=>Kt(Ne[e.key],e.key),isSpeaking:ei===e.key,onMaximize:()=>{Pi(!1),ji(e.key)},onUploadDna:"visual"===e.key?e=>ar("visual",e):"audio"===e.key?e=>ar("audio",e):"video"===e.key?e=>ar("video",e):"lyrics"===e.key?e=>ar("lyrics",e):null,dnaUrl:"visual"===e.key?Tt:"audio"===e.key?$t:"video"===e.key?Vt:"lyrics"===e.key?Wt:null,isUploadingDna:Et[e.key],provider:Ye[e.key]||null,onClearDna:()=>{"visual"===e.key&&Dt(null),"audio"===e.key&&At(null),"video"===e.key&&Bt(null),"lyrics"===e.key&&Ft(null)}},e.key))}),r.jsx(ae,{outputs:Ne,mediaUrls:He,songIdea:se,finalMixPreview:Ri,creatingFinalMix:zi,musicVideoUrl:Wi,generatingMusicVideo:Vi,handleGenerateProfessionalMusicVideo:async()=>{if(!Vi)if(He.audio&&(Ne.video||He.image)){Bi(!0),t.loading("ðŸŽ¬ Syncing audio with video beats (~2-3 min)...",{id:"prof-video"});try{const e=await Xt(),i=e.Authorization?"/api/generate-synced-video":"/api/generate-synced-video-test",r=await fetch(`${n}${i}`,{method:"POST",headers:{"Content-Type":"application/json",...e},body:JSON.stringify({audioUrl:He.mixedAudio||He.audio,videoPrompt:`${Tt||Vt?"Feature the artist from the reference image. ":""}${Ne.video||`A high-fidelity cinematic music video for a ${ue} song`}`,imageUrl:He.image,videoUrl:He.video,referenceImage:Tt||Vt,songTitle:se||"Untitled",style:ue||"cinematic",duration:"Extended"===ze?180:"Radio Edit"===ze?150:"Full Song"===ze?90:60})}),o=await r.json();r.ok?o.videoUrl?(Fi(o.videoUrl),Ri&&Ui(e=>({...e,musicVideoUrl:o.videoUrl,musicVideoGenerated:!0,bpm:o.bpm,beatCount:o.beats})),t.success(`ðŸŽ¬ Image to video created! (${o.duration}s, ${o.bpm} BPM)`,{id:"prof-video"})):o.jobId&&t.success(`ðŸŽ¬ Video queued for processing (Job: ${o.jobId.substring(0,8)}...)`,{id:"prof-video"}):503===r.status?t.error("âŒ Video API not configured",{id:"prof-video"}):t.error(`âŒ ${o.error||"Video sync failed"}`,{id:"prof-video"})}catch(e){t.error("âŒ Image to video generation failed",{id:"prof-video"})}finally{Bi(!1)}}else t.error("Need beat audio and video concept to sync")},handleCreateFinalMix:cr,handleCreateProject:xr,setShowPreviewModal:Pi,setMaximizedSlot:ji,visualType:Xi,setVisualType:Zi,isMobile:ne,orchestratorBpm:Ve,mixVocalVolume:Ti,mixBeatVolume:$i,setMixVocalVolume:Di,setMixBeatVolume:Ai})]}),vi&&qt.find(e=>e.key===vi)&&r.jsx("div",{style:{position:"fixed",inset:0,background:"linear-gradient(180deg, rgba(0,0,0,0.98) 0%, rgba(10,10,20,0.98) 100%)",display:"flex",alignItems:ne?"flex-start":"center",justifyContent:"center",zIndex:10001,padding:ne?"10px":"20px",overflowY:"auto"},onClick:()=>ji(null),children:r.jsxs("div",{style:{background:"rgba(10, 10, 20, 0.95)",borderRadius:ne?"16px":"24px",border:"1px solid rgba(255,255,255,0.1)",width:"100%",maxWidth:"800px",maxHeight:ne?"95vh":"90vh",overflow:"auto",display:"flex",flexDirection:"column",marginTop:ne?"10px":"0"},onClick:e=>e.stopPropagation(),children:[r.jsxs("div",{style:{padding:ne?"12px 16px":"16px 24px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(10px)",zIndex:10},children:[r.jsx("h3",{style:{margin:0,fontSize:ne?"1rem":"1.2rem",fontWeight:"700"},children:qt.find(e=>e.key===vi)?.title}),r.jsxs("button",{onClick:()=>ji(null),style:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.4)",borderRadius:"10px",padding:ne?"6px 10px":"10px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",color:"#ef4444",fontWeight:"600",fontSize:ne?"0.8rem":"0.9rem",transition:"all 0.2s",minWidth:"36px",minHeight:"36px"},children:[r.jsx(w,{size:16}),!ne&&"Close"]})]}),r.jsx("div",{style:{padding:ne?"12px":"24px",flex:1,overflowY:"auto"},children:(()=>{const e=qt.find(e=>e.key===vi);return r.jsx(oe,{slot:e.key,agentId:We[e.key],icon:e.icon,title:e.title,subtitle:e.subtitle,color:e.color,output:Ne[e.key],isLoading:Oe[e.key]&&We[e.key],mediaType:e.mediaType,mediaUrl:"audio"===e.key?He.audio:"lyrics"===e.key?He.vocals||He.lyricsVocal:"visual"===e.key?He.image:"video"===e.key?He.video:null,onGenerateMedia:"audio"===e.key?rr:"lyrics"===e.key?or:"visual"===e.key?lr:"video"===e.key?dr:null,isGeneratingMedia:"audio"===e.key?Xe.audio:"lyrics"===e.key?Xe.vocals:"visual"===e.key?Xe.image:"video"===e.key&&Xe.video,onRegenerate:()=>tr(e.key),onEdit:i=>gr(e.key,i),onDelete:()=>ur(e.key),onDownload:()=>pr(e.key),onSpeak:()=>Kt(Ne[e.key],e.key),isSpeaking:ei===e.key,onUploadDna:"visual"===e.key?e=>ar("visual",e):"audio"===e.key?e=>ar("audio",e):"video"===e.key?e=>ar("video",e):"lyrics"===e.key?e=>ar("lyrics",e):null,dnaUrl:"visual"===e.key?Tt:"audio"===e.key?$t:"video"===e.key?Vt:"lyrics"===e.key?Wt:null,isUploadingDna:Et[e.key],provider:Ye[e.key]||null,onClearDna:()=>{"visual"===e.key&&Dt(null),"audio"===e.key&&At(null),"video"===e.key&&Bt(null),"lyrics"===e.key&&Ft(null)}},`max-${e.key}`)})()}),r.jsx("div",{style:{padding:ne?"12px":"16px 24px",borderTop:"1px solid rgba(255,255,255,0.1)",display:"flex",justifyContent:"center",background:"rgba(0,0,0,0.3)"},children:r.jsxs("button",{onClick:()=>ji(null),style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(220, 38, 38, 0.2))",border:"1px solid rgba(239, 68, 68, 0.5)",borderRadius:"12px",padding:ne?"10px 20px":"14px 32px",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer",color:"#ef4444",fontWeight:"700",fontSize:ne?"0.9rem":"1rem",transition:"all 0.2s",boxShadow:"0 4px 20px rgba(239, 68, 68, 0.2)"},children:[r.jsx(w,{size:20}),ne?"Close":"Close Preview"]})})]})}),Object.values(Ne).some(Boolean)&&r.jsxs("div",{style:{padding:"16px 24px",background:"rgba(0,0,0,0.8)",borderTop:"1px solid rgba(255,255,255,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",bottom:0,backdropFilter:"blur(10px)"},children:[r.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:[Object.values(Ne).filter(Boolean).length,"/4 generators complete â€¢",Object.values(He).filter(Boolean).length," media assets"]}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[r.jsxs("button",{onClick:()=>{const e={project:se,timestamp:(new Date).toISOString(),outputs:Ne,settings:{language:ce,style:ue,model:ve}},i=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.download=`${se||"project"}-export.json`,o.click(),URL.revokeObjectURL(r),t.success("Exported!")},style:{padding:"12px 20px",borderRadius:"12px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(M,{size:16}),"Export"]}),r.jsxs("button",{onClick:()=>{ji(null),Pi(!1),ai(!0)},style:{padding:"12px 28px",borderRadius:"12px",background:"linear-gradient(135deg, #8b5cf6, #06b6d4)",border:"none",color:"white",fontWeight:"700",fontSize:"1rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 20px rgba(139, 92, 246, 0.4)"},children:[r.jsx(G,{size:18}),"Save to Project"]})]})]}),oi&&r.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Save to project",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:()=>ai(!1),children:r.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:"24px",padding:"28px",maxWidth:"420px",width:"90%",border:"1px solid rgba(255,255,255,0.1)"},onClick:e=>e.stopPropagation(),children:[r.jsx("h3",{style:{margin:"0 0 20px",fontSize:"1.3rem",fontWeight:"700"},children:"Save to Project"}),r.jsx("input",{type:"text",value:ti,onChange:e=>ri(e.target.value),placeholder:se||"Project name...",style:{width:"100%",padding:"14px 18px",borderRadius:"12px",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"1rem",marginBottom:"20px",outline:"none"}}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[r.jsx("button",{onClick:()=>ai(!1),className:"btn-pill glass",style:{flex:1,padding:"14px"},children:"Cancel"}),r.jsx("button",{onClick:xr,className:"btn-pill primary",style:{flex:1,padding:"14px",fontWeight:"700"},children:"Save Project"})]})]})}),Ni&&r.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Save confirmation",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005,padding:"20px"},onClick:e=>{e.target===e.currentTarget&&Li(!1)},children:r.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(15, 23, 42, 0.98) 0%, rgba(30, 41, 59, 0.98) 100%)",borderRadius:"20px",padding:"32px",border:"1px solid rgba(34, 197, 94, 0.4)",maxWidth:"450px",width:"100%",textAlign:"center",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},children:[r.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"rgba(34, 197, 94, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px"},children:r.jsx(G,{size:32,color:"#22c55e"})}),r.jsx("h2",{style:{margin:"0 0 12px",fontSize:"1.4rem",fontWeight:"700",color:"white"},children:"Project Saved! ðŸŽ‰"}),r.jsxs("p",{style:{margin:"0 0 24px",color:"rgba(255,255,255,0.7)",fontSize:"0.95rem",lineHeight:"1.5"},children:['Your project "',ti||se||"Untitled",'" has been saved with ',Object.values(Ne).filter(Boolean).length," assets."]}),r.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"12px",padding:"12px",marginBottom:"24px",textAlign:"left"},children:[r.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.4)",fontWeight:"700",textTransform:"uppercase",marginBottom:"10px"},children:"Generated Content"}),Object.entries(Ne).filter(([e,i])=>null!==i).map(([e,i])=>{const t=qt.find(i=>i.key===e);return r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",fontSize:"0.85rem",color:"rgba(255,255,255,0.8)"},children:[r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:t?.color||"#8b5cf6"}}),t?.title||e]},e)})]}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[r.jsx("button",{onClick:()=>{Li(!1),q?q():o?.()},className:"btn-pill glass",style:{flex:1,padding:"14px",fontWeight:"600"},children:"Go to Hub"}),r.jsxs("button",{onClick:()=>{Li(!1),ji(null),Pi(!0)},className:"btn-pill primary",style:{flex:1,padding:"14px",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r.jsx(F,{size:18}),"Preview"]})]})]})}),Si&&He.lyricsVocal&&r.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Vocal Audio Player",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.9)",zIndex:10002,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},onClick:()=>wi(!1),children:r.jsxs("div",{style:{background:"rgba(0,0,0,0.8)",borderRadius:"20px",padding:"24px",maxWidth:"500px",width:"100%",border:"1px solid rgba(139, 92, 246, 0.4)"},onClick:e=>e.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[r.jsx("div",{style:{fontWeight:700,color:"#8b5cf6"},children:"ðŸŽ§ Vocal Audio Player"}),r.jsx("button",{onClick:()=>wi(!1),style:{background:"none",border:"none",color:"white",cursor:"pointer"},"aria-label":"Close vocal player",children:r.jsx(w,{size:20})})]}),r.jsx("audio",{src:f(He.lyricsVocal),controls:!0,autoPlay:!0,style:{width:"100%",height:"50px",borderRadius:"10px"}}),r.jsxs("div",{style:{marginTop:"16px",fontSize:"0.85rem",color:"var(--text-secondary)"},children:["Voice Style: ",r.jsx("strong",{children:si})]})]})}),ki&&r.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Confirm voice deletion",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",zIndex:10003,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},onClick:()=>Ci(null),children:r.jsxs("div",{style:{background:"#1a1a2e",borderRadius:"16px",padding:"24px",maxWidth:"380px",width:"100%",border:"1px solid rgba(255,255,255,0.1)"},onClick:e=>e.stopPropagation(),children:[r.jsx("h3",{style:{margin:"0 0 8px",fontSize:"1.1rem"},children:"Delete Voice"}),r.jsxs("p",{style:{margin:"0 0 20px",color:"var(--text-secondary)",fontSize:"0.9rem"},children:["Remove ",r.jsx("strong",{children:ki.name||"this voice"})," from your library? This cannot be undone."]}),r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:()=>Ci(null),style:{flex:1,padding:"12px",borderRadius:"10px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",fontWeight:600,cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:async()=>{try{await c(p(s,"users",d.currentUser?.uid,"voices",ki.id)),mt(e=>e.filter(e=>e.id!==ki.id)),st===ki.url&&(dt(null),di("rapper")),t.success("Voice deleted")}catch(e){t.error("Failed to delete voice")}Ci(null)},style:{flex:1,padding:"12px",borderRadius:"10px",background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.4)",color:"#ef4444",fontWeight:600,cursor:"pointer"},children:"Delete"})]})]})}),Yi&&r.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Exit confirmation",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10006,padding:"20px"},onClick:e=>{e.target===e.currentTarget&&Ji(!1)},children:r.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(15, 23, 42, 0.98) 0%, rgba(30, 41, 59, 0.98) 100%)",borderRadius:"20px",padding:"32px",border:"1px solid rgba(245, 158, 11, 0.4)",maxWidth:"450px",width:"100%",textAlign:"center",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},children:[r.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"rgba(245, 158, 11, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px"},children:r.jsx(G,{size:32,color:"#f59e0b"})}),r.jsx("h2",{style:{margin:"0 0 12px",fontSize:"1.4rem",fontWeight:"700",color:"white"},children:"Save Your Work?"}),r.jsxs("p",{style:{margin:"0 0 24px",color:"rgba(255,255,255,0.7)",fontSize:"0.95rem",lineHeight:"1.5"},children:["You have ",Object.values(Lt).filter(Boolean).length+Object.values(Ht).filter(Boolean).length," unsaved creations. Would you like to save before leaving?"]}),r.jsxs("div",{style:{display:"flex",gap:"12px",flexDirection:"column"},children:[r.jsxs("button",{onClick:()=>{Ji(!1),ji(null),Pi(!1),ai(!0)},className:"btn-pill primary",style:{width:"100%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r.jsx(G,{size:18}),"Save Project"]}),r.jsxs("div",{style:{display:"flex",gap:"12px",flexDirection:ne?"column-reverse":"row"},children:[r.jsx("button",{onClick:()=>{Ji(!1)},className:"btn-pill glass",style:{flex:1,padding:"12px"},children:"Cancel"}),r.jsx("button",{onClick:()=>{Ji(!1),o?.()},className:"btn-pill secondary",style:{flex:1,padding:"12px"},children:"Discard & Exit"})]})]})]})}),_i&&r.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Regeneration confirmation",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10006,padding:"20px"},onClick:e=>{e.target===e.currentTarget&&qi(!1)},children:r.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(15, 23, 42, 0.98) 0%, rgba(30, 41, 59, 0.98) 100%)",borderRadius:"20px",padding:"32px",border:"1px solid rgba(139, 92, 246, 0.4)",maxWidth:"450px",width:"100%",textAlign:"center",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},children:[r.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"rgba(139, 92, 246, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px"},children:r.jsx(G,{size:32,color:"#8b5cf6"})}),r.jsx("h2",{style:{margin:"0 0 12px",fontSize:"1.4rem",fontWeight:"700",color:"white"},children:"Unsaved Content"}),r.jsx("p",{style:{margin:"0 0 24px",color:"rgba(255,255,255,0.7)",fontSize:"0.95rem",lineHeight:"1.5"},children:"You have unsaved content. Save your project before generating new content?"}),r.jsxs("div",{style:{display:"flex",gap:"12px",flexDirection:"column"},children:[r.jsxs("button",{onClick:er,className:"btn-pill primary",style:{width:"100%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r.jsx(G,{size:18}),"Save & Generate New"]}),r.jsxs("div",{style:{display:"flex",gap:"12px",flexDirection:ne?"column-reverse":"row"},children:[r.jsx("button",{onClick:()=>qi(!1),className:"btn-pill glass",style:{flex:1,padding:"12px"},children:"Cancel"}),r.jsx("button",{onClick:Zt,className:"btn-pill secondary",style:{flex:1,padding:"12px"},children:"Clear & Generate New"})]})]})]})}),Ei&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003,padding:Oi?"0":"20px"},onClick:e=>{e.target===e.currentTarget&&Pi(!1)},children:r.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(15, 23, 42, 0.98) 0%, rgba(30, 41, 59, 0.98) 100%)",borderRadius:Oi?"0":"20px",padding:Oi||ne?"16px":"24px",border:Oi?"none":"1px solid rgba(148, 163, 184, 0.2)",width:"100%",maxWidth:Oi?"100%":"900px",height:Oi?"100%":"auto",maxHeight:Oi?"100%":"90vh",overflowY:"auto",position:"relative",boxShadow:Oi?"none":"0 25px 80px rgba(0,0,0,0.5)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",position:"sticky",top:0,background:Oi?"rgba(15, 23, 42, 0.95)":"transparent",padding:Oi?"8px 0 16px":"0",zIndex:5},children:[r.jsxs("h2",{style:{margin:0,fontSize:Oi?"1.75rem":"1.5rem",fontWeight:"700",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx(F,{size:Oi?28:24,color:"#8b5cf6"}),"Preview All Creations"]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsxs("button",{onClick:()=>Mi(!Oi),style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"10px",padding:"10px",cursor:"pointer",color:"white",display:"flex",alignItems:"center",gap:"6px",fontSize:"0.85rem"},title:Oi?"Minimize":"Maximize",children:[r.jsx(Y,{size:18}),Oi?"Minimize":"Maximize"]}),r.jsx("button",{onClick:()=>Pi(!1),style:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.4)",borderRadius:"10px",padding:"10px",cursor:"pointer",color:"#ef4444"},children:r.jsx(w,{size:20})})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:ne?"1fr":"repeat(2, 1fr)",gap:ne?"16px":Oi?"32px":"24px",marginBottom:"24px"},children:[r.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",borderRadius:"16px",padding:ne?"12px":"16px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[r.jsxs("h3",{style:{margin:0,color:"#a78bfa",fontSize:"1rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(J,{size:18}),"Lyrics"]}),r.jsx("span",{style:{padding:"4px 10px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"600",background:Lt.lyrics?"rgba(34, 197, 94, 0.2)":"rgba(100,100,100,0.2)",color:Lt.lyrics?"#22c55e":"rgba(255,255,255,0.5)"},children:Lt.lyrics?"âœ“ Ready":"Pending"})]}),r.jsx("div",{style:{background:"rgba(0,0,0,0.4)",borderRadius:"12px",padding:"16px",minHeight:Oi?"300px":"180px",maxHeight:Oi?"400px":"200px",overflowY:"auto",fontSize:"1rem",lineHeight:"1.7",color:Lt.lyrics?"rgba(255,255,255,0.9)":"rgba(255,255,255,0.4)",whiteSpace:"pre-wrap",wordBreak:"break-word",fontStyle:Lt.lyrics?"normal":"italic",fontFamily:"'Georgia', 'Times New Roman', serif"},children:Lt.lyrics||"No lyrics generated yet. Use the Lyrics generator to create lyrics."})]}),r.jsxs("div",{style:{background:"rgba(6, 182, 212, 0.1)",borderRadius:"16px",padding:ne?"12px":"16px",border:"1px solid rgba(6, 182, 212, 0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[r.jsxs("h3",{style:{margin:0,color:"#22d3ee",fontSize:"1rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(D,{size:18}),"Beat Audio"]}),r.jsx("span",{style:{padding:"4px 10px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"600",background:Ht.audio?"rgba(34, 197, 94, 0.2)":"rgba(100,100,100,0.2)",color:Ht.audio?"#22c55e":"rgba(255,255,255,0.5)"},children:Ht.audio?"âœ“ Ready":"Pending"})]}),r.jsx("div",{style:{background:"rgba(0,0,0,0.4)",borderRadius:"12px",padding:"16px",minHeight:"100px"},children:Ht.audio?r.jsxs(r.Fragment,{children:[r.jsx("audio",{controls:!0,style:{width:"100%",marginBottom:"12px"},src:f(Ht.audio),onError:e=>{}}),r.jsxs("div",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.6)",display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx(P,{size:14}),"Audio ready to play"]})]}):r.jsx("div",{style:{textAlign:"center",color:"rgba(255,255,255,0.4)",fontSize:"0.9rem",padding:"24px",fontStyle:"italic"},children:"No audio generated yet. Generate a beat to preview audio."})})]}),r.jsxs("div",{style:{background:"rgba(236, 72, 153, 0.1)",borderRadius:"16px",padding:ne?"12px":"16px",border:"1px solid rgba(236, 72, 153, 0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[r.jsxs("h3",{style:{margin:0,color:"#f472b6",fontSize:"1rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx(V,{size:18}),"Cover Visual"]}),r.jsx("span",{style:{padding:"4px 10px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"600",background:Ht.image?"rgba(34, 197, 94, 0.2)":"rgba(100,100,100,0.2)",color:Ht.image?"#22c55e":"rgba(255,255,255,0.5)"},children:Ht.image?"âœ“ Ready":"Pending"})]}),r.jsx("div",{style:{background:"rgba(0,0,0,0.4)",borderRadius:"12px",padding:"8px",aspectRatio:"1",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:Ht.image?r.jsx("img",{src:v(Ht.image),alt:"Cover Art",style:{width:"100%",height:"100%",borderRadius:"8px",objectFit:"cover"},onError:e=>{e.target.style.display="none"}}):r.jsx("div",{style:{textAlign:"center",color:"rgba(255,255,255,0.4)",fontSize:"0.9rem",fontStyle:"italic"},children:"No image generated yet"})})]}),r.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",borderRadius:"16px",padding:ne?"12px":"16px",border:Wi?"1px solid rgba(34, 197, 94, 0.5)":"1px solid rgba(245, 158, 11, 0.3)",boxShadow:Wi?"0 0 15px rgba(34, 197, 94, 0.2)":"none"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[r.jsxs("h3",{style:{margin:0,color:Wi?"#22c55e":"#fbbf24",fontSize:"1rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[Wi?r.jsx(S,{size:18}):r.jsx(B,{size:18}),Wi?"Professional Sync":"Concept Video"]}),r.jsx("span",{style:{padding:"4px 10px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"600",background:Wi||Ht.video?"rgba(34, 197, 94, 0.2)":"rgba(100,100,100,0.2)",color:Wi||Ht.video?"#22c55e":"rgba(255,255,255,0.5)"},children:Wi?"âœ“ Synced":Ht.video?"âœ“ Concept":"Pending"})]}),r.jsx("div",{style:{background:"rgba(0,0,0,0.4)",borderRadius:"12px",padding:"8px",aspectRatio:"16/9",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:Wi||Ht.video?r.jsx("video",{src:j(Wi||Ht.video),controls:!0,style:{width:"100%",height:"100%",borderRadius:"8px",objectFit:"contain",backgroundColor:"#000"},onError:e=>{}}):r.jsx("div",{style:{textAlign:"center",color:"rgba(255,255,255,0.4)",fontSize:"0.9rem",fontStyle:"italic"},children:"No video generated yet"})})]})]}),r.jsx("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"16px",border:"1px solid rgba(148, 163, 184, 0.2)",marginBottom:"20px"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",fontSize:"0.9rem"},children:[r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"rgba(255,255,255,0.6)",marginBottom:"6px",fontSize:"0.8rem"},children:"Lyrics"}),r.jsx("div",{style:{fontWeight:"700",color:"#a78bfa",fontSize:"1.1rem"},children:Lt.lyrics?`${Lt.lyrics.length} chars`:"â€”"})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"rgba(255,255,255,0.6)",marginBottom:"6px",fontSize:"0.8rem"},children:"Audio"}),r.jsx("div",{style:{fontWeight:"700",color:"#22d3ee",fontSize:"1.1rem"},children:Ht.audio?"âœ“ Ready":"â€”"})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"rgba(255,255,255,0.6)",marginBottom:"6px",fontSize:"0.8rem"},children:"Visual"}),r.jsx("div",{style:{fontWeight:"700",color:"#f472b6",fontSize:"1.1rem"},children:Ht.image?"âœ“ Ready":"â€”"})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"rgba(255,255,255,0.6)",marginBottom:"6px",fontSize:"0.8rem"},children:"Video"}),r.jsx("div",{style:{fontWeight:"700",color:"#fbbf24",fontSize:"1.1rem"},children:Ht.video?"âœ“ Ready":"â€”"})]})]})}),r.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[r.jsx("button",{onClick:()=>Pi(!1),style:{flex:1,minWidth:"120px",padding:"14px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",fontWeight:"600",cursor:"pointer",fontSize:"0.95rem"},children:"Close Preview"}),r.jsxs("button",{onClick:()=>{Pi(!1),ji(null),ai(!0)},style:{flex:1,minWidth:"140px",padding:"14px",borderRadius:"12px",background:"linear-gradient(135deg, #8b5cf6, #06b6d4)",border:"none",color:"white",fontWeight:"700",cursor:"pointer",fontSize:"0.95rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r.jsx(G,{size:18}),"Save Project"]}),r.jsx("button",{onClick:()=>{Pi(!1),cr()},disabled:zi||!Object.values(Lt).some(Boolean),style:{flex:1,minWidth:"140px",padding:"14px",borderRadius:"12px",background:zi||!Object.values(Lt).some(Boolean)?"rgba(34, 197, 94, 0.2)":"rgba(34, 197, 94, 0.5)",border:"1px solid rgba(34, 197, 94, 0.6)",color:"#22c55e",fontWeight:"600",cursor:zi||!Object.values(Lt).some(Boolean)?"not-allowed":"pointer",fontSize:"0.95rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:Object.values(Lt).some(Boolean)?1:.5},children:zi?r.jsxs(r.Fragment,{children:[r.jsx(C,{size:16,className:"spin"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(S,{size:16}),"Final Mix"]})}),(He.mixedAudio||Ri?.mixedAudioUrl)&&r.jsxs("button",{onClick:()=>{const e=He.mixedAudio||Ri?.mixedAudioUrl;if(!e)return void t.error("No master mix available â€” create a final mix first");const i=document.createElement("a");i.href=(e.startsWith("data:"),e),i.download=`${se||"master"}-final-mix.mp3`,i.click(),t.success("Downloading master mix")},style:{flex:1,minWidth:"140px",padding:"14px",borderRadius:"12px",background:"rgba(249, 115, 22, 0.5)",border:"1px solid rgba(249, 115, 22, 0.6)",color:"#f97316",fontWeight:"600",cursor:"pointer",fontSize:"0.95rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r.jsx(M,{size:16}),"Download Master"]})]})]})}),r.jsx("style",{children:"\n        .loading-dots {\n          display: flex;\n          gap: 4px;\n        }\n        .loading-dots span {\n          width: 8px;\n          height: 8px;\n          border-radius: 50%;\n          animation: bounce 1.4s infinite ease-in-out both;\n        }\n        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }\n        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }\n        .loading-dots span:nth-child(3) { animation-delay: 0s; }\n        \n        @keyframes bounce {\n          0%, 80%, 100% { transform: scale(0); opacity: 0.5; }\n          40% { transform: scale(1); opacity: 1; }\n        }\n        \n        .spin {\n          animation: spin 1s linear infinite;\n        }\n        \n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.3s ease;\n        }\n        \n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n\n        .pulse-next-btn {\n          animation: pulseNext 2s ease-in-out infinite;\n        }\n\n        @keyframes pulseNext {\n          0%, 100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.4); }\n          50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0); }\n        }\n      "})]}):null}export{ne as default};
