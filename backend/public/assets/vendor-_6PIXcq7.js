import{g as fi}from"./react-vendor-BR78lmDG.js";var Be={exports:{}},qe={};var ft;function gi(){return ft||(ft=1,(function(t){function e(v,A){var x=v.length;v.push(A);e:for(;0<x;){var H=x-1>>>1,F=v[H];if(0<n(F,A))v[H]=A,v[x]=F,x=H;else break e}}function i(v){return v.length===0?null:v[0]}function s(v){if(v.length===0)return null;var A=v[0],x=v.pop();if(x!==A){v[0]=x;e:for(var H=0,F=v.length,Ee=F>>>1;H<Ee;){var Pe=2*(H+1)-1,We=v[Pe],ue=Pe+1,Me=v[ue];if(0>n(We,x))ue<F&&0>n(Me,We)?(v[H]=Me,v[ue]=x,H=ue):(v[H]=We,v[Pe]=x,H=Pe);else if(ue<F&&0>n(Me,x))v[H]=Me,v[ue]=x,H=ue;else break e}}return A}function n(v,A){var x=v.sortIndex-A.sortIndex;return x!==0?x:v.id-A.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],u=[],h=1,m=null,d=3,f=!1,p=!1,y=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function T(v){for(var A=i(u);A!==null;){if(A.callback===null)s(u);else if(A.startTime<=v)s(u),A.sortIndex=A.expirationTime,e(c,A);else break;A=i(u)}}function M(v){if(y=!1,T(v),!p)if(i(c)!==null)p=!0,P||(P=!0,X());else{var A=i(u);A!==null&&J(M,A.startTime-v)}}var P=!1,N=-1,L=5,D=-1;function j(){return w?!0:!(t.unstable_now()-D<L)}function z(){if(w=!1,P){var v=t.unstable_now();D=v;var A=!0;try{e:{p=!1,y&&(y=!1,g(N),N=-1),f=!0;var x=d;try{t:{for(T(v),m=i(c);m!==null&&!(m.expirationTime>v&&j());){var H=m.callback;if(typeof H=="function"){m.callback=null,d=m.priorityLevel;var F=H(m.expirationTime<=v);if(v=t.unstable_now(),typeof F=="function"){m.callback=F,T(v),A=!0;break t}m===i(c)&&s(c),T(v)}else s(c);m=i(c)}if(m!==null)A=!0;else{var Ee=i(u);Ee!==null&&J(M,Ee.startTime-v),A=!1}}break e}finally{m=null,d=x,f=!1}A=void 0}}finally{A?X():P=!1}}}var X;if(typeof k=="function")X=function(){k(z)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,I=Q.port2;Q.port1.onmessage=z,X=function(){I.postMessage(null)}}else X=function(){C(z,0)};function J(v,A){N=C(function(){v(t.unstable_now())},A)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(v){v.callback=null},t.unstable_forceFrameRate=function(v){0>v||125<v?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<v?Math.floor(1e3/v):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(v){switch(d){case 1:case 2:case 3:var A=3;break;default:A=d}var x=d;d=A;try{return v()}finally{d=x}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(v,A){switch(v){case 1:case 2:case 3:case 4:case 5:break;default:v=3}var x=d;d=v;try{return A()}finally{d=x}},t.unstable_scheduleCallback=function(v,A,x){var H=t.unstable_now();switch(typeof x=="object"&&x!==null?(x=x.delay,x=typeof x=="number"&&0<x?H+x:H):x=H,v){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=x+F,v={id:h++,callback:A,priorityLevel:v,startTime:x,expirationTime:F,sortIndex:-1},x>H?(v.sortIndex=x,e(u,v),i(c)===null&&v===i(u)&&(y?(g(N),N=-1):y=!0,J(M,x-H))):(v.sortIndex=F,e(c,v),p||f||(p=!0,P||(P=!0,X()))),v},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(v){var A=d;return function(){var x=d;d=A;try{return v.apply(this,arguments)}finally{d=x}}}})(qe)),qe}var gt;function Xs(){return gt||(gt=1,Be.exports=gi()),Be.exports}function G(t,e,i,s){return new(i||(i=Promise))((function(n,r){function a(u){try{c(s.next(u))}catch(h){r(h)}}function o(u){try{c(s.throw(u))}catch(h){r(h)}}function c(u){var h;u.done?n(u.value):(h=u.value,h instanceof i?h:new i((function(m){m(h)}))).then(a,o)}c((s=s.apply(t,e||[])).next())}))}let ke=class{constructor(){this.listeners={}}on(e,i,s){if(this.listeners[e]||(this.listeners[e]=new Set),s?.once){const n=(...r)=>{this.un(e,n),i(...r)};return this.listeners[e].add(n),()=>this.un(e,n)}return this.listeners[e].add(i),()=>this.un(e,i)}un(e,i){var s;(s=this.listeners[e])===null||s===void 0||s.delete(i)}once(e,i){return this.on(e,i,{once:!0})}unAll(){this.listeners={}}emit(e,...i){this.listeners[e]&&this.listeners[e].forEach((s=>s(...i)))}};const Ae={decode:function(t,e){return G(this,void 0,void 0,(function*(){const i=new AudioContext({sampleRate:e});try{return yield i.decodeAudioData(t)}finally{i.close()}}))},createBuffer:function(t,e){if(!t||t.length===0)throw new Error("channelData must be a non-empty array");if(e<=0)throw new Error("duration must be greater than 0");if(typeof t[0]=="number"&&(t=[t]),!t[0]||t[0].length===0)throw new Error("channelData must contain non-empty channel arrays");(function(s){const n=s[0];if(n.some((r=>r>1||r<-1))){const r=n.length;let a=0;for(let o=0;o<r;o++){const c=Math.abs(n[o]);c>a&&(a=c)}for(const o of s)for(let c=0;c<r;c++)o[c]/=a}})(t);const i=t.map((s=>s instanceof Float32Array?s:Float32Array.from(s)));return{duration:e,length:i[0].length,sampleRate:i[0].length/e,numberOfChannels:i.length,getChannelData:s=>{const n=i[s];if(!n)throw new Error(`Channel ${s} not found`);return n},copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Ot(t,e){const i=e.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);for(const[s,n]of Object.entries(e))if(s==="children"&&n)for(const[r,a]of Object.entries(n))a instanceof Node?i.appendChild(a):typeof a=="string"?i.appendChild(document.createTextNode(a)):i.appendChild(Ot(r,a));else s==="style"?Object.assign(i.style,n):s==="textContent"?i.textContent=n:i.setAttribute(s,n.toString());return i}function bt(t,e,i){const s=Ot(t,e||{});return i?.appendChild(s),s}var bi=Object.freeze({__proto__:null,createElement:bt,default:bt});const yi={fetchBlob:function(t,e,i){return G(this,void 0,void 0,(function*(){const s=yield fetch(t,i);if(s.status>=400)throw new Error(`Failed to fetch ${t}: ${s.status} (${s.statusText})`);return(function(n,r){G(this,void 0,void 0,(function*(){if(!n.body||!n.headers)return;const a=n.body.getReader(),o=Number(n.headers.get("Content-Length"))||0;let c=0;const u=h=>{c+=h?.length||0;const m=Math.round(c/o*100);r(m)};try{for(;;){const h=yield a.read();if(h.done)break;u(h.value)}}catch(h){console.warn("Progress tracking error:",h)}}))})(s.clone(),e),s.blob()}))}};function B(t){let e=t;const i=new Set;return{get value(){return e},set(s){Object.is(e,s)||(e=s,i.forEach((n=>n(e))))},update(s){this.set(s(e))},subscribe:s=>(i.add(s),()=>i.delete(s))}}function de(t,e){const i=B(t());return e.forEach((s=>s.subscribe((()=>{const n=t();Object.is(i.value,n)||i.set(n)})))),{get value(){return i.value},subscribe:s=>i.subscribe(s)}}function re(t,e){let i;const s=()=>{i&&(i(),i=void 0),i=t()},n=e.map((r=>r.subscribe(s)));return s(),()=>{i&&(i(),i=void 0),n.forEach((r=>r()))}}let vi=class extends ke{get isPlayingSignal(){return this._isPlaying}get currentTimeSignal(){return this._currentTime}get durationSignal(){return this._duration}get volumeSignal(){return this._volume}get mutedSignal(){return this._muted}get playbackRateSignal(){return this._playbackRate}get seekingSignal(){return this._seeking}constructor(e){super(),this.isExternalMedia=!1,this.reactiveMediaEventCleanups=[],e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),this._isPlaying=B(!1),this._currentTime=B(0),this._duration=B(0),this._volume=B(this.media.volume),this._muted=B(this.media.muted),this._playbackRate=B(this.media.playbackRate||1),this._seeking=B(!1),this.setupReactiveMediaEvents(),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",(()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)}),{once:!0})}setupReactiveMediaEvents(){this.reactiveMediaEventCleanups.push(this.onMediaEvent("play",(()=>{this._isPlaying.set(!0)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("pause",(()=>{this._isPlaying.set(!1)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("ended",(()=>{this._isPlaying.set(!1)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("timeupdate",(()=>{this._currentTime.set(this.media.currentTime)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("durationchange",(()=>{this._duration.set(this.media.duration||0)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("loadedmetadata",(()=>{this._duration.set(this.media.duration||0)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("seeking",(()=>{this._seeking.set(!0)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("seeked",(()=>{this._seeking.set(!1)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("volumechange",(()=>{this._volume.set(this.media.volume),this._muted.set(this.media.muted)}))),this.reactiveMediaEventCleanups.push(this.onMediaEvent("ratechange",(()=>{this._playbackRate.set(this.media.playbackRate)})))}onMediaEvent(e,i,s){return this.media.addEventListener(e,i,s),()=>this.media.removeEventListener(e,i,s)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,i){const s=this.getSrc();if(e&&s===e)return;this.revokeSrc();const n=i instanceof Blob&&(this.canPlayType(i.type)||!e)?URL.createObjectURL(i):e;if(s&&this.media.removeAttribute("src"),n||e)try{this.media.src=n}catch{this.media.src=e}}destroy(){this.reactiveMediaEventCleanups.forEach((e=>e())),this.reactiveMediaEventCleanups=[],this.isExternalMedia||(this.media.pause(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load(),this.media.remove())}setMediaElement(e){this.reactiveMediaEventCleanups.forEach((i=>i())),this.reactiveMediaEventCleanups=[],this.media=e,this.setupReactiveMediaEvents()}play(){return G(this,void 0,void 0,(function*(){try{return yield this.media.play()}catch(e){if(e instanceof DOMException&&e.name==="AbortError")return;throw e}}))}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,i){i!=null&&(this.media.preservesPitch=i),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}};function wi({maxTop:t,maxBottom:e,halfHeight:i,vScale:s,barMinHeight:n=0,barAlign:r}){let a=Math.round(t*i*s),o=a+Math.round(e*i*s)||1;return o<n&&(o=n,r||(a=o/2)),{topHeight:a,totalHeight:o}}function ki({barAlign:t,halfHeight:e,topHeight:i,totalHeight:s,canvasHeight:n}){return t==="top"?0:t==="bottom"?n-s:e-i}function yt(t,e,i){const s=e-t.left,n=i-t.top;return[s/t.width,n/t.height]}function $t(t){return!!(t.barWidth||t.barGap||t.barAlign)}function vt(t,e){if(!$t(e))return t;const i=e.barWidth||.5,s=i+(e.barGap||i/2);return s===0?t:Math.floor(t/s)*s}function wt({scrollLeft:t,totalWidth:e,numCanvases:i}){if(e===0)return[0];const s=t/e,n=Math.floor(s*i);return[n-1,n,n+1]}function Ht(t){const e=t._cleanup;typeof e=="function"&&e()}function Ti(t){const e=B({scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth}),i=de((()=>(function(r){const{scrollLeft:a,scrollWidth:o,clientWidth:c}=r;if(o===0)return{startX:0,endX:1};const u=a/o,h=(a+c)/o;return{startX:Math.max(0,Math.min(1,u)),endX:Math.max(0,Math.min(1,h))}})(e.value)),[e]),s=de((()=>(function(r){return{left:r.scrollLeft,right:r.scrollLeft+r.clientWidth}})(e.value)),[e]),n=()=>{e.set({scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth})};return t.addEventListener("scroll",n,{passive:!0}),{scrollData:e,percentages:i,bounds:s,cleanup:()=>{t.removeEventListener("scroll",n),Ht(e)}}}class Ci extends ke{constructor(e,i){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.dragStream=null,this.scrollStream=null,this.subscriptions=[],this.options=e;const s=this.parentFromOptionsContainer(e.container);this.parent=s;const[n,r]=this.initHtml();s.appendChild(n),this.container=n,this.scrollContainer=r.querySelector(".scroll"),this.wrapper=r.querySelector(".wrapper"),this.canvasWrapper=r.querySelector(".canvases"),this.progressWrapper=r.querySelector(".progress"),this.cursor=r.querySelector(".cursor"),i&&r.appendChild(i),this.initEvents()}parentFromOptionsContainer(e){let i;if(typeof e=="string"?i=document.querySelector(e):e instanceof HTMLElement&&(i=e),!i)throw new Error("Container not found");return i}initEvents(){this.wrapper.addEventListener("click",(i=>{const s=this.wrapper.getBoundingClientRect(),[n,r]=yt(s,i.clientX,i.clientY);this.emit("click",n,r)})),this.wrapper.addEventListener("dblclick",(i=>{const s=this.wrapper.getBoundingClientRect(),[n,r]=yt(s,i.clientX,i.clientY);this.emit("dblclick",n,r)})),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollStream=Ti(this.scrollContainer);const e=re((()=>{const{startX:i,endX:s}=this.scrollStream.percentages.value,{left:n,right:r}=this.scrollStream.bounds.value;this.emit("scroll",i,s,n,r)}),[this.scrollStream.percentages,this.scrollStream.bounds]);if(this.subscriptions.push(e),typeof ResizeObserver=="function"){const i=this.createDelay(100);this.resizeObserver=new ResizeObserver((()=>{i().then((()=>this.onContainerResize())).catch((()=>{}))})),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender(),this.emit("resize"))}initDrag(){if(this.dragStream)return;this.dragStream=(function(i,s={}){const{threshold:n=3,mouseButton:r=0,touchDelay:a=100}=s,o=B(null),c=new Map,u=matchMedia("(pointer: coarse)").matches;let h=()=>{};const m=d=>{if(d.button!==r||(c.set(d.pointerId,d),c.size>1))return;let f=d.clientX,p=d.clientY,y=!1;const w=Date.now(),C=i.getBoundingClientRect(),{left:g,top:k}=C,T=D=>{if(D.defaultPrevented||c.size>1||u&&Date.now()-w<a)return;const j=D.clientX,z=D.clientY,X=j-f,Q=z-p;(y||Math.abs(X)>n||Math.abs(Q)>n)&&(D.preventDefault(),D.stopPropagation(),y||(o.set({type:"start",x:f-g,y:p-k}),y=!0),o.set({type:"move",x:j-g,y:z-k,deltaX:X,deltaY:Q}),f=j,p=z)},M=D=>{if(c.delete(D.pointerId),y){const j=D.clientX,z=D.clientY;o.set({type:"end",x:j-g,y:z-k})}h()},P=D=>{c.delete(D.pointerId),D.relatedTarget&&D.relatedTarget!==document.documentElement||M(D)},N=D=>{y&&(D.stopPropagation(),D.preventDefault())},L=D=>{D.defaultPrevented||c.size>1||y&&D.preventDefault()};document.addEventListener("pointermove",T),document.addEventListener("pointerup",M),document.addEventListener("pointerout",P),document.addEventListener("pointercancel",P),document.addEventListener("touchmove",L,{passive:!1}),document.addEventListener("click",N,{capture:!0}),h=()=>{document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",M),document.removeEventListener("pointerout",P),document.removeEventListener("pointercancel",P),document.removeEventListener("touchmove",L),setTimeout((()=>{document.removeEventListener("click",N,{capture:!0})}),10)}};return i.addEventListener("pointerdown",m),{signal:o,cleanup:()=>{h(),i.removeEventListener("pointerdown",m),c.clear(),Ht(o)}}})(this.wrapper);const e=re((()=>{const i=this.dragStream.signal.value;if(!i)return;const s=this.wrapper.getBoundingClientRect().width,n=(r=i.x/s)<0?0:r>1?1:r;var r;i.type==="start"?(this.isDragging=!0,this.emit("dragstart",n)):i.type==="move"?this.emit("drag",n):i.type==="end"&&(this.isDragging=!1,this.emit("dragend",n))}),[this.dragStream.signal]);this.subscriptions.push(e)}initHtml(){const e=document.createElement("div"),i=e.attachShadow({mode:"open"}),s=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return i.innerHTML=`
      <style${s?` nonce="${s}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
          pointer-events: none;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,i]}setOptions(e){if(this.options.container!==e.container){const i=this.parentFromOptionsContainer(e.container);i.appendChild(this.container),this.parent=i}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:i}=this.scrollContainer,s=i*e;this.setScroll(s)}destroy(){var e;this.subscriptions.forEach((i=>i())),this.container.remove(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),(e=this.unsubscribeOnScroll)===null||e===void 0||e.forEach((i=>i())),this.unsubscribeOnScroll=[],this.dragStream&&(this.dragStream.cleanup(),this.dragStream=null),this.scrollStream&&(this.scrollStream.cleanup(),this.scrollStream=null)}createDelay(e=10){let i,s;const n=()=>{i&&(clearTimeout(i),i=void 0),s&&(s(),s=void 0)};return this.timeouts.push(n),()=>new Promise(((r,a)=>{n(),s=a,i=setTimeout((()=>{i=void 0,s=void 0,r()}),e)}))}getHeight(e,i){var s;const n=((s=this.audioData)===null||s===void 0?void 0:s.numberOfChannels)||1;return(function({optionsHeight:r,optionsSplitChannels:a,parentHeight:o,numberOfChannels:c,defaultHeight:u=128}){if(r==null)return u;const h=Number(r);if(!isNaN(h))return h;if(r==="auto"){const m=o||u;return a?.every((d=>!d.overlay))?m/c:m}return u})({optionsHeight:e,optionsSplitChannels:i,parentHeight:this.parent.clientHeight,numberOfChannels:n,defaultHeight:128})}convertColorValues(e,i){return(function(s,n,r){if(!Array.isArray(s))return s||"";if(s.length===0)return"#999";if(s.length<2)return s[0]||"";const a=document.createElement("canvas"),o=a.getContext("2d"),c=r??a.height*n,u=o.createLinearGradient(0,0,0,c||n),h=1/(s.length-1);return s.forEach(((m,d)=>{u.addColorStop(d*h,m)})),u})(e,this.getPixelRatio(),i?.canvas.height)}getPixelRatio(){return e=window.devicePixelRatio,Math.max(1,e||1);var e}renderBarWaveform(e,i,s,n){const{width:r,height:a}=s.canvas,{halfHeight:o,barWidth:c,barRadius:u,barIndexScale:h,barSpacing:m,barMinHeight:d}=(function({width:p,height:y,length:w,options:C,pixelRatio:g}){const k=y/2,T=C.barWidth?C.barWidth*g:1,M=C.barGap?C.barGap*g:C.barWidth?T/2:0,P=T+M||1;return{halfHeight:k,barWidth:T,barGap:M,barRadius:C.barRadius||0,barMinHeight:C.barMinHeight?C.barMinHeight*g:0,barIndexScale:w>0?p/P/w:0,barSpacing:P}})({width:r,height:a,length:(e[0]||[]).length,options:i,pixelRatio:this.getPixelRatio()}),f=(function({channelData:p,barIndexScale:y,barSpacing:w,barWidth:C,halfHeight:g,vScale:k,canvasHeight:T,barAlign:M,barMinHeight:P}){const N=p[0]||[],L=p[1]||N,D=N.length,j=[];let z=0,X=0,Q=0;for(let I=0;I<=D;I++){const J=Math.round(I*y);if(J>z){const{topHeight:x,totalHeight:H}=wi({maxTop:X,maxBottom:Q,halfHeight:g,vScale:k,barMinHeight:P,barAlign:M}),F=ki({barAlign:M,halfHeight:g,topHeight:x,totalHeight:H,canvasHeight:T});j.push({x:z*w,y:F,width:C,height:H}),z=J,X=0,Q=0}const v=Math.abs(N[I]||0),A=Math.abs(L[I]||0);v>X&&(X=v),A>Q&&(Q=A)}return j})({channelData:e,barIndexScale:h,barSpacing:m,barWidth:c,halfHeight:o,vScale:n,canvasHeight:a,barAlign:i.barAlign,barMinHeight:d});s.beginPath();for(const p of f)u&&"roundRect"in s?s.roundRect(p.x,p.y,p.width,p.height,u):s.rect(p.x,p.y,p.width,p.height);s.fill(),s.closePath()}renderLineWaveform(e,i,s,n){const{width:r,height:a}=s.canvas,o=(function({channelData:c,width:u,height:h,vScale:m}){const d=h/2,f=c[0]||[];return[f,c[1]||f].map(((p,y)=>{const w=p.length,C=w?u/w:0,g=d,k=y===0?-1:1,T=[{x:0,y:g}];let M=0,P=0;for(let N=0;N<=w;N++){const L=Math.round(N*C);if(L>M){const j=g+(Math.round(P*d*m)||1)*k;T.push({x:M,y:j}),M=L,P=0}const D=Math.abs(p[N]||0);D>P&&(P=D)}return T.push({x:M,y:g}),T}))})({channelData:e,width:r,height:a,vScale:n});s.beginPath();for(const c of o)if(c.length){s.moveTo(c[0].x,c[0].y);for(let u=1;u<c.length;u++){const h=c[u];s.lineTo(h.x,h.y)}}s.fill(),s.closePath()}renderWaveform(e,i,s){if(s.fillStyle=this.convertColorValues(i.waveColor,s),i.renderFunction)return void i.renderFunction(e,s);const n=(function({channelData:r,barHeight:a,normalize:o,maxPeak:c}){var u;const h=a||1;if(!o)return h;const m=r[0];if(!m||m.length===0)return h;let d=c??0;if(!c)for(let f=0;f<m.length;f++){const p=(u=m[f])!==null&&u!==void 0?u:0,y=Math.abs(p);y>d&&(d=y)}return d?h/d:h})({channelData:e,barHeight:i.barHeight,normalize:i.normalize,maxPeak:i.maxPeak});$t(i)?this.renderBarWaveform(e,i,s,n):this.renderLineWaveform(e,i,s,n)}renderSingleCanvas(e,i,s,n,r,a,o){const c=this.getPixelRatio(),u=document.createElement("canvas");u.width=Math.round(s*c),u.height=Math.round(n*c),u.style.width=`${s}px`,u.style.height=`${n}px`,u.style.left=`${Math.round(r)}px`,a.appendChild(u);const h=u.getContext("2d");if(i.renderFunction?(h.fillStyle=this.convertColorValues(i.waveColor,h),i.renderFunction(e,h)):this.renderWaveform(e,i,h),u.width>0&&u.height>0){const m=u.cloneNode(),d=m.getContext("2d");d.drawImage(u,0,0),d.globalCompositeOperation="source-in",d.fillStyle=this.convertColorValues(i.progressColor,d),d.fillRect(0,0,u.width,u.height),o.appendChild(m)}}renderMultiCanvas(e,i,s,n,r,a){const o=this.getPixelRatio(),{clientWidth:c}=this.scrollContainer,u=s/o,h=(function({clientWidth:p,totalWidth:y,options:w}){return vt(Math.min(8e3,p,y),w)})({clientWidth:c,totalWidth:u,options:i});let m={};if(h===0)return;const d=p=>{if(p<0||p>=f||m[p])return;m[p]=!0;const y=p*h;let w=Math.min(u-y,h);if(w=vt(w,i),w<=0)return;const C=(function({channelData:g,offset:k,clampedWidth:T,totalWidth:M}){return g.map((P=>{const N=Math.floor(k/M*P.length),L=Math.floor((k+T)/M*P.length);return P.slice(N,L)}))})({channelData:e,offset:y,clampedWidth:w,totalWidth:u});this.renderSingleCanvas(C,i,w,n,y,r,a)},f=Math.ceil(u/h);if(!this.isScrollable){for(let p=0;p<f;p++)d(p);return}if(wt({scrollLeft:this.scrollContainer.scrollLeft,totalWidth:u,numCanvases:f}).forEach((p=>d(p))),f>1){const p=this.on("scroll",(()=>{const{scrollLeft:y}=this.scrollContainer;Object.keys(m).length>10&&(r.innerHTML="",a.innerHTML="",m={}),wt({scrollLeft:y,totalWidth:u,numCanvases:f}).forEach((w=>d(w)))}));this.unsubscribeOnScroll.push(p)}}renderChannel(e,i,s,n){var{overlay:r}=i,a=(function(h,m){var d={};for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&m.indexOf(f)<0&&(d[f]=h[f]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var p=0;for(f=Object.getOwnPropertySymbols(h);p<f.length;p++)m.indexOf(f[p])<0&&Object.prototype.propertyIsEnumerable.call(h,f[p])&&(d[f[p]]=h[f[p]])}return d})(i,["overlay"]);const o=document.createElement("div"),c=this.getHeight(a.height,a.splitChannels);o.style.height=`${c}px`,r&&n>0&&(o.style.marginTop=`-${c}px`),this.canvasWrapper.style.minHeight=`${c}px`,this.canvasWrapper.appendChild(o);const u=o.cloneNode();this.progressWrapper.appendChild(u),this.renderMultiCanvas(e,a,s,c,o,u)}render(e){return G(this,void 0,void 0,(function*(){var i;this.timeouts.forEach((u=>u())),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const s=this.getPixelRatio(),n=this.scrollContainer.clientWidth,{scrollWidth:r,isScrollable:a,useParentWidth:o,width:c}=(function({duration:u,minPxPerSec:h=0,parentWidth:m,fillParent:d,pixelRatio:f}){const p=Math.ceil(u*h),y=p>m,w=!!(d&&!y);return{scrollWidth:p,isScrollable:y,useParentWidth:w,width:(w?m:p)*f}})({duration:e.duration,minPxPerSec:this.options.minPxPerSec||0,parentWidth:n,fillParent:this.options.fillParent,pixelRatio:s});if(this.isScrollable=a,this.wrapper.style.width=o?"100%":`${r}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let u=0;u<e.numberOfChannels;u++){const h=Object.assign(Object.assign({},this.options),(i=this.options.splitChannels)===null||i===void 0?void 0:i[u]);this.renderChannel([e.getChannelData(u)],h,c,u)}else{const u=[e.getChannelData(0)];e.numberOfChannels>1&&u.push(e.getChannelData(1)),this.renderChannel(u,this.options,c,0)}Promise.resolve().then((()=>this.emit("rendered")))}))}reRender(){if(this.unsubscribeOnScroll.forEach((s=>s())),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:i}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:s}=this.progressWrapper.getBoundingClientRect(),n=(function(r){const a=2*r;return(a<0?Math.floor(a):Math.ceil(a))/2})(s-i);this.scrollContainer.scrollLeft+=n}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,i=!1){const{scrollLeft:s,scrollWidth:n,clientWidth:r}=this.scrollContainer,a=e*n,o=s,c=s+r,u=r/2;if(this.isDragging)a+30>c?this.scrollContainer.scrollLeft+=30:a-30<o&&(this.scrollContainer.scrollLeft-=30);else{(a<o||a>c)&&(this.scrollContainer.scrollLeft=a-(this.options.autoCenter?u:0));const h=a-s-u;i&&this.options.autoCenter&&h>0&&(this.scrollContainer.scrollLeft+=h)}}renderProgress(e,i){if(isNaN(e))return;const s=100*e;this.canvasWrapper.style.clipPath=`polygon(${s}% 0%, 100% 0%, 100% 100%, ${s}% 100%)`,this.progressWrapper.style.width=`${s}%`,this.cursor.style.left=`${s}%`,this.cursor.style.transform=this.options.cursorWidth?`translateX(-${e*this.options.cursorWidth}px)`:"",this.isScrollable&&this.options.autoScroll&&this.audioData&&this.audioData.duration>0&&this.scrollIntoView(e,i)}exportImage(e,i,s){return G(this,void 0,void 0,(function*(){const n=this.canvasWrapper.querySelectorAll("canvas");if(!n.length)throw new Error("No waveform data");if(s==="dataURL"){const r=Array.from(n).map((a=>a.toDataURL(e,i)));return Promise.resolve(r)}return Promise.all(Array.from(n).map((r=>new Promise(((a,o)=>{r.toBlob((c=>{c?a(c):o(new Error("Could not export image"))}),e,i)})))))}))}}class Si extends ke{constructor(){super(...arguments),this.animationFrameId=null,this.isRunning=!1}start(){if(this.isRunning)return;this.isRunning=!0;const e=()=>{this.isRunning&&(this.emit("tick"),this.animationFrameId=requestAnimationFrame(e))};e()}stop(){this.isRunning=!1,this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop()}}class Fe extends ke{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return G(this,void 0,void 0,(function*(){}))}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then((i=>{if(i.status>=400)throw new Error(`Failed to fetch ${e}: ${i.status} (${i.statusText})`);return i.arrayBuffer()})).then((i=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(i))).then((i=>{this.currentSrc===e&&(this.buffer=i,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})).catch((i=>{console.error("WebAudioPlayer load error:",i)}))}_play(){if(!this.paused)return;this.paused=!1,this.bufferNode&&(this.bufferNode.onended=null,this.bufferNode.disconnect()),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let e=this.playedDuration*this._playbackRate;(e>=this.duration||e<0)&&(e=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,e),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return G(this,void 0,void 0,(function*(){this.paused&&(this._play(),this.emit("play"))}))}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){const i=e-this.currentTime,s=this.bufferNode;s?.stop(this.audioContext.currentTime+i),s?.addEventListener("ended",(()=>{s===this.bufferNode&&(this.bufferNode=null,this.pause())}),{once:!0})}setSinkId(e){return G(this,void 0,void 0,(function*(){return this.audioContext.setSinkId(e)}))}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const i=!this.paused;i&&this._pause(),this.playedDuration=e/this._playbackRate,i&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,i;return(e=this._duration)!==null&&e!==void 0?e:((i=this.buffer)===null||i===void 0?void 0:i.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const i=this.buffer.numberOfChannels;for(let s=0;s<i;s++)e.push(this.buffer.getChannelData(s));return e}removeAttribute(e){switch(e){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}const Ei={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};let kt=class jt extends vi{static create(e){return new jt(e)}getState(){return this.wavesurferState}getRenderer(){return this.renderer}constructor(e){const i=e.media||(e.backend==="WebAudio"?new Fe:void 0);super({media:i,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.reactiveCleanups=[],this.options=Object.assign({},Ei,e);const{state:s,actions:n}=(function(o){var c,u,h,m,d,f;const p=(c=o?.currentTime)!==null&&c!==void 0?c:B(0),y=(u=o?.duration)!==null&&u!==void 0?u:B(0),w=(h=o?.isPlaying)!==null&&h!==void 0?h:B(!1),C=(m=o?.isSeeking)!==null&&m!==void 0?m:B(!1),g=(d=o?.volume)!==null&&d!==void 0?d:B(1),k=(f=o?.playbackRate)!==null&&f!==void 0?f:B(1),T=B(null),M=B(null),P=B(""),N=B(0),L=B(0),D=de((()=>!w.value),[w]),j=de((()=>T.value!==null),[T]),z=de((()=>j.value&&y.value>0),[j,y]),X=de((()=>p.value),[p]),Q=de((()=>y.value>0?p.value/y.value:0),[p,y]);return{state:{currentTime:p,duration:y,isPlaying:w,isPaused:D,isSeeking:C,volume:g,playbackRate:k,audioBuffer:T,peaks:M,url:P,zoom:N,scrollPosition:L,canPlay:j,isReady:z,progress:X,progressPercent:Q},actions:{setCurrentTime:I=>{const J=Math.max(0,Math.min(y.value||1/0,I));p.set(J)},setDuration:I=>{y.set(Math.max(0,I))},setPlaying:I=>{w.set(I)},setSeeking:I=>{C.set(I)},setVolume:I=>{const J=Math.max(0,Math.min(1,I));g.set(J)},setPlaybackRate:I=>{const J=Math.max(.1,Math.min(16,I));k.set(J)},setAudioBuffer:I=>{T.set(I),I&&y.set(I.duration)},setPeaks:I=>{M.set(I)},setUrl:I=>{P.set(I)},setZoom:I=>{N.set(Math.max(0,I))},setScrollPosition:I=>{L.set(Math.max(0,I))}}}})({isPlaying:this.isPlayingSignal,currentTime:this.currentTimeSignal,duration:this.durationSignal,volume:this.volumeSignal,playbackRate:this.playbackRateSignal,isSeeking:this.seekingSignal});this.wavesurferState=s,this.wavesurferActions=n,this.timer=new Si;const r=i?void 0:this.getMediaElement();this.renderer=new Ci(this.options,r),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initReactiveState(),this.initPlugins();const a=this.options.url||this.getSrc()||"";Promise.resolve().then((()=>{this.emit("init");const{peaks:o,duration:c}=this.options;(a||o&&c)&&this.load(a,o,c).catch((u=>{this.emit("error",u instanceof Error?u:new Error(String(u)))}))}))}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",(()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}})))}initReactiveState(){this.reactiveCleanups.push((function(e,i){const s=[];s.push(re((()=>{const a=e.isPlaying.value;i.emit(a?"play":"pause")}),[e.isPlaying])),s.push(re((()=>{const a=e.currentTime.value;i.emit("timeupdate",a),e.isPlaying.value&&i.emit("audioprocess",a)}),[e.currentTime,e.isPlaying])),s.push(re((()=>{e.isSeeking.value&&i.emit("seeking",e.currentTime.value)}),[e.isSeeking,e.currentTime]));let n=!1;s.push(re((()=>{e.isReady.value&&!n&&(n=!0,i.emit("ready",e.duration.value))}),[e.isReady,e.duration]));let r=!1;return s.push(re((()=>{const a=e.isPlaying.value,o=e.currentTime.value,c=e.duration.value,u=c>0&&o>=c;r&&!a&&u&&i.emit("finish"),r=a&&u}),[e.isPlaying,e.currentTime,e.duration])),s.push(re((()=>{const a=e.zoom.value;a>0&&i.emit("zoom",a)}),[e.zoom])),()=>{s.forEach((a=>a()))}})(this.wavesurferState,{emit:this.emit.bind(this)}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",(()=>{const e=this.updateProgress();this.emit("timeupdate",e)})),this.onMediaEvent("play",(()=>{this.emit("play"),this.timer.start()})),this.onMediaEvent("pause",(()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null})),this.onMediaEvent("emptied",(()=>{this.timer.stop(),this.stopAtPosition=null})),this.onMediaEvent("ended",(()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null})),this.onMediaEvent("seeking",(()=>{this.emit("seeking",this.getCurrentTime())})),this.onMediaEvent("error",(()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null})))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",((e,i)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,i))})),this.renderer.on("dblclick",((e,i)=>{this.emit("dblclick",e,i)})),this.renderer.on("scroll",((e,i,s,n)=>{const r=this.getDuration();this.emit("scroll",e*r,i*r,s,n)})),this.renderer.on("render",(()=>{this.emit("redraw")})),this.renderer.on("rendered",(()=>{this.emit("redrawcomplete")})),this.renderer.on("dragstart",(e=>{this.emit("dragstart",e)})),this.renderer.on("dragend",(e=>{this.emit("dragend",e)})),this.renderer.on("resize",(()=>{this.emit("resize")})));{let e;const i=this.renderer.on("drag",(s=>{var n;if(!this.options.interact)return;this.renderer.renderProgress(s),clearTimeout(e);let r=0;const a=this.options.dragToSeek;this.isPlaying()?r=0:a===!0?r=200:a&&typeof a=="object"&&(r=(n=a.debounceTime)!==null&&n!==void 0?n:200),e=setTimeout((()=>{this.seekTo(s)}),r),this.emit("interaction",s*this.getDuration()),this.emit("drag",s)}));this.subscriptions.push((()=>{clearTimeout(e),i()}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach((i=>{this.registerPlugin(i)}))}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach((e=>e())),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=Ae.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=Ae.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){if(this.plugins.includes(e))return e;e._init(this),this.plugins.push(e);const i=e.once("destroy",(()=>{this.plugins=this.plugins.filter((s=>s!==e)),this.subscriptions=this.subscriptions.filter((s=>s!==i))}));return this.subscriptions.push(i),e}unregisterPlugin(e){this.plugins=this.plugins.filter((i=>i!==e)),e.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const i=e/this.getDuration();this.renderer.setScrollPercentage(i)}getActivePlugins(){return this.plugins}loadAudio(e,i,s,n){return G(this,void 0,void 0,(function*(){var r;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,(r=this.abortController)===null||r===void 0||r.abort(),this.abortController=null,!i&&!s){const o=this.options.fetchParams||{};window.AbortController&&!o.signal&&(this.abortController=new AbortController,o.signal=this.abortController.signal);const c=h=>this.emit("loading",h);i=yield yi.fetchBlob(e,c,o);const u=this.options.blobMimeType;u&&(i=new Blob([i],{type:u}))}this.setSrc(e,i);const a=yield new Promise((o=>{const c=n||this.getDuration();c?o(c):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",(()=>o(this.getDuration())),{once:!0}))}));if(!e&&!i){const o=this.getMediaElement();o instanceof Fe&&(o.duration=a)}if(s)this.decodedData=Ae.createBuffer(s,a||0);else if(i){const o=yield i.arrayBuffer();this.decodedData=yield Ae.decode(o,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())}))}load(e,i,s){return G(this,void 0,void 0,(function*(){try{return yield this.loadAudio(e,void 0,i,s)}catch(n){throw this.emit("error",n),n}}))}loadBlob(e,i,s){return G(this,void 0,void 0,(function*(){try{return yield this.loadAudio("",e,i,s)}catch(n){throw this.emit("error",n),n}}))}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:i=8e3,precision:s=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const n=Math.min(e,this.decodedData.numberOfChannels),r=[];for(let a=0;a<n;a++){const o=this.decodedData.getChannelData(a),c=[],u=o.length/i;for(let h=0;h<i;h++){const m=o.slice(Math.floor(h*u),Math.ceil((h+1)*u));let d=0;for(let f=0;f<m.length;f++){const p=m[f];Math.abs(p)>Math.abs(d)&&(d=p)}c.push(Math.round(d*s)/s)}r.push(c)}return r}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const i=this.getDuration()*e;this.setTime(i)}play(e,i){const s=Object.create(null,{play:{get:()=>super.play}});return G(this,void 0,void 0,(function*(){e!=null&&this.setTime(e);const n=yield s.play.call(this);return i!=null&&(this.media instanceof Fe?this.media.stopAt(i):this.stopAtPosition=i),n}))}playPause(){return G(this,void 0,void 0,(function*(){return this.isPlaying()?this.pause():this.play()}))}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return G(this,arguments,void 0,(function*(e="image/png",i=1,s="dataURL"){return this.renderer.exportImage(e,i,s)}))}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach((i=>i.destroy())),this.subscriptions.forEach((i=>i())),this.unsubscribePlayerEvents(),this.reactiveCleanups.forEach((i=>i())),this.reactiveCleanups=[],this.timer.destroy(),this.renderer.destroy(),super.destroy()}};kt.BasePlugin=class extends ke{constructor(t){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=t}onInit(){}_init(t){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach((t=>t())),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},kt.dom=bi;function Pi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tt(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Mi(t,e,i){return e&&Tt(t.prototype,e),i&&Tt(t,i),t}function Ai(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ct(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,s)}return i}function St(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?Ct(Object(i),!0).forEach((function(s){Ai(t,s,i[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ct(Object(i)).forEach((function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(i,s))}))}return t}var Et={addCSS:!0,thumbWidth:15,watch:!0};function xi(t,e){return(function(){return Array.from(document.querySelectorAll(e)).includes(this)}).call(t,e)}function Li(t,e){if(t&&e){var i=new Event(e,{bubbles:!0});t.dispatchEvent(i)}}var Te=function(t){return t!=null?t.constructor:null},lt=function(t,e){return!!(t&&e&&t instanceof e)},Wt=function(t){return t==null},Bt=function(t){return Te(t)===Object},Ni=function(t){return Te(t)===Number&&!Number.isNaN(t)},qt=function(t){return Te(t)===String},Di=function(t){return Te(t)===Boolean},Ri=function(t){return Te(t)===Function},Ft=function(t){return Array.isArray(t)},Vt=function(t){return lt(t,NodeList)},_i=function(t){return lt(t,Element)},Ii=function(t){return lt(t,Event)},Oi=function(t){return Wt(t)||(qt(t)||Ft(t)||Vt(t))&&!t.length||Bt(t)&&!Object.keys(t).length},Y={nullOrUndefined:Wt,object:Bt,number:Ni,string:qt,boolean:Di,function:Ri,array:Ft,nodeList:Vt,element:_i,event:Ii,empty:Oi};function $i(t){var e="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}function Hi(t,e){if(1>e){var i=$i(e);return parseFloat(t.toFixed(i))}return Math.round(t/e)*e}var ji=(function(){function t(e,i){Pi(this,t),Y.element(e)?this.element=e:Y.string(e)&&(this.element=document.querySelector(e)),Y.element(this.element)&&Y.empty(this.element.rangeTouch)&&(this.config=St({},Et,{},i),this.init())}return Mi(t,[{key:"init",value:function(){t.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){t.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var i=this,s=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(n){i.element[s](n,(function(r){return i.set(r)}),!1)}))}},{key:"get",value:function(e){if(!t.enabled||!Y.event(e))return null;var i,s=e.target,n=e.changedTouches[0],r=parseFloat(s.getAttribute("min"))||0,a=parseFloat(s.getAttribute("max"))||100,o=parseFloat(s.getAttribute("step"))||1,c=s.getBoundingClientRect(),u=100/c.width*(this.config.thumbWidth/2)/100;return 0>(i=100/c.width*(n.clientX-c.left))?i=0:100<i&&(i=100),50>i?i-=(100-2*i)*u:50<i&&(i+=2*(i-50)*u),r+Hi(i/100*(a-r),o)}},{key:"set",value:function(e){t.enabled&&Y.event(e)&&!e.target.disabled&&(e.preventDefault(),e.target.value=this.get(e),Li(e.target,e.type==="touchend"?"change":"input"))}}],[{key:"setup",value:function(e){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},s=null;if(Y.empty(e)||Y.string(e)?s=Array.from(document.querySelectorAll(Y.string(e)?e:'input[type="range"]')):Y.element(e)?s=[e]:Y.nodeList(e)?s=Array.from(e):Y.array(e)&&(s=e.filter(Y.element)),Y.empty(s))return null;var n=St({},Et,{},i);if(Y.string(e)&&n.watch){var r=new MutationObserver((function(a){Array.from(a).forEach((function(o){Array.from(o.addedNodes).forEach((function(c){Y.element(c)&&xi(c,e)&&new t(c,n)}))}))}));r.observe(document.body,{childList:!0,subtree:!0})}return s.map((function(a){return new t(a,i)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),t})();const Ce=t=>t!==null&&typeof t<"u"?t.constructor:null,ne=(t,e)=>!!(t&&e&&t instanceof e),ct=t=>t===null||typeof t>"u",Ut=t=>Ce(t)===Object,Wi=t=>Ce(t)===Number&&!Number.isNaN(t),$e=t=>Ce(t)===String,Bi=t=>Ce(t)===Boolean,zt=t=>typeof t=="function",Kt=t=>Array.isArray(t),qi=t=>ne(t,WeakMap),Xt=t=>ne(t,NodeList),Fi=t=>Ce(t)===Text,Vi=t=>ne(t,Event),Ui=t=>ne(t,KeyboardEvent),zi=t=>ne(t,window.TextTrackCue)||ne(t,window.VTTCue),Ki=t=>ne(t,TextTrack)||!ct(t)&&$e(t.kind),Xi=t=>ne(t,Promise)&&zt(t.then);function Yi(t){return t!==null&&typeof t=="object"&&t.nodeType===1&&typeof t.style=="object"&&typeof t.ownerDocument=="object"}function Yt(t){return ct(t)||($e(t)||Kt(t)||Xt(t))&&!t.length||Ut(t)&&!Object.keys(t).length}function Gi(t){if(ne(t,window.URL))return!0;if(!$e(t))return!1;let e=t;(!t.startsWith("http://")||!t.startsWith("https://"))&&(e=`http://${t}`);try{return!Yt(new URL(e).hostname)}catch{return!1}}const l={nullOrUndefined:ct,object:Ut,number:Wi,string:$e,boolean:Bi,function:zt,array:Kt,weakMap:qi,nodeList:Xt,element:Yi,textNode:Fi,event:Vi,keyboardEvent:Ui,cue:zi,track:Ki,promise:Xi,url:Gi,empty:Yt},Qe=(()=>{const t=document.createElement("span"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},i=Object.keys(e).find(s=>t.style[s]!==void 0);return l.string(i)?e[i]:!1})();function Gt(t,e){setTimeout(()=>{try{t.hidden=!0,t.offsetHeight,t.hidden=!1}catch{}},e)}function Qi(t){return JSON.parse(JSON.stringify(t))}function Qt(t,e){return e.split(".").reduce((i,s)=>i&&i[s],t)}function W(t={},...e){if(!e.length)return t;const i=e.shift();return l.object(i)?(Object.keys(i).forEach(s=>{l.object(i[s])?(Object.keys(t).includes(s)||Object.assign(t,{[s]:{}}),W(t[s],i[s])):Object.assign(t,{[s]:i[s]})}),W(t,...e)):t}function Jt(t,e){const i=t.length?t:[t];Array.from(i).reverse().forEach((s,n)=>{const r=n>0?e.cloneNode(!0):e,a=s.parentNode,o=s.nextSibling;r.appendChild(s),o?a.insertBefore(r,o):a.appendChild(r)})}function Je(t,e){!l.element(t)||l.empty(e)||Object.entries(e).filter(([,i])=>!l.nullOrUndefined(i)).forEach(([i,s])=>t.setAttribute(i,s))}function S(t,e,i){const s=document.createElement(t);return l.object(e)&&Je(s,e),l.string(i)&&(s.textContent=i),s}function Ji(t,e){!l.element(t)||!l.element(e)||e.parentNode.insertBefore(t,e.nextSibling)}function Pt(t,e,i,s){l.element(e)&&e.appendChild(S(t,i,s))}function se(t){if(l.nodeList(t)||l.array(t)){Array.from(t).forEach(se);return}!l.element(t)||!l.element(t.parentNode)||t.parentNode.removeChild(t)}function xe(t){if(!l.element(t))return;let{length:e}=t.childNodes;for(;e>0;)t.removeChild(t.lastChild),e-=1}function Re(t,e){return!l.element(e)||!l.element(e.parentNode)||!l.element(t)?null:(e.parentNode.replaceChild(t,e),t)}function ee(t,e){if(!l.string(t)||l.empty(t))return{};const i={},s=W({},e);return t.split(",").forEach(n=>{const r=n.trim(),a=r.replace(".",""),c=r.replace(/[[\]]/g,"").split("="),[u]=c,h=c.length>1?c[1].replace(/["']/g,""):"";switch(r.charAt(0)){case".":l.string(s.class)?i.class=`${s.class} ${a}`:i.class=a;break;case"#":i.id=r.replace("#","");break;case"[":i[u]=h;break}}),W(s,i)}function he(t,e){if(!l.element(t))return;let i=e;l.boolean(i)||(i=!t.hidden),t.hidden=i}function O(t,e,i){if(l.nodeList(t))return Array.from(t).map(s=>O(s,e,i));if(l.element(t)){let s="toggle";return typeof i<"u"&&(s=i?"add":"remove"),t.classList[s](e),t.classList.contains(e)}return!1}function _e(t,e){return l.element(t)&&t.classList.contains(e)}function me(t,e){const{prototype:i}=Element;function s(){return Array.from(document.querySelectorAll(e)).includes(this)}return(i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||s).call(t,e)}function Zi(t,e){const{prototype:i}=Element;function s(){let r=this;do{if(me.matches(r,e))return r;r=r.parentElement||r.parentNode}while(r!==null&&r.nodeType===1);return null}return(i.closest||s).call(t,e)}function ye(t){return this.elements.container.querySelectorAll(t)}function V(t){return this.elements.container.querySelector(t)}function Ve(t=null,e=!1){l.element(t)&&t.focus({preventScroll:!0,focusVisible:e})}const Mt={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},q={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(t,e){const i=q[t]||e!=="html5",s=i&&q.rangeInput;return{api:i,ui:s}},pip:document.pictureInPictureEnabled&&!S("video").disablePictureInPicture,airplay:l.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(t){if(l.empty(t))return!1;const[e]=t.split("/");let i=t;if(!this.isHTML5||e!==this.type)return!1;Object.keys(Mt).includes(i)&&(i+=`; codecs="${Mt[t]}"`);try{return!!(i&&this.media.canPlayType(i).replace(/no/,""))}catch{return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const t=document.createElement("input");return t.type="range",t.type==="range"})(),touch:"ontouchstart"in document.documentElement,transitions:Qe!==!1,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},es=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get(){return t=!0,null}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return t})();function ve(t,e,i,s=!1,n=!0,r=!1){if(!t||!("addEventListener"in t)||l.empty(e)||!l.function(i))return;const a=e.split(" ");let o=r;es&&(o={passive:n,capture:r}),a.forEach(c=>{this&&this.eventListeners&&s&&this.eventListeners.push({element:t,type:c,callback:i,options:o}),t[s?"addEventListener":"removeEventListener"](c,i,o)})}function R(t,e="",i,s=!0,n=!1){ve.call(this,t,e,i,!0,s,n)}function He(t,e="",i,s=!0,n=!1){ve.call(this,t,e,i,!1,s,n)}function ut(t,e="",i,s=!0,n=!1){const r=(...a)=>{He(t,e,r,s,n),i.apply(this,a)};ve.call(this,t,e,r,!0,s,n)}function E(t,e="",i=!1,s={}){if(!l.element(t)||l.empty(e))return;const n=new CustomEvent(e,{bubbles:i,detail:{...s,plyr:this}});t.dispatchEvent(n)}function ts(){this&&this.eventListeners&&(this.eventListeners.forEach(t=>{const{element:e,type:i,callback:s,options:n}=t;e.removeEventListener(i,s,n)}),this.eventListeners=[])}function is(){return new Promise(t=>this.ready?setTimeout(t,0):R.call(this,this.elements.container,"ready",t)).then(()=>{})}function te(t){l.promise(t)&&t.then(null,()=>{})}function Ze(t){return l.array(t)?t.filter((e,i)=>t.indexOf(e)===i):t}function Zt(t,e){return!l.array(t)||!t.length?null:t.reduce((i,s)=>Math.abs(s-e)<Math.abs(i-e)?s:i)}function ei(t){return!window||!window.CSS?!1:window.CSS.supports(t)}const At=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce((t,[e,i])=>({...t,[e/i]:[e,i]}),{});function ti(t){return!l.array(t)&&(!l.string(t)||!t.includes(":"))?!1:(l.array(t)?t:t.split(":")).map(Number).every(l.number)}function Ie(t){if(!l.array(t)||!t.every(l.number))return null;const[e,i]=t,s=(r,a)=>a===0?r:s(a,r%a),n=s(e,i);return[e/n,i/n]}function ht(t){const e=s=>ti(s)?s.split(":").map(Number):null;let i=e(t);if(i===null&&(i=e(this.config.ratio)),i===null&&!l.empty(this.embed)&&l.array(this.embed.ratio)&&({ratio:i}=this.embed),i===null&&this.isHTML5){const{videoWidth:s,videoHeight:n}=this.media;i=[s,n]}return Ie(i)}function pe(t){if(!this.isVideo)return{};const{wrapper:e}=this.elements,i=ht.call(this,t);if(!l.array(i))return{};const[s,n]=Ie(i),r=ei(`aspect-ratio: ${s}/${n}`),a=100/s*n;if(r?e.style.aspectRatio=`${s}/${n}`:e.style.paddingBottom=`${a}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const o=100/this.media.offsetWidth*Number.parseInt(window.getComputedStyle(this.media).paddingBottom,10),c=(o-a)/(o/50);this.fullscreen.active?e.style.paddingBottom=null:this.media.style.transform=`translateY(-${c}%)`}else this.isHTML5&&e.classList.add(this.config.classNames.videoFixedRatio);return{padding:a,ratio:i}}function ii(t,e,i=.05){const s=t/e,n=Zt(Object.keys(At),s);return Math.abs(n-s)<=i?At[n]:[t,e]}function ss(){const t=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);return[t,e]}const le={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter(e=>{const i=e.getAttribute("type");return l.empty(i)?!0:q.mime.call(this,i)}):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:le.getSources.call(this).map(t=>Number(t.getAttribute("size"))).filter(Boolean)},setup(){if(!this.isHTML5)return;const t=this;t.options.speed=t.config.speed.options,l.empty(this.config.ratio)||pe.call(t),Object.defineProperty(t.media,"quality",{get(){const i=le.getSources.call(t).find(s=>s.getAttribute("src")===t.source);return i&&Number(i.getAttribute("size"))},set(e){if(t.quality!==e){if(t.config.quality.forced&&l.function(t.config.quality.onChange))t.config.quality.onChange(e);else{const s=le.getSources.call(t).find(u=>Number(u.getAttribute("size"))===e);if(!s)return;const{currentTime:n,paused:r,preload:a,readyState:o,playbackRate:c}=t.media;t.media.src=s.getAttribute("src"),(a!=="none"||o)&&(t.once("loadedmetadata",()=>{t.speed=c,t.currentTime=n,r||te(t.play())}),t.media.load())}E.call(t,t.media,"qualitychange",!1,{quality:e})}}})},cancelRequests(){this.isHTML5&&(se(le.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}},ns=!!window.document.documentMode,rs=/Edge/.test(navigator.userAgent),as="WebkitAppearance"in document.documentElement.style&&!/Edge/.test(navigator.userAgent),os=navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,ls=/iPad|iPhone|iPod/i.test(navigator.userAgent)&&navigator.maxTouchPoints>1,K={isIE:ns,isEdge:rs,isWebKit:as,isIPadOS:os,isIos:ls};function cs(t){return`${t}-${Math.floor(Math.random()*1e4)}`}function et(t,...e){return l.empty(t)?t:t.toString().replace(/\{(\d+)\}/g,(i,s)=>e[s].toString())}function us(t,e){return t===0||e===0||Number.isNaN(t)||Number.isNaN(e)?0:(t/e*100).toFixed(2)}function be(t="",e="",i=""){return t.replace(new RegExp(e.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),i.toString())}function si(t=""){return t.toString().replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())}function hs(t=""){let e=t.toString();return e=be(e,"-"," "),e=be(e,"_"," "),e=si(e),be(e," ","")}function ds(t=""){let e=t.toString();return e=hs(e),e.charAt(0).toLowerCase()+e.slice(1)}function ms(t){const e=document.createDocumentFragment(),i=document.createElement("div");return e.appendChild(i),i.innerHTML=t,e.firstChild.textContent}function ps(t){const e=document.createElement("div");return e.appendChild(t),e.innerHTML}const xt={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},U={get(t="",e={}){if(l.empty(t)||l.empty(e))return"";let i=Qt(e.i18n,t);if(l.empty(i))return Object.keys(xt).includes(t)?xt[t]:"";const s={"{seektime}":e.seekTime,"{title}":e.title};return Object.entries(s).forEach(([n,r])=>{i=be(i,n,r)}),i}};class we{constructor(e){this.enabled=e.config.storage.enabled,this.key=e.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}get=e=>{if(!we.supported||!this.enabled)return null;const i=window.localStorage.getItem(this.key);if(l.empty(i))return null;const s=JSON.parse(i);return l.string(e)&&e.length?s[e]:s};set=e=>{if(!we.supported||!this.enabled||!l.object(e))return;let i=this.get();l.empty(i)&&(i={}),W(i,e);try{window.localStorage.setItem(this.key,JSON.stringify(i))}catch{}}}function Se(t,e="text",i=!1){return new Promise((s,n)=>{try{const r=new XMLHttpRequest;if(!("withCredentials"in r))return;i&&(r.withCredentials=!0),r.addEventListener("load",()=>{if(e==="text")try{s(JSON.parse(r.responseText))}catch{s(r.responseText)}else s(r.response)}),r.addEventListener("error",()=>{throw new Error(r.status)}),r.open("GET",t,!0),r.responseType=e,r.send()}catch(r){n(r)}})}function ni(t,e){if(!l.string(t))return;const i="cache",s=l.string(e);let n=!1;const r=()=>document.getElementById(e)!==null,a=(o,c)=>{o.innerHTML=c,!(s&&r())&&document.body.insertAdjacentElement("afterbegin",o)};if(!s||!r()){const o=we.supported,c=document.createElement("div");if(c.setAttribute("hidden",""),s&&c.setAttribute("id",e),o){const u=window.localStorage.getItem(`${i}-${e}`);if(n=u!==null,n){const h=JSON.parse(u);a(c,h.content)}}Se(t).then(u=>{if(!l.empty(u)){if(o)try{window.localStorage.setItem(`${i}-${e}`,JSON.stringify({content:u}))}catch{}a(c,u)}}).catch(()=>{})}}const ri=t=>Math.trunc(t/60/60%60,10),fs=t=>Math.trunc(t/60%60,10),gs=t=>Math.trunc(t%60,10);function je(t=0,e=!1,i=!1){if(!l.number(t))return je(void 0,e,i);const s=o=>`0${o}`.slice(-2);let n=ri(t);const r=fs(t),a=gs(t);return e||n>0?n=`${n}:`:n="",`${i&&t>0?"-":""}${n}${s(r)}:${s(a)}`}const b={getIconUrl(){const t=new URL(this.config.iconUrl,window.location),e=window.location.host?window.location.host:window.top.location.host,i=t.host!==e||K.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:i}},findElements(){try{return this.elements.controls=V.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:ye.call(this,this.config.selectors.buttons.play),pause:V.call(this,this.config.selectors.buttons.pause),restart:V.call(this,this.config.selectors.buttons.restart),rewind:V.call(this,this.config.selectors.buttons.rewind),fastForward:V.call(this,this.config.selectors.buttons.fastForward),mute:V.call(this,this.config.selectors.buttons.mute),pip:V.call(this,this.config.selectors.buttons.pip),airplay:V.call(this,this.config.selectors.buttons.airplay),settings:V.call(this,this.config.selectors.buttons.settings),captions:V.call(this,this.config.selectors.buttons.captions),fullscreen:V.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=V.call(this,this.config.selectors.progress),this.elements.inputs={seek:V.call(this,this.config.selectors.inputs.seek),volume:V.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:V.call(this,this.config.selectors.display.buffer),currentTime:V.call(this,this.config.selectors.display.currentTime),duration:V.call(this,this.config.selectors.display.duration)},l.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(t){return this.debug.warn("It looks like there is a problem with your custom controls HTML",t),this.toggleNativeControls(!0),!1}},createIcon(t,e){const i="http://www.w3.org/2000/svg",s=b.getIconUrl.call(this),n=`${s.cors?"":s.url}#${this.config.iconPrefix}`,r=document.createElementNS(i,"svg");Je(r,W(e,{"aria-hidden":"true",focusable:"false"}));const a=document.createElementNS(i,"use"),o=`${n}-${t}`;return"href"in a&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",o),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),r.appendChild(a),r},createLabel(t,e={}){const i=U.get(t,this.config),s={...e,class:[e.class,this.config.classNames.hidden].filter(Boolean).join(" ")};return S("span",s,i)},createBadge(t){if(l.empty(t))return null;const e=S("span",{class:this.config.classNames.menu.value});return e.appendChild(S("span",{class:this.config.classNames.menu.badge},t)),e},createButton(t,e){const i=W({},e);let s=ds(t);const n={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach(a=>{Object.keys(i).includes(a)&&(n[a]=i[a],delete i[a])}),n.element==="button"&&!Object.keys(i).includes("type")&&(i.type="button"),Object.keys(i).includes("class")?i.class.split(" ").includes(this.config.classNames.control)||W(i,{class:`${i.class} ${this.config.classNames.control}`}):i.class=this.config.classNames.control,t){case"play":n.toggle=!0,n.label="play",n.labelPressed="pause",n.icon="play",n.iconPressed="pause";break;case"mute":n.toggle=!0,n.label="mute",n.labelPressed="unmute",n.icon="volume",n.iconPressed="muted";break;case"captions":n.toggle=!0,n.label="enableCaptions",n.labelPressed="disableCaptions",n.icon="captions-off",n.iconPressed="captions-on";break;case"fullscreen":n.toggle=!0,n.label="enterFullscreen",n.labelPressed="exitFullscreen",n.icon="enter-fullscreen",n.iconPressed="exit-fullscreen";break;case"play-large":i.class+=` ${this.config.classNames.control}--overlaid`,s="play",n.label="play",n.icon="play";break;default:l.empty(n.label)&&(n.label=s),l.empty(n.icon)&&(n.icon=t)}const r=S(n.element);return n.toggle?(r.appendChild(b.createIcon.call(this,n.iconPressed,{class:"icon--pressed"})),r.appendChild(b.createIcon.call(this,n.icon,{class:"icon--not-pressed"})),r.appendChild(b.createLabel.call(this,n.labelPressed,{class:"label--pressed"})),r.appendChild(b.createLabel.call(this,n.label,{class:"label--not-pressed"}))):(r.appendChild(b.createIcon.call(this,n.icon)),r.appendChild(b.createLabel.call(this,n.label))),W(i,ee(this.config.selectors.buttons[s],i)),Je(r,i),s==="play"?(l.array(this.elements.buttons[s])||(this.elements.buttons[s]=[]),this.elements.buttons[s].push(r)):this.elements.buttons[s]=r,r},createRange(t,e){const i=S("input",W(ee(this.config.selectors.inputs[t]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":U.get(t,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},e));return this.elements.inputs[t]=i,b.updateRangeFill.call(this,i),ji.setup(i),i},createProgress(t,e){const i=S("progress",W(ee(this.config.selectors.display[t]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},e));if(t!=="volume"){i.appendChild(S("span",null,"0"));const s={played:"played",buffer:"buffered"}[t],n=s?U.get(s,this.config):"";i.textContent=`% ${n.toLowerCase()}`}return this.elements.display[t]=i,i},createTime(t,e){const i=ee(this.config.selectors.display[t],e),s=S("div",W(i,{class:`${i.class?i.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":U.get(t,this.config),role:"timer"}),"00:00");return this.elements.display[t]=s,s},bindMenuItemShortcuts(t,e){R.call(this,t,"keydown keyup",i=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(i.key)||(i.preventDefault(),i.stopPropagation(),i.type==="keydown"))return;const s=me(t,'[role="menuitemradio"]');if(!s&&[" ","ArrowRight"].includes(i.key))b.showMenuPanel.call(this,e,!0);else{let n;i.key!==" "&&(i.key==="ArrowDown"||s&&i.key==="ArrowRight"?(n=t.nextElementSibling,l.element(n)||(n=t.parentNode.firstElementChild)):(n=t.previousElementSibling,l.element(n)||(n=t.parentNode.lastElementChild)),Ve.call(this,n,!0))}},!1),R.call(this,t,"keyup",i=>{i.key==="Return"&&b.focusFirstMenuItem.call(this,null,!0)})},createMenuItem({value:t,list:e,type:i,title:s,badge:n=null,checked:r=!1}){const a=ee(this.config.selectors.inputs[i]),o=S("button",W(a,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${a.class?a.class:""}`.trim(),"aria-checked":r,value:t})),c=S("span");c.innerHTML=s,l.element(n)&&c.appendChild(n),o.appendChild(c),Object.defineProperty(o,"checked",{enumerable:!0,get(){return o.getAttribute("aria-checked")==="true"},set(u){u&&Array.from(o.parentNode.children).filter(h=>me(h,'[role="menuitemradio"]')).forEach(h=>h.setAttribute("aria-checked","false")),o.setAttribute("aria-checked",u?"true":"false")}}),this.listeners.bind(o,"click keyup",u=>{if(!(l.keyboardEvent(u)&&u.key!==" ")){switch(u.preventDefault(),u.stopPropagation(),o.checked=!0,i){case"language":this.currentTrack=Number(t);break;case"quality":this.quality=t;break;case"speed":this.speed=Number.parseFloat(t);break}b.showMenuPanel.call(this,"home",l.keyboardEvent(u))}},i,!1),b.bindMenuItemShortcuts.call(this,o,i),e.appendChild(o)},formatTime(t=0,e=!1){if(!l.number(t))return t;const i=ri(this.duration)>0;return je(t,i,e)},updateTimeDisplay(t=null,e=0,i=!1){!l.element(t)||!l.number(e)||(t.textContent=b.formatTime(e,i))},updateVolume(){this.supported.ui&&(l.element(this.elements.inputs.volume)&&b.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),l.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||this.volume===0))},setRange(t,e=0){l.element(t)&&(t.value=e,b.updateRangeFill.call(this,t))},updateProgress(t){if(!this.supported.ui||!l.event(t))return;let e=0;const i=(s,n)=>{const r=l.number(n)?n:0,a=l.element(s)?s:this.elements.display.buffer;if(l.element(a)){a.value=r;const o=a.getElementsByTagName("span")[0];l.element(o)&&(o.childNodes[0].nodeValue=r)}};if(t)switch(t.type){case"timeupdate":case"seeking":case"seeked":e=us(this.currentTime,this.duration),t.type==="timeupdate"&&b.setRange.call(this,this.elements.inputs.seek,e);break;case"playing":case"progress":i(this.elements.display.buffer,this.buffered*100);break}},updateRangeFill(t){const e=l.event(t)?t.target:t;if(!(!l.element(e)||e.getAttribute("type")!=="range")){if(me(e,this.config.selectors.inputs.seek)){e.setAttribute("aria-valuenow",this.currentTime);const i=b.formatTime(this.currentTime),s=b.formatTime(this.duration),n=U.get("seekLabel",this.config);e.setAttribute("aria-valuetext",n.replace("{currentTime}",i).replace("{duration}",s))}else if(me(e,this.config.selectors.inputs.volume)){const i=e.value*100;e.setAttribute("aria-valuenow",i),e.setAttribute("aria-valuetext",`${i.toFixed(1)}%`)}else e.setAttribute("aria-valuenow",e.value);!K.isWebKit&&!K.isIPadOS||e.style.setProperty("--value",`${e.value/e.max*100}%`)}},updateSeekTooltip(t){if(!this.config.tooltips.seek||!l.element(this.elements.inputs.seek)||!l.element(this.elements.display.seekTooltip)||this.duration===0)return;const e=this.elements.display.seekTooltip,i=`${this.config.classNames.tooltip}--visible`,s=c=>O(e,i,c);if(this.touch){s(!1);return}let n=0;const r=this.elements.progress.getBoundingClientRect();if(l.event(t)){const c=t.pageX-t.clientX;n=100/r.width*(t.pageX-r.left-c)}else if(_e(e,i))n=Number.parseFloat(e.style.left,10);else return;n<0?n=0:n>100&&(n=100);const a=this.duration/100*n;e.textContent=b.formatTime(a);const o=this.config.markers?.points?.find(({time:c})=>c===Math.round(a));o&&e.insertAdjacentHTML("afterbegin",`${o.label}<br>`),e.style.left=`${n}%`,l.event(t)&&["mouseenter","mouseleave"].includes(t.type)&&s(t.type==="mouseenter")},timeUpdate(t){const e=!l.element(this.elements.display.duration)&&this.config.invertTime;b.updateTimeDisplay.call(this,this.elements.display.currentTime,e?this.duration-this.currentTime:this.currentTime,e),!(t&&t.type==="timeupdate"&&this.media.seeking)&&b.updateProgress.call(this,t)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32){he(this.elements.display.currentTime,!0),he(this.elements.progress,!0);return}l.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const t=l.element(this.elements.display.duration);!t&&this.config.displayDuration&&this.paused&&b.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),t&&b.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&b.setMarkers.call(this),b.updateSeekTooltip.call(this)},toggleMenuButton(t,e){he(this.elements.settings.buttons[t],!e)},updateSetting(t,e,i){const s=this.elements.settings.panels[t];let n=null,r=e;if(t==="captions")n=this.currentTrack;else{if(n=l.empty(i)?this[t]:i,l.empty(n)&&(n=this.config[t].default),!l.empty(this.options[t])&&!this.options[t].includes(n)){this.debug.warn(`Unsupported value of '${n}' for ${t}`);return}if(!this.config[t].options.includes(n)){this.debug.warn(`Disabled value of '${n}' for ${t}`);return}}if(l.element(r)||(r=s&&s.querySelector('[role="menu"]')),!l.element(r))return;const a=this.elements.settings.buttons[t].querySelector(`.${this.config.classNames.menu.value}`);a.innerHTML=b.getLabel.call(this,t,n);const o=r&&r.querySelector(`[value="${n}"]`);l.element(o)&&(o.checked=!0)},getLabel(t,e){switch(t){case"speed":return e===1?U.get("normal",this.config):`${e}&times;`;case"quality":if(l.number(e)){const i=U.get(`qualityLabel.${e}`,this.config);return i.length?i:`${e}p`}return si(e);case"captions":return _.getLabel.call(this);default:return null}},setQualityMenu(t){if(!l.element(this.elements.settings.panels.quality))return;const e="quality",i=this.elements.settings.panels.quality.querySelector('[role="menu"]');l.array(t)&&(this.options.quality=Ze(t).filter(r=>this.config.quality.options.includes(r)));const s=!l.empty(this.options.quality)&&this.options.quality.length>1;if(b.toggleMenuButton.call(this,e,s),xe(i),b.checkMenu.call(this),!s)return;const n=r=>{const a=U.get(`qualityBadge.${r}`,this.config);return a.length?b.createBadge.call(this,a):null};this.options.quality.sort((r,a)=>{const o=this.config.quality.options;return o.indexOf(r)>o.indexOf(a)?1:-1}).forEach(r=>{b.createMenuItem.call(this,{value:r,list:i,type:e,title:b.getLabel.call(this,"quality",r),badge:n(r)})}),b.updateSetting.call(this,e,i)},setCaptionsMenu(){if(!l.element(this.elements.settings.panels.captions))return;const t="captions",e=this.elements.settings.panels.captions.querySelector('[role="menu"]'),i=_.getTracks.call(this),s=!!i.length;if(b.toggleMenuButton.call(this,t,s),xe(e),b.checkMenu.call(this),!s)return;const n=i.map((r,a)=>({value:a,checked:this.captions.toggled&&this.currentTrack===a,title:_.getLabel.call(this,r),badge:r.language&&b.createBadge.call(this,r.language.toUpperCase()),list:e,type:"language"}));n.unshift({value:-1,checked:!this.captions.toggled,title:U.get("disabled",this.config),list:e,type:"language"}),n.forEach(b.createMenuItem.bind(this)),b.updateSetting.call(this,t,e)},setSpeedMenu(){if(!l.element(this.elements.settings.panels.speed))return;const t="speed",e=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter(s=>s>=this.minimumSpeed&&s<=this.maximumSpeed);const i=!l.empty(this.options.speed)&&this.options.speed.length>1;b.toggleMenuButton.call(this,t,i),xe(e),b.checkMenu.call(this),i&&(this.options.speed.forEach(s=>{b.createMenuItem.call(this,{value:s,list:e,type:t,title:b.getLabel.call(this,"speed",s)})}),b.updateSetting.call(this,t,e))},checkMenu(){const{buttons:t}=this.elements.settings,e=!l.empty(t)&&Object.values(t).some(i=>!i.hidden);he(this.elements.settings.menu,!e)},focusFirstMenuItem(t,e=!1){if(this.elements.settings.popup.hidden)return;let i=t;l.element(i)||(i=Object.values(this.elements.settings.panels).find(n=>!n.hidden));const s=i.querySelector('[role^="menuitem"]');Ve.call(this,s,e)},toggleMenu(t){const{popup:e}=this.elements.settings,i=this.elements.buttons.settings;if(!l.element(e)||!l.element(i))return;const{hidden:s}=e;let n=s;if(l.boolean(t))n=t;else if(l.keyboardEvent(t)&&t.key==="Escape")n=!1;else if(l.event(t)){const r=l.function(t.composedPath)?t.composedPath()[0]:t.target,a=e.contains(r);if(a||!a&&t.target!==i&&n)return}i.setAttribute("aria-expanded",n),he(e,!n),O(this.elements.container,this.config.classNames.menu.open,n),n&&l.keyboardEvent(t)?b.focusFirstMenuItem.call(this,null,!0):!n&&!s&&Ve.call(this,i,l.keyboardEvent(t))},getMenuSize(t){const e=t.cloneNode(!0);e.style.position="absolute",e.style.opacity=0,e.removeAttribute("hidden"),t.parentNode.appendChild(e);const i=e.scrollWidth,s=e.scrollHeight;return se(e),{width:i,height:s}},showMenuPanel(t="",e=!1){const i=this.elements.container.querySelector(`#plyr-settings-${this.id}-${t}`);if(!l.element(i))return;const s=i.parentNode,n=Array.from(s.children).find(r=>!r.hidden);if(q.transitions&&!q.reducedMotion){s.style.width=`${n.scrollWidth}px`,s.style.height=`${n.scrollHeight}px`;const r=b.getMenuSize.call(this,i),a=o=>{o.target!==s||!["width","height"].includes(o.propertyName)||(s.style.width="",s.style.height="",He.call(this,s,Qe,a))};R.call(this,s,Qe,a),s.style.width=`${r.width}px`,s.style.height=`${r.height}px`}he(n,!0),he(i,!1),b.focusFirstMenuItem.call(this,i,e)},setDownloadUrl(){const t=this.elements.buttons.download;l.element(t)&&t.setAttribute("href",this.download)},create(t){const{bindMenuItemShortcuts:e,createButton:i,createProgress:s,createRange:n,createTime:r,setQualityMenu:a,setSpeedMenu:o,showMenuPanel:c}=b;this.elements.controls=null,l.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(i.call(this,"play-large"));const u=S("div",ee(this.config.selectors.controls.wrapper));this.elements.controls=u;const h={class:"plyr__controls__item"};return Ze(l.array(this.config.controls)?this.config.controls:[]).forEach(m=>{if(m==="restart"&&u.appendChild(i.call(this,"restart",h)),m==="rewind"&&u.appendChild(i.call(this,"rewind",h)),m==="play"&&u.appendChild(i.call(this,"play",h)),m==="fast-forward"&&u.appendChild(i.call(this,"fast-forward",h)),m==="progress"){const d=S("div",{class:`${h.class} plyr__progress__container`}),f=S("div",ee(this.config.selectors.progress));if(f.appendChild(n.call(this,"seek",{id:`plyr-seek-${t.id}`})),f.appendChild(s.call(this,"buffer")),this.config.tooltips.seek){const p=S("span",{class:this.config.classNames.tooltip},"00:00");f.appendChild(p),this.elements.display.seekTooltip=p}this.elements.progress=f,d.appendChild(this.elements.progress),u.appendChild(d)}if(m==="current-time"&&u.appendChild(r.call(this,"currentTime",h)),m==="duration"&&u.appendChild(r.call(this,"duration",h)),m==="mute"||m==="volume"){let{volume:d}=this.elements;if((!l.element(d)||!u.contains(d))&&(d=S("div",W({},h,{class:`${h.class} plyr__volume`.trim()})),this.elements.volume=d,u.appendChild(d)),m==="mute"&&d.appendChild(i.call(this,"mute")),m==="volume"&&!K.isIos&&!K.isIPadOS){const f={max:1,step:.05,value:this.config.volume};d.appendChild(n.call(this,"volume",W(f,{id:`plyr-volume-${t.id}`})))}}if(m==="captions"&&u.appendChild(i.call(this,"captions",h)),m==="settings"&&!l.empty(this.config.settings)){const d=S("div",W({},h,{class:`${h.class} plyr__menu`.trim(),hidden:""}));d.appendChild(i.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${t.id}`,"aria-expanded":!1}));const f=S("div",{class:"plyr__menu__container",id:`plyr-settings-${t.id}`,hidden:""}),p=S("div"),y=S("div",{id:`plyr-settings-${t.id}-home`}),w=S("div",{role:"menu"});y.appendChild(w),p.appendChild(y),this.elements.settings.panels.home=y,this.config.settings.forEach(C=>{const g=S("button",W(ee(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));e.call(this,g,C),R.call(this,g,"click",()=>{c.call(this,C,!1)});const k=S("span",null,U.get(C,this.config)),T=S("span",{class:this.config.classNames.menu.value});T.innerHTML=t[C],k.appendChild(T),g.appendChild(k),w.appendChild(g);const M=S("div",{id:`plyr-settings-${t.id}-${C}`,hidden:""}),P=S("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});P.appendChild(S("span",{"aria-hidden":!0},U.get(C,this.config))),P.appendChild(S("span",{class:this.config.classNames.hidden},U.get("menuBack",this.config))),R.call(this,M,"keydown",N=>{N.key==="ArrowLeft"&&(N.preventDefault(),N.stopPropagation(),c.call(this,"home",!0))},!1),R.call(this,P,"click",()=>{c.call(this,"home",!1)}),M.appendChild(P),M.appendChild(S("div",{role:"menu"})),p.appendChild(M),this.elements.settings.buttons[C]=g,this.elements.settings.panels[C]=M}),f.appendChild(p),d.appendChild(f),u.appendChild(d),this.elements.settings.popup=f,this.elements.settings.menu=d}if(m==="pip"&&q.pip&&u.appendChild(i.call(this,"pip",h)),m==="airplay"&&q.airplay&&u.appendChild(i.call(this,"airplay",h)),m==="download"){const d=W({},h,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(d.download="");const{download:f}=this.config.urls;!l.url(f)&&this.isEmbed&&W(d,{icon:`logo-${this.provider}`,label:this.provider}),u.appendChild(i.call(this,"download",d))}m==="fullscreen"&&u.appendChild(i.call(this,"fullscreen",h))}),this.isHTML5&&a.call(this,le.getQualityOptions.call(this)),o.call(this),u},inject(){if(this.config.loadSprite){const a=b.getIconUrl.call(this);a.cors&&ni(a.url,"sprite-plyr")}this.id=Math.floor(Math.random()*1e4);let t=null;this.elements.controls=null;const e={id:this.id,seektime:this.config.seekTime,title:this.config.title};let i=!0;l.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,e)),this.config.controls||(this.config.controls=[]),l.element(this.config.controls)||l.string(this.config.controls)?t=this.config.controls:(t=b.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:_.getLabel.call(this)}),i=!1);const s=a=>{let o=a;return Object.entries(e).forEach(([c,u])=>{o=be(o,`{${c}}`,u)}),o};i&&l.string(this.config.controls)&&(t=s(t));let n;l.string(this.config.selectors.controls.container)&&(n=document.querySelector(this.config.selectors.controls.container)),l.element(n)||(n=this.elements.container);const r=l.element(t)?"insertAdjacentElement":"insertAdjacentHTML";if(n[r]("afterbegin",t),l.element(this.elements.controls)||b.findElements.call(this),!l.empty(this.elements.buttons)){const a=o=>{const c=this.config.classNames.controlPressed;o.setAttribute("aria-pressed","false"),Object.defineProperty(o,"pressed",{configurable:!0,enumerable:!0,get(){return _e(o,c)},set(u=!1){O(o,c,u),o.setAttribute("aria-pressed",u?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach(o=>{l.array(o)||l.nodeList(o)?Array.from(o).filter(Boolean).forEach(a):a(o)})}if(K.isEdge&&Gt(n),this.config.tooltips.controls){const{classNames:a,selectors:o}=this.config,c=`${o.controls.wrapper} ${o.labels} .${a.hidden}`,u=ye.call(this,c);Array.from(u).forEach(h=>{O(h,this.config.classNames.hidden,!1),O(h,this.config.classNames.tooltip,!0)})}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch{}},setMarkers(){if(!this.duration||this.elements.markers)return;const t=this.config.markers?.points?.filter(({time:a})=>a>0&&a<this.duration);if(!t?.length)return;const e=document.createDocumentFragment(),i=document.createDocumentFragment();let s=null;const n=`${this.config.classNames.tooltip}--visible`,r=a=>O(s,n,a);t.forEach(a=>{const o=S("span",{class:this.config.classNames.marker},""),c=`${a.time/this.duration*100}%`;s&&(o.addEventListener("mouseenter",()=>{a.label||(s.style.left=c,s.innerHTML=a.label,r(!0))}),o.addEventListener("mouseleave",()=>{r(!1)})),o.addEventListener("click",()=>{this.currentTime=a.time}),o.style.left=c,i.appendChild(o)}),e.appendChild(i),this.config.tooltips.seek||(s=S("span",{class:this.config.classNames.tooltip},""),e.appendChild(s)),this.elements.markers={points:i,tip:s},this.elements.progress.appendChild(e)}};function ai(t,e=!0){let i=t;if(e){const s=document.createElement("a");s.href=i,i=s.href}try{return new URL(i)}catch{return null}}function oi(t){const e=new URLSearchParams;return l.object(t)&&Object.entries(t).forEach(([i,s])=>{e.set(i,s)}),e}const _={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!q.textTracks){l.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&b.setCaptionsMenu.call(this);return}if(l.element(this.elements.captions)||(this.elements.captions=S("div",ee(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),Ji(this.elements.captions,this.elements.wrapper)),K.isIE&&window.URL){const n=this.media.querySelectorAll("track");Array.from(n).forEach(r=>{const a=r.getAttribute("src"),o=ai(a);o!==null&&o.hostname!==window.location.href.hostname&&["http:","https:"].includes(o.protocol)&&Se(a,"blob").then(c=>{r.setAttribute("src",window.URL.createObjectURL(c))}).catch(()=>{se(r)})})}const t=navigator.languages||[navigator.language||navigator.userLanguage||"en"],e=Ze(t.map(n=>n.split("-")[0]));let i=(this.storage.get("language")||this.captions.language||this.config.captions.language||"auto").toLowerCase();i==="auto"&&([i]=e);let s=this.storage.get("captions")||this.captions.active;if(l.boolean(s)||({active:s}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:s,language:i,languages:e}),this.isHTML5){const n=this.config.captions.update?"addtrack removetrack":"removetrack";R.call(this,this.media.textTracks,n,_.update.bind(this))}setTimeout(_.update.bind(this),0)},update(){const t=_.getTracks.call(this,!0),{active:e,language:i,meta:s,currentTrackNode:n}=this.captions,r=!!t.find(a=>a.language===i);this.isHTML5&&this.isVideo&&t.filter(a=>!s.get(a)).forEach(a=>{this.debug.log("Track added",a),s.set(a,{default:a.mode==="showing"}),a.mode==="showing"&&(a.mode="hidden"),R.call(this,a,"cuechange",()=>_.updateCues.call(this))}),(r&&this.language!==i||!t.includes(n))&&(_.setLanguage.call(this,i),_.toggle.call(this,e&&r)),this.elements&&O(this.elements.container,this.config.classNames.captions.enabled,!l.empty(t)),l.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&b.setCaptionsMenu.call(this)},toggle(t,e=!0){if(!this.supported.ui)return;const{toggled:i}=this.captions,s=this.config.classNames.captions.active,n=l.nullOrUndefined(t)?!i:t;if(n!==i){if(e||(this.captions.active=n,this.storage.set({captions:n})),!this.language&&n&&!e){const r=_.getTracks.call(this),a=_.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);this.captions.language=a.language,_.set.call(this,r.indexOf(a));return}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=n),O(this.elements.container,s,n),this.captions.toggled=n,b.updateSetting.call(this,"captions"),E.call(this,this.media,n?"captionsenabled":"captionsdisabled")}setTimeout(()=>{n&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")})},set(t,e=!0){const i=_.getTracks.call(this);if(t===-1){_.toggle.call(this,!1,e);return}if(!l.number(t)){this.debug.warn("Invalid caption argument",t);return}if(!(t in i)){this.debug.warn("Track not found",t);return}if(this.captions.currentTrack!==t){this.captions.currentTrack=t;const s=i[t],{language:n}=s||{};this.captions.currentTrackNode=s,b.updateSetting.call(this,"captions"),e||(this.captions.language=n,this.storage.set({language:n})),this.isVimeo&&this.embed.enableTextTrack(n),E.call(this,this.media,"languagechange")}_.toggle.call(this,!0,e),this.isHTML5&&this.isVideo&&_.updateCues.call(this)},setLanguage(t,e=!0){if(!l.string(t)){this.debug.warn("Invalid language argument",t);return}const i=t.toLowerCase();this.captions.language=i;const s=_.getTracks.call(this),n=_.findTrack.call(this,[i]);_.set.call(this,s.indexOf(n),e)},getTracks(t=!1){return Array.from((this.media||{}).textTracks||[]).filter(i=>!this.isHTML5||t||this.captions.meta.has(i)).filter(i=>["captions","subtitles"].includes(i.kind))},findTrack(t,e=!1){const i=_.getTracks.call(this),s=a=>Number((this.captions.meta.get(a)||{}).default),n=Array.from(i).sort((a,o)=>s(o)-s(a));let r;return t.every(a=>(r=n.find(o=>o.language===a),!r)),r||(e?n[0]:void 0)},getCurrentTrack(){return _.getTracks.call(this)[this.currentTrack]},getLabel(t){let e=t;return!l.track(e)&&q.textTracks&&this.captions.toggled&&(e=_.getCurrentTrack.call(this)),l.track(e)?l.empty(e.label)?l.empty(e.language)?U.get("enabled",this.config):t.language.toUpperCase():e.label:U.get("disabled",this.config)},updateCues(t){if(!this.supported.ui)return;if(!l.element(this.elements.captions)){this.debug.warn("No captions element to render to");return}if(!l.nullOrUndefined(t)&&!Array.isArray(t)){this.debug.warn("updateCues: Invalid input",t);return}let e=t;if(!e){const n=_.getCurrentTrack.call(this);e=Array.from((n||{}).activeCues||[]).map(r=>r.getCueAsHTML()).map(ps)}const i=e.map(n=>n.trim()).join(`
`);if(i!==this.elements.captions.innerHTML){xe(this.elements.captions);const n=S("span",ee(this.config.selectors.caption));n.innerHTML=i,this.elements.captions.appendChild(n),E.call(this,this.media,"cuechange")}}},li={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.8.3/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:"",withCredentials:!1},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},Ue={active:"picture-in-picture",inactive:"inline"},ae={html5:"html5",youtube:"youtube",vimeo:"vimeo"},ze={audio:"audio",video:"video"};function bs(t){return/^(?:https?:\/\/)?(?:www\.)?(?:youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(t)?ae.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(t)?ae.vimeo:null}function Ke(){}class ys{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Ke}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Ke}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Ke}}class Z{constructor(e){this.player=e,this.prefix=Z.prefix,this.property=Z.property,this.scrollPosition={x:0,y:0},this.forceFallback=e.config.fullscreen.fallback==="force",this.player.elements.fullscreen=e.config.fullscreen.container&&Zi(this.player.elements.container,e.config.fullscreen.container),R.call(this.player,document,this.prefix==="ms"?"MSFullscreenChange":`${this.prefix}fullscreenchange`,()=>{this.onChange()}),R.call(this.player,this.player.elements.container,"dblclick",i=>{l.element(this.player.elements.controls)&&this.player.elements.controls.contains(i.target)||this.player.listeners.proxy(i,this.toggle,"fullscreen")}),R.call(this,this.player.elements.container,"keydown",i=>this.trapFocus(i)),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return Z.nativeSupported&&!this.forceFallback}static get prefix(){if(l.function(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some(s=>l.function(document[`${s}ExitFullscreen`])||l.function(document[`${s}CancelFullScreen`])?(e=s,!0):!1),e}static get property(){return this.prefix==="moz"?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,Z.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||Z.nativeSupported||!K.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!Z.nativeSupported||this.forceFallback)return _e(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return K.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}onChange=()=>{if(!this.supported)return;const e=this.player.elements.buttons.fullscreen;l.element(e)&&(e.pressed=this.active);const i=this.target===this.player.media?this.target:this.player.elements.container;E.call(this.player,i,this.active?"enterfullscreen":"exitfullscreen",!0)};toggleFallback=(e=!1)=>{if(e?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",O(this.target,this.player.config.classNames.fullscreen.fallback,e),K.isIos){let i=document.head.querySelector('meta[name="viewport"]');const s="viewport-fit=cover";i||(i=document.createElement("meta"),i.setAttribute("name","viewport"));const n=l.string(i.content)&&i.content.includes(s);e?(this.cleanupViewport=!n,n||(i.content+=`,${s}`)):this.cleanupViewport&&(i.content=i.content.split(",").filter(r=>r.trim()!==s).join(","))}this.onChange()};trapFocus=e=>{if(K.isIos||K.isIPadOS||!this.active||e.key!=="Tab")return;const i=document.activeElement,s=ye.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[n]=s,r=s[s.length-1];i===r&&!e.shiftKey?(n.focus(),e.preventDefault()):i===n&&e.shiftKey&&(r.focus(),e.preventDefault())};update=()=>{if(this.supported){let e;this.forceFallback?e="Fallback (forced)":Z.nativeSupported?e="Native":e="Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");O(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)};enter=()=>{this.supported&&(K.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Z.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?l.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))};exit=()=>{if(this.supported){if(K.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),te(this.player.play());else if(!Z.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(!this.prefix)(document.cancelFullScreen||document.exitFullscreen).call(document);else if(!l.empty(this.prefix)){const e=this.prefix==="moz"?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}};toggle=()=>{this.active?this.exit():this.enter()}}function Le(t,e=1){return new Promise((i,s)=>{const n=new Image,r=()=>{delete n.onload,delete n.onerror,(n.naturalWidth>=e?i:s)(n)};Object.assign(n,{onload:r,onerror:r,src:t})})}const $={addStyleHook(){O(this.elements.container,this.config.selectors.container.replace(".",""),!0),O(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(t=!1){t&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui){this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),$.toggleNativeControls.call(this,!0);return}l.element(this.elements.controls)||(b.inject.call(this),this.listeners.controls()),$.toggleNativeControls.call(this),this.isHTML5&&_.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,b.updateVolume.call(this),b.timeUpdate.call(this),b.durationUpdate.call(this),$.checkPlaying.call(this),O(this.elements.container,this.config.classNames.pip.supported,q.pip&&this.isHTML5&&this.isVideo),O(this.elements.container,this.config.classNames.airplay.supported,q.airplay&&this.isHTML5),O(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout(()=>{E.call(this,this.media,"ready")},0),$.setTitle.call(this),this.poster&&$.setPoster.call(this,this.poster,!1).catch(()=>{}),this.config.duration&&b.durationUpdate.call(this),this.config.mediaMetadata&&b.setMediaMetadata.call(this)},setTitle(){let t=U.get("play",this.config);if(l.string(this.config.title)&&!l.empty(this.config.title)&&(t+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach(e=>{e.setAttribute("aria-label",t)}),this.isEmbed){const e=V.call(this,"iframe");if(!l.element(e))return;const i=l.empty(this.config.title)?"video":this.config.title,s=U.get("frameTitle",this.config);e.setAttribute("title",s.replace("{title}",i))}},togglePoster(t){O(this.elements.container,this.config.classNames.posterEnabled,t)},setPoster(t,e=!0){return e&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",t),this.elements.poster.removeAttribute("hidden"),is.call(this).then(()=>Le(t)).catch(i=>{throw t===this.poster&&$.togglePoster.call(this,!1),i}).then(()=>{if(t!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")}).then(()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${t}')`,backgroundSize:""}),$.togglePoster.call(this,!0),t)))},checkPlaying(t){O(this.elements.container,this.config.classNames.playing,this.playing),O(this.elements.container,this.config.classNames.paused,this.paused),O(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach(e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",U.get(this.playing?"pause":"play",this.config))}),!(l.event(t)&&t.type==="timeupdate")&&$.toggleControls.call(this)},checkLoading(t){this.loading=["stalled","waiting"].includes(t.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout(()=>{O(this.elements.container,this.config.classNames.loading,this.loading),$.toggleControls.call(this)},this.loading?250:0)},toggleControls(t){const{controls:e}=this.elements;if(e&&this.config.hideControls){const i=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(!!(t||this.loading||this.paused||e.pressed||e.hover||i))}},migrateStyles(){Object.values({...this.media.style}).filter(t=>!l.empty(t)&&l.string(t)&&t.startsWith("--plyr")).forEach(t=>{this.elements.container.style.setProperty(t,this.media.style.getPropertyValue(t)),this.media.style.removeProperty(t)}),l.empty(this.media.style)&&this.media.removeAttribute("style")}};class vs{constructor(e){this.player=e,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:i}=this,{elements:s}=i,{key:n,type:r,altKey:a,ctrlKey:o,metaKey:c,shiftKey:u}=e,h=r==="keydown",m=h&&n===this.lastKey;if(a||o||c||u||!n)return;const d=f=>{i.currentTime=i.duration/10*f};if(h){const f=document.activeElement;if(l.element(f)){const{editable:y}=i.config.selectors,{seek:w}=s.inputs;if(f!==w&&me(f,y)||e.key===" "&&me(f,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(n)&&(e.preventDefault(),e.stopPropagation()),n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":m||d(Number.parseInt(n,10));break;case" ":case"k":m||te(i.togglePlay());break;case"ArrowUp":i.increaseVolume(.1);break;case"ArrowDown":i.decreaseVolume(.1);break;case"m":m||(i.muted=!i.muted);break;case"ArrowRight":i.forward();break;case"ArrowLeft":i.rewind();break;case"f":i.fullscreen.toggle();break;case"c":m||i.toggleCaptions();break;case"l":i.loop=!i.loop;break}n==="Escape"&&!i.fullscreen.usingNative&&i.fullscreen.active&&i.fullscreen.toggle(),this.lastKey=n}else this.lastKey=null}toggleMenu(e){b.toggleMenu.call(this.player,e)}firstTouch=()=>{const{player:e}=this,{elements:i}=e;e.touch=!0,O(i.container,e.config.classNames.isTouch,!0)};global=(e=!0)=>{const{player:i}=this;i.config.keyboard.global&&ve.call(i,window,"keydown keyup",this.handleKey,e,!1),ve.call(i,document.body,"click",this.toggleMenu,e),ut.call(i,document.body,"touchstart",this.firstTouch)};container=()=>{const{player:e}=this,{config:i,elements:s,timers:n}=e;!i.keyboard.global&&i.keyboard.focused&&R.call(e,s.container,"keydown keyup",this.handleKey,!1),R.call(e,s.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",o=>{const{controls:c}=s;c&&o.type==="enterfullscreen"&&(c.pressed=!1,c.hover=!1);const u=["touchstart","touchmove","mousemove"].includes(o.type);let h=0;u&&($.toggleControls.call(e,!0),h=e.touch?3e3:2e3),clearTimeout(n.controls),n.controls=setTimeout(()=>$.toggleControls.call(e,!1),h)});const r=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const o=s.wrapper,{active:c}=e.fullscreen,[u,h]=ht.call(e),m=ei(`aspect-ratio: ${u} / ${h}`);if(!c){m?(o.style.width=null,o.style.height=null):(o.style.maxWidth=null,o.style.margin=null);return}const[d,f]=ss(),p=d/f>u/h;m?(o.style.width=p?"auto":"100%",o.style.height=p?"100%":"auto"):(o.style.maxWidth=p?`${f/h*u}px`:null,o.style.margin=p?"0 auto":null)},a=()=>{clearTimeout(n.resized),n.resized=setTimeout(r,50)};R.call(e,s.container,"enterfullscreen exitfullscreen",o=>{const{target:c}=e.fullscreen;if(c!==s.container||!e.isEmbed&&l.empty(e.config.ratio))return;r(),(o.type==="enterfullscreen"?R:He).call(e,window,"resize",a)})};media=()=>{const{player:e}=this,{elements:i}=e;if(R.call(e,e.media,"timeupdate seeking seeked",n=>b.timeUpdate.call(e,n)),R.call(e,e.media,"durationchange loadeddata loadedmetadata",n=>b.durationUpdate.call(e,n)),R.call(e,e.media,"ended",()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())}),R.call(e,e.media,"progress playing seeking seeked",n=>b.updateProgress.call(e,n)),R.call(e,e.media,"volumechange",n=>b.updateVolume.call(e,n)),R.call(e,e.media,"playing play pause ended emptied timeupdate",n=>$.checkPlaying.call(e,n)),R.call(e,e.media,"waiting canplay seeked playing",n=>$.checkLoading.call(e,n)),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const n=V.call(e,`.${e.config.classNames.video}`);if(!l.element(n))return;R.call(e,i.container,"click",r=>{![i.container,n].includes(r.target)&&!n.contains(r.target)||e.touch&&e.config.hideControls||(e.ended?(this.proxy(r,e.restart,"restart"),this.proxy(r,()=>{te(e.play())},"play")):this.proxy(r,()=>{te(e.togglePlay())},"play"))})}e.supported.ui&&e.config.disableContextMenu&&R.call(e,i.wrapper,"contextmenu",n=>{n.preventDefault()},!1),R.call(e,e.media,"volumechange",()=>{e.storage.set({volume:e.volume,muted:e.muted})}),R.call(e,e.media,"ratechange",()=>{b.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})}),R.call(e,e.media,"qualitychange",n=>{b.updateSetting.call(e,"quality",null,n.detail.quality)}),R.call(e,e.media,"ready qualitychange",()=>{b.setDownloadUrl.call(e)});const s=e.config.events.concat(["keyup","keydown"]).join(" ");R.call(e,e.media,s,n=>{let{detail:r={}}=n;n.type==="error"&&(r=e.media.error),E.call(e,i.container,n.type,!0,r)})};proxy=(e,i,s)=>{const{player:n}=this,r=n.config.listeners[s],a=l.function(r);let o=!0;a&&(o=r.call(n,e)),o!==!1&&l.function(i)&&i.call(n,e)};bind=(e,i,s,n,r=!0)=>{const{player:a}=this,o=a.config.listeners[n],c=l.function(o);R.call(a,e,i,u=>this.proxy(u,s,n),r&&!c)};controls=()=>{const{player:e}=this,{elements:i}=e,s=K.isIE?"change":"input";if(i.buttons.play&&Array.from(i.buttons.play).forEach(n=>{this.bind(n,"click",()=>{te(e.togglePlay())},"play")}),this.bind(i.buttons.restart,"click",e.restart,"restart"),this.bind(i.buttons.rewind,"click",()=>{e.lastSeekTime=Date.now(),e.rewind()},"rewind"),this.bind(i.buttons.fastForward,"click",()=>{e.lastSeekTime=Date.now(),e.forward()},"fastForward"),this.bind(i.buttons.mute,"click",()=>{e.muted=!e.muted},"mute"),this.bind(i.buttons.captions,"click",()=>e.toggleCaptions()),this.bind(i.buttons.download,"click",()=>{E.call(e,e.media,"download")},"download"),this.bind(i.buttons.fullscreen,"click",()=>{e.fullscreen.toggle()},"fullscreen"),this.bind(i.buttons.pip,"click",()=>{e.pip="toggle"},"pip"),this.bind(i.buttons.airplay,"click",e.airplay,"airplay"),this.bind(i.buttons.settings,"click",n=>{n.stopPropagation(),n.preventDefault(),b.toggleMenu.call(e,n)},null,!1),this.bind(i.buttons.settings,"keyup",n=>{if([" ","Enter"].includes(n.key)){if(n.key==="Enter"){b.focusFirstMenuItem.call(e,null,!0);return}n.preventDefault(),n.stopPropagation(),b.toggleMenu.call(e,n)}},null,!1),this.bind(i.settings.menu,"keydown",n=>{n.key==="Escape"&&b.toggleMenu.call(e,n)}),this.bind(i.inputs.seek,"mousedown mousemove",n=>{const r=i.progress.getBoundingClientRect(),a=n.pageX-n.clientX,o=100/r.width*(n.pageX-r.left-a);n.currentTarget.setAttribute("seek-value",o)}),this.bind(i.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",n=>{const r=n.currentTarget,a="play-on-seeked";if(l.keyboardEvent(n)&&!["ArrowLeft","ArrowRight"].includes(n.key))return;e.lastSeekTime=Date.now();const o=r.hasAttribute(a),c=["mouseup","touchend","keyup"].includes(n.type);o&&c?(r.removeAttribute(a),te(e.play())):!c&&e.playing&&(r.setAttribute(a,""),e.pause())}),K.isIos){const n=ye.call(e,'input[type="range"]');Array.from(n).forEach(r=>this.bind(r,s,a=>Gt(a.target)))}this.bind(i.inputs.seek,s,n=>{const r=n.currentTarget;let a=r.getAttribute("seek-value");l.empty(a)&&(a=r.value),r.removeAttribute("seek-value"),e.currentTime=a/r.max*e.duration},"seek"),this.bind(i.progress,"mouseenter mouseleave mousemove",n=>b.updateSeekTooltip.call(e,n)),this.bind(i.progress,"mousemove touchmove",n=>{const{previewThumbnails:r}=e;r&&r.loaded&&r.startMove(n)}),this.bind(i.progress,"mouseleave touchend click",()=>{const{previewThumbnails:n}=e;n&&n.loaded&&n.endMove(!1,!0)}),this.bind(i.progress,"mousedown touchstart",n=>{const{previewThumbnails:r}=e;r&&r.loaded&&r.startScrubbing(n)}),this.bind(i.progress,"mouseup touchend",n=>{const{previewThumbnails:r}=e;r&&r.loaded&&r.endScrubbing(n)}),K.isWebKit&&Array.from(ye.call(e,'input[type="range"]')).forEach(n=>{this.bind(n,"input",r=>b.updateRangeFill.call(e,r.target))}),e.config.toggleInvert&&!l.element(i.display.duration)&&this.bind(i.display.currentTime,"click",()=>{e.currentTime!==0&&(e.config.invertTime=!e.config.invertTime,b.timeUpdate.call(e))}),this.bind(i.inputs.volume,s,n=>{e.volume=n.target.value},"volume"),this.bind(i.controls,"mouseenter mouseleave",n=>{i.controls.hover=!e.touch&&n.type==="mouseenter"}),i.fullscreen&&Array.from(i.fullscreen.children).filter(n=>!n.contains(i.container)).forEach(n=>{this.bind(n,"mouseenter mouseleave",r=>{i.controls&&(i.controls.hover=!e.touch&&r.type==="mouseenter")})}),this.bind(i.controls,"mousedown mouseup touchstart touchend touchcancel",n=>{i.controls.pressed=["mousedown","touchstart"].includes(n.type)}),this.bind(i.controls,"focusin",()=>{const{config:n,timers:r}=e;O(i.controls,n.classNames.noTransition,!0),$.toggleControls.call(e,!0),setTimeout(()=>{O(i.controls,n.classNames.noTransition,!1)},0);const a=this.touch?3e3:4e3;clearTimeout(r.controls),r.controls=setTimeout(()=>$.toggleControls.call(e,!1),a)}),this.bind(i.inputs.volume,"wheel",n=>{const r=n.webkitDirectionInvertedFromDevice,[a,o]=[n.deltaX,-n.deltaY].map(h=>r?-h:h),c=Math.sign(Math.abs(a)>Math.abs(o)?a:o);e.increaseVolume(c/50);const{volume:u}=e.media;(c===1&&u<1||c===-1&&u>0)&&n.preventDefault()},"volume",!1)}}var Ne={exports:{}},ws=Ne.exports,Lt;function ks(){return Lt||(Lt=1,(function(t,e){(function(i,s){t.exports=s()})(ws,function(){var i=function(){},s={},n={},r={};function a(d,f){d=d.push?d:[d];var p=[],y=d.length,w=y,C,g,k,T;for(C=function(M,P){P.length&&p.push(M),w--,w||f(p)};y--;){if(g=d[y],k=n[g],k){C(g,k);continue}T=r[g]=r[g]||[],T.push(C)}}function o(d,f){if(d){var p=r[d];if(n[d]=f,!!p)for(;p.length;)p[0](d,f),p.splice(0,1)}}function c(d,f){d.call&&(d={success:d}),f.length?(d.error||i)(f):(d.success||i)(d)}function u(d,f,p,y){var w=document,C=p.async,g=(p.numRetries||0)+1,k=p.before||i,T=d.replace(/[\?|#].*$/,""),M=d.replace(/^(css|img|module|nomodule)!/,""),P,N,L;if(y=y||0,/(^css!|\.css$)/.test(T))L=w.createElement("link"),L.rel="stylesheet",L.href=M,P="hideFocus"in L,P&&L.relList&&(P=0,L.rel="preload",L.as="style");else if(/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(T))L=w.createElement("img"),L.src=M;else if(L=w.createElement("script"),L.src=M,L.async=C===void 0?!0:C,N="noModule"in L,/^module!/.test(T)){if(!N)return f(d,"l");L.type="module"}else if(/^nomodule!/.test(T)&&N)return f(d,"l");L.onload=L.onerror=L.onbeforeload=function(D){var j=D.type[0];if(P)try{L.sheet.cssText.length||(j="e")}catch(z){z.code!=18&&(j="e")}if(j=="e"){if(y+=1,y<g)return u(d,f,p,y)}else if(L.rel=="preload"&&L.as=="style")return L.rel="stylesheet";f(d,j,D.defaultPrevented)},k(d,L)!==!1&&w.head.appendChild(L)}function h(d,f,p){d=d.push?d:[d];var y=d.length,w=y,C=[],g,k;for(g=function(T,M,P){if(M=="e"&&C.push(T),M=="b")if(P)C.push(T);else return;y--,y||f(C)},k=0;k<w;k++)u(d[k],g,p)}function m(d,f,p){var y,w;if(f&&f.trim&&(y=f),w=(y?p:f)||{},y){if(y in s)throw"LoadJS";s[y]=!0}function C(g,k){h(d,function(T){c(w,T),g&&c({success:g,error:k},T),o(y,T)},w)}if(w.returnPromise)return new Promise(C);C()}return m.ready=function(f,p){return a(f,function(y){c(p,y)}),m},m.done=function(f){o(f,[])},m.reset=function(){s={},n={},r={}},m.isDefined=function(f){return f in s},m})})(Ne)),Ne.exports}var Ts=ks();const Cs=fi(Ts);function dt(t){return new Promise((e,i)=>{Cs(t,{success:e,error:i})})}function Ss(t){if(l.empty(t))return null;if(l.number(Number(t)))return t;const e=/^.*(vimeo.com\/|video\/)(\d+).*/,i=t.match(e);return i?i[2]:t}function Es(t){const e=/^.*(vimeo.com\/|video\/)(\d+)(\?.*h=|\/)+([\d,a-f]+)/,i=t.match(e);return i&&i.length===5?i[4]:null}function fe(t){t&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===t&&(this.media.paused=!t,E.call(this,this.media,t?"play":"pause"))}const tt={setup(){const t=this;O(t.elements.wrapper,t.config.classNames.embed,!0),t.options.speed=t.config.speed.options,pe.call(t),l.object(window.Vimeo)?tt.ready.call(t):dt(t.config.urls.vimeo.sdk).then(()=>{tt.ready.call(t)}).catch(e=>{t.debug.warn("Vimeo SDK (player.js) failed to load",e)})},ready(){const t=this,e=t.config.vimeo,{premium:i,referrerPolicy:s,...n}=e;let r=t.media.getAttribute("src"),a="";l.empty(r)?(r=t.media.getAttribute(t.config.attributes.embed.id),a=t.media.getAttribute(t.config.attributes.embed.hash)):a=Es(r);const o=a?{h:a}:{};i&&Object.assign(n,{controls:!1,sidedock:!1});const c=oi({loop:t.config.loop.active,autoplay:t.autoplay,muted:t.muted,gesture:"media",playsinline:t.config.playsinline,...o,...n}),u=Ss(r),h=S("iframe"),m=et(t.config.urls.vimeo.iframe,u,c);if(h.setAttribute("src",m),h.setAttribute("allowfullscreen",""),h.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),l.empty(s)||h.setAttribute("referrerPolicy",s),i||!e.customControls)h.setAttribute("data-poster",t.poster),t.media=Re(h,t.media);else{const g=S("div",{class:t.config.classNames.embedContainer,"data-poster":t.poster});g.appendChild(h),t.media=Re(g,t.media)}e.customControls||Se(et(t.config.urls.vimeo.api,m)).then(g=>{l.empty(g)||!g.thumbnail_url||$.setPoster.call(t,g.thumbnail_url).catch(()=>{})}),t.embed=new window.Vimeo.Player(h,{autopause:t.config.autopause,muted:t.muted}),t.media.paused=!0,t.media.currentTime=0,t.supported.ui&&t.embed.disableTextTrack(),t.media.play=()=>(fe.call(t,!0),t.embed.play()),t.media.pause=()=>(fe.call(t,!1),t.embed.pause()),t.media.stop=()=>{t.pause(),t.currentTime=0};let{currentTime:d}=t.media;Object.defineProperty(t.media,"currentTime",{get(){return d},set(g){const{embed:k,media:T,paused:M,volume:P}=t,N=M&&!k.hasPlayed;T.seeking=!0,E.call(t,T,"seeking"),Promise.resolve(N&&k.setVolume(0)).then(()=>k.setCurrentTime(g)).then(()=>N&&k.pause()).then(()=>N&&k.setVolume(P)).catch(()=>{})}});let f=t.config.speed.selected;Object.defineProperty(t.media,"playbackRate",{get(){return f},set(g){t.embed.setPlaybackRate(g).then(()=>{f=g,E.call(t,t.media,"ratechange")}).catch(()=>{t.options.speed=[1]})}});let{volume:p}=t.config;Object.defineProperty(t.media,"volume",{get(){return p},set(g){t.embed.setVolume(g).then(()=>{p=g,E.call(t,t.media,"volumechange")})}});let{muted:y}=t.config;Object.defineProperty(t.media,"muted",{get(){return y},set(g){const k=l.boolean(g)?g:!1;t.embed.setMuted(k?!0:t.config.muted).then(()=>{y=k,E.call(t,t.media,"volumechange")})}});let{loop:w}=t.config;Object.defineProperty(t.media,"loop",{get(){return w},set(g){const k=l.boolean(g)?g:t.config.loop.active;t.embed.setLoop(k).then(()=>{w=k})}});let C;t.embed.getVideoUrl().then(g=>{C=g,b.setDownloadUrl.call(t)}).catch(g=>{this.debug.warn(g)}),Object.defineProperty(t.media,"currentSrc",{get(){return C}}),Object.defineProperty(t.media,"ended",{get(){return t.currentTime===t.duration}}),Promise.all([t.embed.getVideoWidth(),t.embed.getVideoHeight()]).then(g=>{const[k,T]=g;t.embed.ratio=ii(k,T),pe.call(this)}),t.embed.setAutopause(t.config.autopause).then(g=>{t.config.autopause=g}),t.embed.getVideoTitle().then(g=>{t.config.title=g,$.setTitle.call(this)}),t.embed.getCurrentTime().then(g=>{d=g,E.call(t,t.media,"timeupdate")}),t.embed.getDuration().then(g=>{t.media.duration=g,E.call(t,t.media,"durationchange")}),t.embed.getTextTracks().then(g=>{t.media.textTracks=g,_.setup.call(t)}),t.embed.on("cuechange",({cues:g=[]})=>{const k=g.map(T=>ms(T.text));_.updateCues.call(t,k)}),t.embed.on("loaded",()=>{t.embed.getPaused().then(g=>{fe.call(t,!g),g||E.call(t,t.media,"playing")}),l.element(t.embed.element)&&t.supported.ui&&t.embed.element.setAttribute("tabindex",-1)}),t.embed.on("bufferstart",()=>{E.call(t,t.media,"waiting")}),t.embed.on("bufferend",()=>{E.call(t,t.media,"playing")}),t.embed.on("play",()=>{fe.call(t,!0),E.call(t,t.media,"playing")}),t.embed.on("pause",()=>{fe.call(t,!1)}),t.embed.on("timeupdate",g=>{t.media.seeking=!1,d=g.seconds,E.call(t,t.media,"timeupdate")}),t.embed.on("progress",g=>{t.media.buffered=g.percent,E.call(t,t.media,"progress"),Number.parseInt(g.percent,10)===1&&E.call(t,t.media,"canplaythrough"),t.embed.getDuration().then(k=>{k!==t.media.duration&&(t.media.duration=k,E.call(t,t.media,"durationchange"))})}),t.embed.on("seeked",()=>{t.media.seeking=!1,E.call(t,t.media,"seeked")}),t.embed.on("ended",()=>{t.media.paused=!0,E.call(t,t.media,"ended")}),t.embed.on("error",g=>{t.media.error=g,E.call(t,t.media,"error")}),e.customControls&&setTimeout(()=>$.build.call(t),0)}};function Ps(t){if(l.empty(t))return null;const e=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,i=t.match(e);return i&&i[2]?i[2]:t}function ge(t){t&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===t&&(this.media.paused=!t,E.call(this,this.media,t?"play":"pause"))}function Ms(t){if(t.noCookie)return"https://www.youtube-nocookie.com";if(window.location.protocol==="http:")return"http://www.youtube.com"}const De={setup(){if(O(this.elements.wrapper,this.config.classNames.embed,!0),l.object(window.YT)&&l.function(window.YT.Player))De.ready.call(this);else{const t=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{l.function(t)&&t(),De.ready.call(this)},dt(this.config.urls.youtube.sdk).catch(e=>{this.debug.warn("YouTube API failed to load",e)})}},getTitle(t){const e=et(this.config.urls.youtube.api,t);Se(e).then(i=>{if(l.object(i)){const{title:s,height:n,width:r}=i;this.config.title=s,$.setTitle.call(this),this.embed.ratio=ii(r,n)}pe.call(this)}).catch(()=>{pe.call(this)})},ready(){const t=this,e=t.config.youtube,i=t.media&&t.media.getAttribute("id");if(!l.empty(i)&&i.startsWith("youtube-"))return;let s=t.media.getAttribute("src");l.empty(s)&&(s=t.media.getAttribute(this.config.attributes.embed.id));const n=Ps(s),r=cs(t.provider),a=S("div",{id:r,"data-poster":e.customControls?t.poster:void 0});if(t.media=Re(a,t.media),e.customControls){const o=c=>`https://i.ytimg.com/vi/${n}/${c}default.jpg`;Le(o("maxres"),121).catch(()=>Le(o("sd"),121)).catch(()=>Le(o("hq"))).then(c=>$.setPoster.call(t,c.src)).then(c=>{c.includes("maxres")||(t.elements.poster.style.backgroundSize="cover")}).catch(()=>{})}t.embed=new window.YT.Player(t.media,{videoId:n,host:Ms(e),playerVars:W({},{autoplay:t.config.autoplay?1:0,hl:t.config.hl,controls:t.supported.ui&&e.customControls?0:1,disablekb:1,playsinline:t.config.playsinline&&!t.config.fullscreen.iosNative?1:0,cc_load_policy:t.captions.active?1:0,cc_lang_pref:t.config.captions.language,widget_referrer:window?window.location.href:null},e),events:{onError(o){if(!t.media.error){const c=o.data,u={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[c]||"An unknown error occurred";t.media.error={code:c,message:u},E.call(t,t.media,"error")}},onPlaybackRateChange(o){const c=o.target;t.media.playbackRate=c.getPlaybackRate(),E.call(t,t.media,"ratechange")},onReady(o){if(l.function(t.media.play))return;const c=o.target;De.getTitle.call(t,n),t.media.play=()=>{ge.call(t,!0),c.playVideo()},t.media.pause=()=>{ge.call(t,!1),c.pauseVideo()},t.media.stop=()=>{c.stopVideo()},t.media.duration=c.getDuration(),t.media.paused=!0,t.media.currentTime=0,Object.defineProperty(t.media,"currentTime",{get(){return Number(c.getCurrentTime())},set(d){t.paused&&!t.embed.hasPlayed&&t.embed.mute(),t.media.seeking=!0,E.call(t,t.media,"seeking"),c.seekTo(d)}}),Object.defineProperty(t.media,"playbackRate",{get(){return c.getPlaybackRate()},set(d){c.setPlaybackRate(d)}});let{volume:u}=t.config;Object.defineProperty(t.media,"volume",{get(){return u},set(d){u=d,c.setVolume(u*100),E.call(t,t.media,"volumechange")}});let{muted:h}=t.config;Object.defineProperty(t.media,"muted",{get(){return h},set(d){const f=l.boolean(d)?d:h;h=f,c[f?"mute":"unMute"](),c.setVolume(u*100),E.call(t,t.media,"volumechange")}}),Object.defineProperty(t.media,"currentSrc",{get(){return c.getVideoUrl()}}),Object.defineProperty(t.media,"ended",{get(){return t.currentTime===t.duration}});const m=c.getAvailablePlaybackRates();t.options.speed=m.filter(d=>t.config.speed.options.includes(d)),t.supported.ui&&e.customControls&&t.media.setAttribute("tabindex",-1),E.call(t,t.media,"timeupdate"),E.call(t,t.media,"durationchange"),clearInterval(t.timers.buffering),t.timers.buffering=setInterval(()=>{t.media.buffered=c.getVideoLoadedFraction(),(t.media.lastBuffered===null||t.media.lastBuffered<t.media.buffered)&&E.call(t,t.media,"progress"),t.media.lastBuffered=t.media.buffered,t.media.buffered===1&&(clearInterval(t.timers.buffering),E.call(t,t.media,"canplaythrough"))},200),e.customControls&&setTimeout(()=>$.build.call(t),50)},onStateChange(o){const c=o.target;switch(clearInterval(t.timers.playing),t.media.seeking&&[1,2].includes(o.data)&&(t.media.seeking=!1,E.call(t,t.media,"seeked")),o.data){case-1:E.call(t,t.media,"timeupdate"),t.media.buffered=c.getVideoLoadedFraction(),E.call(t,t.media,"progress");break;case 0:ge.call(t,!1),t.media.loop?(c.stopVideo(),c.playVideo()):E.call(t,t.media,"ended");break;case 1:e.customControls&&!t.config.autoplay&&t.media.paused&&!t.embed.hasPlayed?t.media.pause():(ge.call(t,!0),E.call(t,t.media,"playing"),t.timers.playing=setInterval(()=>{E.call(t,t.media,"timeupdate")},50),t.media.duration!==c.getDuration()&&(t.media.duration=c.getDuration(),E.call(t,t.media,"durationchange")));break;case 2:t.muted||t.embed.unMute(),ge.call(t,!1);break;case 3:E.call(t,t.media,"waiting");break}E.call(t,t.elements.container,"statechange",!1,{code:o.data})}}})}},ci={setup(){if(!this.media){this.debug.warn("No media element found!");return}O(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),O(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&O(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=S("div",{class:this.config.classNames.video}),Jt(this.media,this.elements.wrapper),this.elements.poster=S("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?le.setup.call(this):this.isYouTube?De.setup.call(this):this.isVimeo&&tt.setup.call(this)}};function As(t){t.manager&&t.manager.destroy(),t.elements.displayContainer&&t.elements.displayContainer.destroy(),t.elements.container.remove()}class xs{constructor(e){this.player=e,this.config=e.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise((i,s)=>{this.on("loaded",i),this.on("error",s)}),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!l.empty(e.publisherId)||l.url(e.tagUrl))}load=()=>{this.enabled&&(!l.object(window.google)||!l.object(window.google.ima)?dt(this.player.config.urls.googleIMA.sdk).then(()=>{this.ready()}).catch(()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))}):this.ready())};ready=()=>{this.enabled||As(this),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then(()=>{this.clearSafetyTimer("onAdsManagerLoaded()")}),this.listeners(),this.setupIMA()};get tagUrl(){const{config:e}=this;if(l.url(e.tagUrl))return e.tagUrl;const i={AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId};return`https://go.aniview.com/api/adserver6/vast/?${oi(i)}`}setupIMA=()=>{this.elements.container=S("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e=>this.onAdsManagerLoaded(e),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e=>this.onAdError(e),!1),this.requestAds()};requestAds=()=>{const{container:e}=this.player.elements;try{const i=new google.ima.AdsRequest;i.adTagUrl=this.tagUrl,i.linearAdSlotWidth=e.offsetWidth,i.linearAdSlotHeight=e.offsetHeight,i.nonLinearAdSlotWidth=e.offsetWidth,i.nonLinearAdSlotHeight=e.offsetHeight,i.forceNonLinearFullSlot=!1,i.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(i)}catch(i){this.onAdError(i)}};pollCountdown=(e=!1)=>{if(!e){clearInterval(this.countdownTimer),this.elements.container.removeAttribute("data-badge-text");return}const i=()=>{const s=je(Math.max(this.manager.getRemainingTime(),0)),n=`${U.get("advertisement",this.player.config)} - ${s}`;this.elements.container.setAttribute("data-badge-text",n)};this.countdownTimer=setInterval(i,100)};onAdsManagerLoaded=e=>{if(!this.enabled)return;const i=new google.ima.AdsRenderingSettings;i.restoreCustomPlaybackStateOnAdBreakComplete=!0,i.enablePreloading=!0,this.manager=e.getAdsManager(this.player,i),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,s=>this.onAdError(s)),Object.keys(google.ima.AdEvent.Type).forEach(s=>{this.manager.addEventListener(google.ima.AdEvent.Type[s],n=>this.onAdEvent(n))}),this.trigger("loaded")};addCuePoints=()=>{l.empty(this.cuePoints)||this.cuePoints.forEach(e=>{if(e!==0&&e!==-1&&e<this.player.duration){const i=this.player.elements.progress;if(l.element(i)){const s=100/this.player.duration*e,n=S("span",{class:this.player.config.classNames.cues});n.style.left=`${s.toString()}%`,i.appendChild(n)}}})};onAdEvent=e=>{const{container:i}=this.player.elements,s=e.getAd(),n=e.getAdData();switch((a=>{E.call(this.player,this.player.media,`ads${a.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),s.isLinear()||(s.width=i.offsetWidth,s.height=i.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:n.adError&&this.player.debug.warn(`Non-fatal ad error: ${n.adError.getMessage()}`);break}};onAdError=e=>{this.cancel(),this.player.debug.warn("Ads error",e)};listeners=()=>{const{container:e}=this.player.elements;let i;this.player.on("canplay",()=>{this.addCuePoints()}),this.player.on("ended",()=>{this.loader.contentComplete()}),this.player.on("timeupdate",()=>{i=this.player.currentTime}),this.player.on("seeked",()=>{const s=this.player.currentTime;l.empty(this.cuePoints)||this.cuePoints.forEach((n,r)=>{i<n&&n<s&&(this.manager.discardAdBreak(),this.cuePoints.splice(r,1))})}),window.addEventListener("resize",()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)})};play=()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then(()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(i){this.onAdError(i)}}).catch(()=>{})};resumeContent=()=>{this.elements.container.style.zIndex="",this.playing=!1,te(this.player.media.play())};pauseContent=()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()};cancel=()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()};loadAds=()=>{this.managerPromise.then(()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise(e=>{this.on("loaded",e),this.player.debug.log(this.manager)}),this.initialized=!1,this.requestAds()}).catch(()=>{})};trigger=(e,...i)=>{const s=this.events[e];l.array(s)&&s.forEach(n=>{l.function(n)&&n.apply(this,i)})};on=(e,i)=>(l.array(this.events[e])||(this.events[e]=[]),this.events[e].push(i),this);startSafetyTimer=(e,i)=>{this.player.debug.log(`Safety timer invoked from: ${i}`),this.safetyTimer=setTimeout(()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")},e)};clearSafetyTimer=e=>{l.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)}}function ui(t=0,e=0,i=255){return Math.min(Math.max(t,e),i)}function Ls(t){const e=[];return t.split(/\r\n\r\n|\n\n|\r\r/).forEach(s=>{const n={};s.split(/\r\n|\n|\r/).forEach(a=>{if(l.number(n.startTime)){if(!l.empty(a.trim())&&l.empty(n.text)){const o=a.trim().split("#xywh=");[n.text]=o,o[1]&&([n.x,n.y,n.w,n.h]=o[1].split(","))}}else{const o=a.match(/(\d{2})?:?(\d{2}):(\d{2}).(\d{2,3})( ?--> ?)(\d{2})?:?(\d{2}):(\d{2}).(\d{2,3})/);o&&(n.startTime=Number(o[1]||0)*60*60+Number(o[2])*60+Number(o[3])+ +`0.${o[4]}`,n.endTime=Number(o[6]||0)*60*60+Number(o[7])*60+Number(o[8])+ +`0.${o[9]}`)}}),n.text&&e.push(n)}),e}function Nt(t,e){const i=e.width/e.height,s={};return t>i?(s.width=e.width,s.height=1/t*e.width):(s.height=e.height,s.width=t*e.height),s}class it{constructor(e){this.player=e,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}load=()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then(()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)})};getThumbnails=()=>new Promise(e=>{const{src:i}=this.player.config.previewThumbnails;if(l.empty(i))throw new Error("Missing previewThumbnails.src config attribute");const s=()=>{this.thumbnails.sort((n,r)=>n.height-r.height),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(l.function(i))i(n=>{this.thumbnails=n,s()});else{const r=(l.string(i)?[i]:i).map(a=>this.getThumbnail(a));Promise.all(r).then(s)}});getThumbnail=e=>new Promise(i=>{Se(e,void 0,this.player.config.previewThumbnails.withCredentials).then(s=>{const n={frames:Ls(s),height:null,urlPrefix:""};!n.frames[0].text.startsWith("/")&&!n.frames[0].text.startsWith("http://")&&!n.frames[0].text.startsWith("https://")&&(n.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const r=new Image;r.onload=()=>{n.height=r.naturalHeight,n.width=r.naturalWidth,this.thumbnails.push(n),i()},r.src=n.urlPrefix+n.frames[0].text})});startMove=e=>{if(this.loaded&&!(!l.event(e)||!["touchmove","mousemove"].includes(e.type))&&this.player.media.duration){if(e.type==="touchmove")this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{const i=this.player.elements.progress.getBoundingClientRect(),s=100/i.width*(e.pageX-i.left);this.seekTime=this.player.media.duration*(s/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.textContent=je(this.seekTime);const n=this.player.config.markers?.points?.find(({time:r})=>r===Math.round(this.seekTime));n&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${n.label}<br>`)}this.showImageAtCurrentTime()}};endMove=()=>{this.toggleThumbContainer(!1,!0)};startScrubbing=e=>{(l.nullOrUndefined(e.button)||e.button===!1||e.button===0)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))};endScrubbing=()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):ut.call(this.player,this.player.media,"timeupdate",()=>{this.mouseDown||this.toggleScrubbingContainer(!1)})};listeners=()=>{this.player.on("play",()=>{this.toggleThumbContainer(!1,!0)}),this.player.on("seeked",()=>{this.toggleThumbContainer(!1)}),this.player.on("timeupdate",()=>{this.lastTime=this.player.media.currentTime})};render=()=>{this.elements.thumb.container=S("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=S("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=S("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=S("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),l.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=S("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)};destroy=()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()};showImageAtCurrentTime=()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex(n=>this.seekTime>=n.startTime&&this.seekTime<=n.endTime),i=e>=0;let s=0;this.mouseDown||this.toggleThumbContainer(i),i&&(this.thumbnails.forEach((n,r)=>{this.loadedImages.includes(n.frames[e].text)&&(s=r)}),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(s)))};loadImage=(e=0)=>{const i=this.showingThumb,s=this.thumbnails[e],{urlPrefix:n}=s,r=s.frames[i],a=s.frames[i].text,o=n+a;if(!this.currentImageElement||this.currentImageElement.dataset.filename!==a){this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const c=new Image;c.src=o,c.dataset.index=i,c.dataset.filename=a,this.showingThumbFilename=a,this.player.debug.log(`Loading image: ${o}`),c.onload=()=>this.showImage(c,r,e,i,a,!0),this.loadingImage=c,this.removeOldImages(c)}else this.showImage(this.currentImageElement,r,e,i,a,!1),this.currentImageElement.dataset.index=i,this.removeOldImages(this.currentImageElement)};showImage=(e,i,s,n,r,a=!0)=>{this.player.debug.log(`Showing thumb: ${r}. num: ${n}. qual: ${s}. newimg: ${a}`),this.setImageSizeAndOffset(e,i),a&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(r)||this.loadedImages.push(r)),this.preloadNearby(n,!0).then(this.preloadNearby(n,!1)).then(this.getHigherQuality(s,e,i,r))};removeOldImages=e=>{Array.from(this.currentImageContainer.children).forEach(i=>{if(i.tagName.toLowerCase()!=="img")return;const s=this.usingSprites?500:1e3;if(i.dataset.index!==e.dataset.index&&!i.dataset.deleting){i.dataset.deleting=!0;const{currentImageContainer:n}=this;setTimeout(()=>{n.removeChild(i),this.player.debug.log(`Removing thumb: ${i.dataset.filename}`)},s)}})};preloadNearby=(e,i=!0)=>new Promise(s=>{setTimeout(()=>{const n=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===n){let r;i?r=this.thumbnails[0].frames.slice(e):r=this.thumbnails[0].frames.slice(0,e).reverse();let a=!1;r.forEach(o=>{const c=o.text;if(c!==n&&!this.loadedImages.includes(c)){a=!0,this.player.debug.log(`Preloading thumb filename: ${c}`);const{urlPrefix:u}=this.thumbnails[0],h=u+c,m=new Image;m.src=h,m.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${c}`),this.loadedImages.includes(c)||this.loadedImages.push(c),s()}}}),a||s()}},300)});getHigherQuality=(e,i,s,n)=>{if(e<this.thumbnails.length-1){let r=i.naturalHeight;this.usingSprites&&(r=s.h),r<this.thumbContainerHeight&&setTimeout(()=>{this.showingThumbFilename===n&&(this.player.debug.log(`Showing higher quality thumb for: ${n}`),this.loadImage(e+1))},300)}};get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=Nt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}toggleThumbContainer=(e=!1,i=!1)=>{const s=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(s,e),!e&&i&&(this.showingThumb=null,this.showingThumbFilename=null)};toggleScrubbingContainer=(e=!1)=>{const i=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(i,e),e||(this.showingThumb=null,this.showingThumbFilename=null)};determineContainerAutoSizing=()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)};setThumbContainerSizeAndPos=()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const i=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${i}px`}else if(e.clientHeight<20&&e.clientWidth>20){const i=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${i}px`}}else{const i=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${i}px`}this.setThumbContainerPos()};setThumbContainerPos=()=>{const e=this.player.elements.progress.getBoundingClientRect(),i=this.player.elements.container.getBoundingClientRect(),{container:s}=this.elements.thumb,n=i.left-e.left+10,r=i.right-e.left-s.clientWidth-10,a=this.mousePosX-e.left-s.clientWidth/2,o=ui(a,n,r);s.style.left=`${o}px`,s.style.setProperty("--preview-arrow-offset",`${a-o}px`)};setScrubbingContainerSize=()=>{const{width:e,height:i}=Nt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${i}px`};setImageSizeAndOffset=(e,i)=>{if(!this.usingSprites)return;const s=this.thumbContainerHeight/i.h;e.style.height=`${e.naturalHeight*s}px`,e.style.width=`${e.naturalWidth*s}px`,e.style.left=`-${i.x*s}px`,e.style.top=`-${i.y*s}px`}}const st={insertElements(t,e){l.string(e)?Pt(t,this.media,{src:e}):l.array(e)&&e.forEach(i=>{Pt(t,this.media,i)})},change(t){if(!Qt(t,"sources.length")){this.debug.warn("Invalid source format");return}le.cancelRequests.call(this),this.destroy(()=>{this.options.quality=[],se(this.media),this.media=null,l.element(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:e,type:i}=t,[{provider:s=ae.html5,src:n}]=e,r=s==="html5"?i:"div",a=s==="html5"?{}:{src:n};Object.assign(this,{provider:s,type:i,supported:q.check(i,s,this.config.playsinline),media:S(r,a)}),this.elements.container.appendChild(this.media),l.boolean(t.autoplay)&&(this.config.autoplay=t.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),l.empty(t.poster)||(this.poster=t.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),$.addStyleHook.call(this),this.isHTML5&&st.insertElements.call(this,"source",e),this.config.title=t.title,ci.setup.call(this),this.isHTML5&&Object.keys(t).includes("tracks")&&st.insertElements.call(this,"track",t.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&$.build.call(this),this.isHTML5&&this.media.load(),l.empty(t.previewThumbnails)||(Object.assign(this.config.previewThumbnails,t.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new it(this))),this.fullscreen.update()},!0)}};class Oe{constructor(e,i){if(this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=q.touch,this.media=e,l.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||l.nodeList(this.media)||l.array(this.media))&&(this.media=this.media[0]),this.config=W({},li,Oe.defaults,i||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch{return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new ys(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",q),l.nullOrUndefined(this.media)||!l.element(this.media)){this.debug.error("Setup failed: no suitable element passed");return}if(this.media.plyr){this.debug.warn("Target already setup");return}if(!this.config.enabled){this.debug.error("Setup failed: disabled by config");return}if(!q.check().api){this.debug.error("Setup failed: no support");return}const s=this.media.cloneNode(!0);s.autoplay=!1,this.elements.original=s;const n=this.media.tagName.toLowerCase();let r=null,a=null;switch(n){case"div":if(r=this.media.querySelector("iframe"),l.element(r)){if(a=ai(r.getAttribute("src")),this.provider=bs(a.toString()),this.elements.container=this.media,this.media=r,this.elements.container.className="",a.search.length){const o=["1","true"];o.includes(a.searchParams.get("autoplay"))&&(this.config.autoplay=!0),o.includes(a.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=o.includes(a.searchParams.get("playsinline")),this.config.youtube.hl=a.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(l.empty(this.provider)||!Object.values(ae).includes(this.provider)){this.debug.error("Setup failed: Invalid provider");return}this.type=ze.video;break;case"video":case"audio":this.type=n,this.provider=ae.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:this.debug.error("Setup failed: unsupported type");return}if(this.supported=q.check(this.type,this.provider),!this.supported.api){this.debug.error("Setup failed: no support");return}this.eventListeners=[],this.listeners=new vs(this),this.storage=new we(this),this.media.plyr=this,l.element(this.elements.container)||(this.elements.container=S("div"),Jt(this.media,this.elements.container)),$.migrateStyles.call(this),$.addStyleHook.call(this),ci.setup.call(this),this.config.debug&&R.call(this,this.elements.container,this.config.events.join(" "),o=>{this.debug.log(`event: ${o.type}`)}),this.fullscreen=new Z(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&$.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new xs(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",()=>te(this.play())),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new it(this))}get isHTML5(){return this.provider===ae.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===ae.youtube}get isVimeo(){return this.provider===ae.vimeo}get isVideo(){return this.type===ze.video}get isAudio(){return this.type===ze.audio}play=()=>l.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then(()=>this.ads.play()).catch(()=>te(this.media.play())),this.media.play()):null;pause=()=>!this.playing||!l.function(this.media.pause)?null:this.media.pause();get playing(){return!!(this.ready&&!this.paused&&!this.ended)}get paused(){return!!this.media.paused}get stopped(){return!!(this.paused&&this.currentTime===0)}get ended(){return!!this.media.ended}togglePlay=e=>(l.boolean(e)?e:!this.playing)?this.play():this.pause();stop=()=>{this.isHTML5?(this.pause(),this.restart()):l.function(this.media.stop)&&this.media.stop()};restart=()=>{this.currentTime=0};rewind=e=>{this.currentTime-=l.number(e)?e:this.config.seekTime};forward=e=>{this.currentTime+=l.number(e)?e:this.config.seekTime};set currentTime(e){if(!this.duration)return;const i=l.number(e)&&e>0;this.media.currentTime=i?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return l.number(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return!!this.media.seeking}get duration(){const e=Number.parseFloat(this.config.duration),i=(this.media||{}).duration,s=!l.number(i)||i===1/0?0:i;return e||s}set volume(e){let i=e;const s=1,n=0;l.string(i)&&(i=Number(i)),l.number(i)||(i=this.storage.get("volume")),l.number(i)||({volume:i}=this.config),i>s&&(i=s),i<n&&(i=n),this.config.volume=i,this.media.volume=i,!l.empty(e)&&this.muted&&i>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}increaseVolume=e=>{const i=this.media.muted?0:this.volume;this.volume=i+(l.number(e)?e:0)};decreaseVolume=e=>{this.increaseVolume(-e)};set muted(e){let i=e;l.boolean(i)||(i=this.storage.get("muted")),l.boolean(i)||(i=this.config.muted),this.config.muted=i,this.media.muted=i}get muted(){return!!this.media.muted}get hasAudio(){return!this.isHTML5||this.isAudio?!0:!!this.media.mozHasAudio||!!this.media.webkitAudioDecodedByteCount||!!(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let i=null;l.number(e)&&(i=e),l.number(i)||(i=this.storage.get("speed")),l.number(i)||(i=this.config.speed.selected);const{minimumSpeed:s,maximumSpeed:n}=this;i=ui(i,s,n),this.config.speed.selected=i,setTimeout(()=>{this.media&&(this.media.playbackRate=i)},0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const i=this.config.quality,s=this.options.quality;if(!s.length)return;let n=[!l.empty(e)&&Number(e),this.storage.get("quality"),i.selected,i.default].find(l.number),r=!0;if(!s.includes(n)){const a=Zt(s,n);this.debug.warn(`Unsupported quality option: ${n}, using ${a} instead`),n=a,r=!1}i.selected=n,this.media.quality=n,r&&this.storage.set({quality:n})}get quality(){return this.media.quality}set loop(e){const i=l.boolean(e)?e:this.config.loop.active;this.config.loop.active=i,this.media.loop=i}get loop(){return!!this.media.loop}set source(e){st.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return l.url(e)?e:this.source}set download(e){l.url(e)&&(this.config.urls.download=e,b.setDownloadUrl.call(this))}set poster(e){if(!this.isVideo){this.debug.warn("Poster can only be set for video");return}$.setPoster.call(this,e,!1).catch(()=>{})}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=Ie(ht.call(this));return l.array(e)?e.join(":"):e}set ratio(e){if(!this.isVideo){this.debug.warn("Aspect ratio can only be set for video");return}if(!l.string(e)||!ti(e)){this.debug.error(`Invalid aspect ratio specified (${e})`);return}this.config.ratio=Ie(e),pe.call(this)}set autoplay(e){this.config.autoplay=l.boolean(e)?e:this.config.autoplay}get autoplay(){return!!this.config.autoplay}toggleCaptions(e){_.toggle.call(this,e,!1)}set currentTrack(e){_.set.call(this,e,!1),_.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:i}=this.captions;return e?i:-1}set language(e){_.setLanguage.call(this,e,!1)}get language(){return(_.getCurrentTrack.call(this)||{}).language}set pip(e){if(!q.pip)return;const i=l.boolean(e)?e:!this.pip;l.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(i?Ue.active:Ue.inactive),l.function(this.media.requestPictureInPicture)&&(!this.pip&&i?this.media.requestPictureInPicture():this.pip&&!i&&document.exitPictureInPicture())}get pip(){return q.pip?l.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===Ue.active:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new it(this))}airplay=()=>{q.airplay&&this.media.webkitShowPlaybackTargetPicker()};toggleControls=e=>{if(this.supported.ui&&!this.isAudio){const i=_e(this.elements.container,this.config.classNames.hideControls),s=typeof e>"u"?void 0:!e,n=O(this.elements.container,this.config.classNames.hideControls,s);if(n&&l.array(this.config.controls)&&this.config.controls.includes("settings")&&!l.empty(this.config.settings)&&b.toggleMenu.call(this,!1),n!==i){const r=n?"controlshidden":"controlsshown";E.call(this,this.media,r)}return!n}return!1};on=(e,i)=>{R.call(this,this.elements.container,e,i)};once=(e,i)=>{ut.call(this,this.elements.container,e,i)};off=(e,i)=>{He(this.elements.container,e,i)};destroy=(e,i=!1)=>{if(!this.ready)return;const s=()=>{document.body.style.overflow="",this.embed=null,i?(Object.keys(this.elements).length&&(se(this.elements.buttons.play),se(this.elements.captions),se(this.elements.controls),se(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),l.function(e)&&e()):(ts.call(this),le.cancelRequests.call(this),Re(this.elements.original,this.elements.container),E.call(this,this.elements.original,"destroyed",!0),l.function(e)&&e.call(this.elements.original),this.ready=!1,setTimeout(()=>{this.elements=null,this.media=null},200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?($.toggleNativeControls.call(this,!0),s()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),this.embed!==null&&l.function(this.embed.destroy)&&this.embed.destroy(),s()):this.isVimeo&&(this.embed!==null&&this.embed.unload().then(s),setTimeout(s,200))};supports=e=>q.mime.call(this,e);static supported(e,i){return q.check(e,i)}static loadSprite(e,i){return ni(e,i)}static setup(e,i={}){let s=null;return l.string(e)?s=Array.from(document.querySelectorAll(e)):l.nodeList(e)?s=Array.from(e):l.array(e)&&(s=e.filter(l.element)),l.empty(s)?null:s.map(n=>new Oe(n,i))}}Oe.defaults=Qi(li);let Ns={data:""},Ds=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||Ns},Rs=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,_s=/\/\*[^]*?\*\/|  +/g,Dt=/\n+/g,oe=(t,e)=>{let i="",s="",n="";for(let r in t){let a=t[r];r[0]=="@"?r[1]=="i"?i=r+" "+a+";":s+=r[1]=="f"?oe(a,r):r+"{"+oe(a,r[1]=="k"?"":e)+"}":typeof a=="object"?s+=oe(a,e?e.replace(/([^,])+/g,o=>r.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):r):a!=null&&(r=/^--/.test(r)?r:r.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=oe.p?oe.p(r,a):r+":"+a+";")}return i+(e&&n?e+"{"+n+"}":n)+s},ie={},hi=t=>{if(typeof t=="object"){let e="";for(let i in t)e+=i+hi(t[i]);return e}return t},Is=(t,e,i,s,n)=>{let r=hi(t),a=ie[r]||(ie[r]=(c=>{let u=0,h=11;for(;u<c.length;)h=101*h+c.charCodeAt(u++)>>>0;return"go"+h})(r));if(!ie[a]){let c=r!==t?t:(u=>{let h,m,d=[{}];for(;h=Rs.exec(u.replace(_s,""));)h[4]?d.shift():h[3]?(m=h[3].replace(Dt," ").trim(),d.unshift(d[0][m]=d[0][m]||{})):d[0][h[1]]=h[2].replace(Dt," ").trim();return d[0]})(t);ie[a]=oe(n?{["@keyframes "+a]:c}:c,i?"":"."+a)}let o=i&&ie.g?ie.g:null;return i&&(ie.g=ie[a]),((c,u,h,m)=>{m?u.data=u.data.replace(m,c):u.data.indexOf(c)===-1&&(u.data=h?c+u.data:u.data+c)})(ie[a],e,s,o),a},Os=(t,e,i)=>t.reduce((s,n,r)=>{let a=e[r];if(a&&a.call){let o=a(i),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=c?"."+c:o&&typeof o=="object"?o.props?"":oe(o,""):o===!1?"":o}return s+n+(a??"")},"");function mt(t){let e=this||{},i=t.call?t(e.p):t;return Is(i.unshift?i.raw?Os(i,[].slice.call(arguments,1),e.p):i.reduce((s,n)=>Object.assign(s,n&&n.call?n(e.p):n),{}):i,Ds(e.target),e.g,e.o,e.k)}let di,nt,rt;mt.bind({g:1});let Qs=mt.bind({k:1});function Js(t,e,i,s){oe.p=e,di=t,nt=i,rt=s}function Zs(t,e){let i=this||{};return function(){let s=arguments;function n(r,a){let o=Object.assign({},r),c=o.className||n.className;i.p=Object.assign({theme:nt&&nt()},o),i.o=/ *go\d+/.test(c),o.className=mt.apply(i,s)+(c?" "+c:"");let u=t;return t[0]&&(u=o.as||t,delete o.as),rt&&u[0]&&rt(o),di(u,o)}return n}}const $s=(t,e)=>e.some(i=>t instanceof i);let Rt,_t;function Hs(){return Rt||(Rt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function js(){return _t||(_t=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mi=new WeakMap,at=new WeakMap,pi=new WeakMap,Xe=new WeakMap,pt=new WeakMap;function Ws(t){const e=new Promise((i,s)=>{const n=()=>{t.removeEventListener("success",r),t.removeEventListener("error",a)},r=()=>{i(ce(t.result)),n()},a=()=>{s(t.error),n()};t.addEventListener("success",r),t.addEventListener("error",a)});return e.then(i=>{i instanceof IDBCursor&&mi.set(i,t)}).catch(()=>{}),pt.set(e,t),e}function Bs(t){if(at.has(t))return;const e=new Promise((i,s)=>{const n=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",a),t.removeEventListener("abort",a)},r=()=>{i(),n()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",r),t.addEventListener("error",a),t.addEventListener("abort",a)});at.set(t,e)}let ot={get(t,e,i){if(t instanceof IDBTransaction){if(e==="done")return at.get(t);if(e==="objectStoreNames")return t.objectStoreNames||pi.get(t);if(e==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return ce(t[e])},set(t,e,i){return t[e]=i,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function qs(t){ot=t(ot)}function Fs(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...i){const s=t.call(Ye(this),e,...i);return pi.set(s,e.sort?e.sort():[e]),ce(s)}:js().includes(t)?function(...e){return t.apply(Ye(this),e),ce(mi.get(this))}:function(...e){return ce(t.apply(Ye(this),e))}}function Vs(t){return typeof t=="function"?Fs(t):(t instanceof IDBTransaction&&Bs(t),$s(t,Hs())?new Proxy(t,ot):t)}function ce(t){if(t instanceof IDBRequest)return Ws(t);if(Xe.has(t))return Xe.get(t);const e=Vs(t);return e!==t&&(Xe.set(t,e),pt.set(e,t)),e}const Ye=t=>pt.get(t);function en(t,e,{blocked:i,upgrade:s,blocking:n,terminated:r}={}){const a=indexedDB.open(t,e),o=ce(a);return s&&a.addEventListener("upgradeneeded",c=>{s(ce(a.result),c.oldVersion,c.newVersion,ce(a.transaction),c)}),i&&a.addEventListener("blocked",c=>i(c.oldVersion,c.newVersion,c)),o.then(c=>{r&&c.addEventListener("close",()=>r()),n&&c.addEventListener("versionchange",u=>n(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const Us=["get","getKey","getAll","getAllKeys","count"],zs=["put","add","delete","clear"],Ge=new Map;function It(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ge.get(e))return Ge.get(e);const i=e.replace(/FromIndex$/,""),s=e!==i,n=zs.includes(i);if(!(i in(s?IDBIndex:IDBObjectStore).prototype)||!(n||Us.includes(i)))return;const r=async function(a,...o){const c=this.transaction(a,n?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(o.shift())),(await Promise.all([u[i](...o),n&&c.done]))[0]};return Ge.set(e,r),r}qs(t=>({...t,get:(e,i,s)=>It(e,i)||t.get(e,i,s),has:(e,i)=>!!It(e,i)||t.has(e,i)}));export{Oe as P,kt as a,Qs as h,Js as m,en as o,Xs as r,mt as u,Zs as w};
