import{r as e,z as t,j as r}from"./react-vendor-sM0qkcQs.js";import{B as n}from"./index-Ctkk8hMm.js";import{X as o,L as i,a0 as a,aA as s,S as l,az as d,a8 as c,ak as p,ax as x,a5 as u,e as g,s as m}from"./icons-Bd5TDO6B.js";import"./vendor-BjQYSgJ0.js";import"./firebase-mmLA09z6.js";function h({agent:h,onClose:y,projects:f=[],onSaveToProject:b,onCreateProject:v,user:j}){const[w,S]=e.useState(""),[k,C]=e.useState("English"),[z,R]=e.useState("Modern Hip-Hop"),[I,B]=e.useState("Gemini 2.0 Flash"),[P,G]=e.useState(null),[T,N]=e.useState(!1),[F,W]=e.useState(!1),[$,L]=e.useState(""),[A,H]=e.useState(!1),[U,O]=e.useState(!1),{isListening:V,isSpeaking:E,toggleListening:D,speak:M,stopSpeaking:Y,isSpeechSupported:J}=function(r={}){const{language:n="en-US",voiceGender:o="female",voiceRegion:i="US",onResult:a=null,onError:s=null}=r,[l,d]=e.useState(!1),[c,p]=e.useState(!1),x=e.useRef(null),u="undefined"!=typeof window&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window),g="undefined"!=typeof window&&"speechSynthesis"in window,m=e.useCallback(e=>{if(!u)return t.error("Voice input not supported. Try Chrome or Safari."),void s?.("Voice input not supported");x.current&&x.current.stop();const r=new(window.SpeechRecognition||window.webkitSpeechRecognition);r.lang=n,r.continuous=!1,r.interimResults=!0,r.maxAlternatives=1,r.onstart=()=>{d(!0),t.success("ðŸŽ¤ Listening...",{duration:1500,id:"voice-listening"})},r.onend=()=>{d(!1),x.current=null},r.onerror=e=>{d(!1),x.current=null,"not-allowed"===e.error?t.error("Microphone access denied. Please allow microphone access."):"no-speech"===e.error?t.error("No speech detected. Please try again."):t.error(`Voice error: ${e.error}`),s?.(e.error)},r.onresult=r=>{const n=r.results,o=n[n.length-1];if(o.isFinal){const r=o[0].transcript;e&&"function"==typeof e?e(r):a&&a(r),t.success("âœ“ Got it!",{duration:1e3,id:"voice-listening"})}},x.current=r;try{r.start()}catch(o){t.error("Failed to start voice input"),d(!1)}},[u,n,a,s]),h=e.useCallback(()=>{x.current&&(x.current.stop(),x.current=null),d(!1)},[]),y=e.useCallback(e=>{l?h():m(e)},[l,m,h]),f=e.useCallback((e,t={})=>{if(!g)return;if(!e||"string"!=typeof e||0===e.trim().length)return;window.speechSynthesis.cancel();const r=r=>{const a=new SpeechSynthesisUtterance(e),s=t.language||n.split("-")[0]||"en",l=r.filter(e=>e.lang.startsWith(s));let d=null;const c=t.region||i,x=t.gender||o;if("UK"===c||"GB"===c?d=l.find(e=>e.name.includes("UK")||e.name.includes("British")||e.lang.includes("GB")):"AU"===c?d=l.find(e=>e.name.includes("Australia")||e.lang.includes("AU")):"IN"===c&&(d=l.find(e=>e.name.includes("India")||e.lang.includes("IN"))),!d){const e="female"===x?["female","samantha","victoria","karen","moira","fiona"]:["male","alex","daniel","fred","tom"];d=l.find(t=>e.some(e=>t.name.toLowerCase().includes(e)))}!d&&l.length>0&&(d=l[0]),d&&(a.voice=d),a.lang=s,a.rate=t.rate||.95,a.pitch=t.pitch||("female"===x?1.05:.95),a.volume=t.volume||1,a.onstart=()=>p(!0),a.onend=()=>p(!1),a.onerror=e=>{p(!1)},window.speechSynthesis.speak(a)};let a=window.speechSynthesis.getVoices();if(a.length>0)r(a);else{const e=()=>{a=window.speechSynthesis.getVoices(),a.length>0&&(r(a),window.speechSynthesis.onvoiceschanged=null)};window.speechSynthesis.onvoiceschanged=e,setTimeout(()=>{c||(a=window.speechSynthesis.getVoices(),a.length>0&&r(a))},100)}},[g,n,o,i]),b=e.useCallback(()=>{g&&(window.speechSynthesis.cancel(),p(!1))},[g]),v=e.useCallback(e=>{c?b():f(e)},[c,f,b]);return{isListening:l,isSpeaking:c,isVoiceSupported:u,isSpeechSupported:g,startListening:m,stopListening:h,toggleListening:y,speak:f,stopSpeaking:b,toggleSpeaking:v}}({language:"en-US"}),K=h.examples?.slice(0,3)||[];return r.jsx("div",{className:"modal-overlay animate-fadeIn",onClick:y,children:r.jsxs("div",{className:"modal-content quick-workflow-modal",onClick:e=>e.stopPropagation(),style:{maxWidth:"380px",width:"calc(100vw - 24px)",maxHeight:"80vh",height:"auto",overflow:"hidden",display:"flex",flexDirection:"column",margin:"12px",padding:0},children:[r.jsxs("div",{className:"modal-header",style:{borderBottom:"1px solid var(--border-color)",padding:"10px 12px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",flexShrink:0},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1,minWidth:0},children:[r.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:`${h.color||"var(--color-purple)"}20`,display:"flex",alignItems:"center",justifyContent:"center",color:h.color||"var(--color-purple)",flexShrink:0},children:r.jsx(h.icon,{size:16})}),r.jsxs("div",{style:{minWidth:0},children:[r.jsx("h3",{style:{margin:0,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:h.name}),r.jsx("p",{style:{margin:0,fontSize:"0.7rem",color:"var(--text-secondary)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:h.role||h.category})]})]}),r.jsx("button",{className:"modal-close",onClick:y,style:{position:"relative",top:"auto",right:"auto",flexShrink:0,width:"28px",height:"28px",minWidth:"28px"},children:r.jsx(o,{size:18})})]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:[r.jsxs("div",{style:{display:"flex",gap:"6px",marginBottom:"12px",flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:1,minWidth:"80px"},children:[r.jsx("label",{style:{display:"block",fontSize:"0.65rem",color:"var(--text-secondary)",marginBottom:"3px",textTransform:"uppercase",fontWeight:"600"},children:"Language"}),r.jsx("select",{value:k,onChange:e=>C(e.target.value),style:{width:"100%",padding:"6px 8px",borderRadius:"6px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.75rem",outline:"none",cursor:"pointer"},children:["English","Spanish","French","German","Japanese","Korean","Portuguese","Italian","Chinese"].map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))})]}),r.jsxs("div",{style:{flex:1,minWidth:"80px"},children:[r.jsx("label",{style:{display:"block",fontSize:"0.65rem",color:"var(--text-secondary)",marginBottom:"3px",textTransform:"uppercase",fontWeight:"600"},children:"Style"}),r.jsx("select",{value:z,onChange:e=>R(e.target.value),style:{width:"100%",padding:"6px 8px",borderRadius:"6px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.75rem",outline:"none",cursor:"pointer"},children:["Modern Hip-Hop","90s Boom Bap","Trap","R&B / Soul","Pop","Rock","Electronic","Cinematic","Jazz","Lo-Fi"].map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))})]}),r.jsxs("div",{style:{flex:1,minWidth:"80px"},children:[r.jsx("label",{style:{display:"block",fontSize:"0.65rem",color:"var(--text-secondary)",marginBottom:"3px",textTransform:"uppercase",fontWeight:"600"},children:"Model"}),r.jsx("select",{value:I,onChange:e=>B(e.target.value),style:{width:"100%",padding:"6px 8px",borderRadius:"6px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.75rem",outline:"none",cursor:"pointer"},children:["Gemini 2.0 Flash","Gemini 2.0 Pro (Exp)","Gemini 1.5 Flash","Gemini 1.5 Pro"].map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))})]})]}),K.length>0&&!P&&r.jsxs("div",{style:{marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[r.jsxs("button",{onClick:()=>O(!U),style:{padding:"5px 10px",borderRadius:"8px",background:U?"rgba(139, 92, 246, 0.2)":"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:U?"#a855f7":"var(--text-secondary)",fontSize:"0.7rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[r.jsx(i,{size:12}),U?"Hide":"Ideas"]}),U&&K.map((e,t)=>r.jsx("button",{onClick:()=>{S(e),O(!1)},style:{padding:"4px 10px",fontSize:"0.7rem",background:"rgba(139, 92, 246, 0.15)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"16px",color:"rgba(255,255,255,0.8)",cursor:"pointer"},children:e.length>25?e.substring(0,25)+"...":e},t))]}),r.jsxs("div",{style:{position:"relative",marginBottom:"12px"},children:[r.jsx("textarea",{value:w,onChange:e=>S(e.target.value),placeholder:h.example||`What do you want ${h.name} to create?`,style:{width:"100%",minHeight:"80px",padding:"12px",paddingRight:"40px",background:"var(--color-bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"10px",color:"var(--text-primary)",fontSize:"0.9rem",resize:"vertical",fontFamily:"inherit"},autoFocus:!0}),r.jsx("button",{onClick:()=>{D(e=>{S(t=>t+(t?" ":"")+e)})},style:{position:"absolute",right:"10px",top:"10px",background:V?"var(--color-purple)":"transparent",border:"none",color:V?"white":"var(--text-secondary)",cursor:"pointer",padding:"8px",borderRadius:"8px"},title:"Voice input",children:r.jsx(a,{size:18})})]}),r.jsx("button",{onClick:async()=>{if(w.trim()){N(!0),G(null);try{const e=await(async()=>{if(j)try{return await j.getIdToken()}catch{}return null})(),r={"Content-Type":"application/json"};e&&(r.Authorization=`Bearer ${e}`);const o={"Gemini 2.0 Flash":"gemini-2.0-flash","Gemini 2.0 Pro (Exp)":"gemini-2.0-flash-exp","Gemini 1.5 Flash":"gemini-1.5-flash","Gemini 1.5 Pro":"gemini-1.5-pro"}[I]||"gemini-2.0-flash",i=await fetch(`${n}/api/generate`,{method:"POST",headers:r,body:JSON.stringify({prompt:`[Language: ${k}] [Style: ${z}] ${w}`,systemInstruction:h.systemPrompt||`You are ${h.name}, a ${h.role||h.description}. ${h.howToUse||""} Please respond in ${k}.`,model:o})}),a=await i.json();if(a.output){if(G(a.output),t.success("Generated!"),J){const e=a.output.substring(0,200)+(a.output.length>200?"...":"");M(e)}}else a.error&&t.error(a.error)}catch(e){t.error("Failed to generate. Check connection.")}finally{N(!1)}}else t.error("Please enter a prompt")},disabled:T||!w.trim(),className:"cta-button-premium",style:{width:"100%",justifyContent:"center",opacity:T||!w.trim()?.6:1},children:T?r.jsxs(r.Fragment,{children:[r.jsx(s,{size:18,className:"spin"}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(l,{size:18}),h.getStarted||"Generate"]})}),P&&r.jsxs("div",{style:{marginTop:"24px"},className:"animate-fadeInUp",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[r.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Output"}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[J&&r.jsxs("button",{onClick:()=>{E?Y():P&&M(P)},style:{background:E?"rgba(168, 85, 247, 0.2)":"none",border:"none",color:E?"var(--color-purple)":"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.8rem",padding:"4px 8px",borderRadius:"6px"},title:E?"Stop speaking":"Read aloud",children:[E?r.jsx(d,{size:14}):r.jsx(c,{size:14}),E?"Stop":"Listen"]}),r.jsxs("button",{onClick:()=>{P&&(navigator.clipboard.writeText(P),H(!0),t.success("Copied to clipboard"),setTimeout(()=>H(!1),2e3))},style:{background:"none",border:"none",color:A?"var(--color-green)":"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.8rem"},children:[A?r.jsx(p,{size:14}):r.jsx(x,{size:14}),A?"Copied!":"Copy"]})]})]}),r.jsx("div",{style:{background:"var(--color-bg-primary)",border:"1px solid var(--border-color)",borderRadius:"12px",padding:"16px",maxHeight:"200px",overflowY:"auto",whiteSpace:"pre-wrap",fontSize:"0.95rem",lineHeight:"1.6"},children:P}),r.jsx("div",{style:{marginTop:"16px"},children:F?r.jsxs("div",{className:"save-options animate-fadeIn",style:{background:"var(--color-bg-tertiary)",borderRadius:"12px",padding:"16px",border:"1px solid var(--border-color)"},children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"8px"},children:[r.jsx(g,{size:14,style:{verticalAlign:"middle",marginRight:"6px"}}),"Create new project"]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx("input",{type:"text",value:$,onChange:e=>L(e.target.value),placeholder:"Project name...",style:{flex:1,padding:"10px 12px",background:"var(--color-bg-primary)",border:"1px solid var(--border-color)",borderRadius:"8px",color:"var(--text-primary)",fontSize:"0.9rem"}}),r.jsx("button",{onClick:()=>{if(!$.trim())return void t.error("Please enter a project name");const e={id:Date.now(),type:"text",agent:h.id,agentName:h.name,prompt:w,output:P,createdAt:(new Date).toISOString()};v($.trim(),e),W(!1),L(""),t.success(`Created project "${$}"`)},disabled:!$.trim(),className:"cta-button-premium",style:{padding:"10px 16px"},children:"Create"})]})]}),f.length>0&&r.jsxs("div",{children:[r.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"8px"},children:"Or add to existing project"}),r.jsx("div",{style:{maxHeight:"150px",overflowY:"auto"},children:f.slice(0,5).map(e=>r.jsxs("button",{onClick:()=>(e=>{const r={id:Date.now(),type:"text",agent:h.id,agentName:h.name,prompt:w,output:P,createdAt:(new Date).toISOString()};b(e.id,r),W(!1),t.success(`Saved to ${e.name}`)})(e),style:{width:"100%",padding:"10px 12px",background:"var(--color-bg-primary)",border:"1px solid var(--border-color)",borderRadius:"8px",color:"var(--text-primary)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px",fontSize:"0.9rem"},children:[r.jsx("span",{children:e.name}),r.jsx(m,{size:16,style:{color:"var(--text-secondary)"}})]},e.id))})]}),r.jsx("button",{onClick:()=>W(!1),style:{marginTop:"12px",background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",fontSize:"0.85rem",width:"100%",textAlign:"center"},children:"Cancel"})]}):r.jsxs("button",{onClick:()=>W(!0),style:{width:"100%",padding:"12px",background:"var(--color-bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"10px",color:"var(--text-primary)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r.jsx(u,{size:16}),"Save to Project"]})})]})]})]})})}export{h as default};
