import{r as e,z as t,j as r}from"./react-vendor-DeHsy4Dd.js";import{B as o}from"./index--YgKy4M8.js";import{X as n,Y as i,aB as a,S as s,aC as l,a5 as c,ai as d,aD as p,a2 as x,e as u,p as g}from"./icons-Dlnai9tr.js";import"./vendor-DQw4bkiq.js";import"./firebase-C3loog8c.js";function m({agent:m,onClose:h,projects:y=[],onSaveToProject:f,onCreateProject:v,user:b}){const[j,w]=e.useState(""),[S,k]=e.useState("English"),[C,z]=e.useState("Modern Hip-Hop"),[R,B]=e.useState("Gemini 2.0 Flash"),[I,P]=e.useState(null),[G,T]=e.useState(!1),[N,F]=e.useState(!1),[$,L]=e.useState(""),[U,A]=e.useState(!1),{isListening:H,isSpeaking:W,toggleListening:O,speak:V,stopSpeaking:D,isSpeechSupported:E}=function(r={}){const{language:o="en-US",voiceGender:n="female",voiceRegion:i="US",onResult:a=null,onError:s=null}=r,[l,c]=e.useState(!1),[d,p]=e.useState(!1),x=e.useRef(null),u="undefined"!=typeof window&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window),g="undefined"!=typeof window&&"speechSynthesis"in window,m=e.useCallback(e=>{if(!u)return t.error("Voice input not supported. Try Chrome or Safari."),void s?.("Voice input not supported");x.current&&x.current.stop();const r=new(window.SpeechRecognition||window.webkitSpeechRecognition);r.lang=o,r.continuous=!1,r.interimResults=!0,r.maxAlternatives=1,r.onstart=()=>{c(!0),t.success("ðŸŽ¤ Listening...",{duration:1500,id:"voice-listening"})},r.onend=()=>{c(!1),x.current=null},r.onerror=e=>{c(!1),x.current=null,"not-allowed"===e.error?t.error("Microphone access denied. Please allow microphone access."):"no-speech"===e.error?t.error("No speech detected. Please try again."):t.error(`Voice error: ${e.error}`),s?.(e.error)},r.onresult=r=>{const o=r.results,n=o[o.length-1];if(n.isFinal){const r=n[0].transcript;e&&"function"==typeof e?e(r):a&&a(r),t.success("âœ“ Got it!",{duration:1e3,id:"voice-listening"})}},x.current=r;try{r.start()}catch(n){t.error("Failed to start voice input"),c(!1)}},[u,o,a,s]),h=e.useCallback(()=>{x.current&&(x.current.stop(),x.current=null),c(!1)},[]),y=e.useCallback(e=>{l?h():m(e)},[l,m,h]),f=e.useCallback((e,t={})=>{if(!g)return;if(!e||"string"!=typeof e||0===e.trim().length)return;window.speechSynthesis.cancel();const r=r=>{const a=new SpeechSynthesisUtterance(e),s=t.language||o.split("-")[0]||"en",l=r.filter(e=>e.lang.startsWith(s));let c=null;const d=t.region||i,x=t.gender||n;if("UK"===d||"GB"===d?c=l.find(e=>e.name.includes("UK")||e.name.includes("British")||e.lang.includes("GB")):"AU"===d?c=l.find(e=>e.name.includes("Australia")||e.lang.includes("AU")):"IN"===d&&(c=l.find(e=>e.name.includes("India")||e.lang.includes("IN"))),!c){const e="female"===x?["female","samantha","victoria","karen","moira","fiona"]:["male","alex","daniel","fred","tom"];c=l.find(t=>e.some(e=>t.name.toLowerCase().includes(e)))}!c&&l.length>0&&(c=l[0]),c&&(a.voice=c),a.lang=s,a.rate=t.rate||.95,a.pitch=t.pitch||("female"===x?1.05:.95),a.volume=t.volume||1,a.onstart=()=>p(!0),a.onend=()=>p(!1),a.onerror=e=>{p(!1)},window.speechSynthesis.speak(a)};let a=window.speechSynthesis.getVoices();if(a.length>0)r(a);else{const e=()=>{a=window.speechSynthesis.getVoices(),a.length>0&&(r(a),window.speechSynthesis.onvoiceschanged=null)};window.speechSynthesis.onvoiceschanged=e,setTimeout(()=>{d||(a=window.speechSynthesis.getVoices(),a.length>0&&r(a))},100)}},[g,o,n,i]),v=e.useCallback(()=>{g&&(window.speechSynthesis.cancel(),p(!1))},[g]),b=e.useCallback(e=>{d?v():f(e)},[d,f,v]);return{isListening:l,isSpeaking:d,isVoiceSupported:u,isSpeechSupported:g,startListening:m,stopListening:h,toggleListening:y,speak:f,stopSpeaking:v,toggleSpeaking:b}}({language:"en-US"}),Y=m.examples?.slice(0,3)||[];return r.jsx("div",{className:"modal-overlay animate-fadeIn",onClick:h,children:r.jsxs("div",{className:"modal-content quick-workflow-modal",onClick:e=>e.stopPropagation(),style:{maxWidth:"600px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{className:"modal-header",style:{borderBottom:"1px solid var(--border-color)",padding:"16px 24px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1,minWidth:0},children:[r.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:`${m.color||"var(--color-purple)"}20`,display:"flex",alignItems:"center",justifyContent:"center",color:m.color||"var(--color-purple)",flexShrink:0},children:r.jsx(m.icon,{size:20})}),r.jsxs("div",{style:{minWidth:0},children:[r.jsx("h3",{style:{margin:0,fontSize:"1.1rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m.name}),r.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-secondary)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m.role||m.category})]})]}),r.jsx("button",{className:"modal-close",onClick:h,style:{position:"relative",top:"auto",right:"auto",flexShrink:0},children:r.jsx(n,{size:20})})]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"24px"},children:[r.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"20px"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{display:"block",fontSize:"0.7rem",color:"var(--text-secondary)",marginBottom:"4px",textTransform:"uppercase",fontWeight:"600"},children:"Language"}),r.jsx("select",{value:S,onChange:e=>k(e.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.85rem",outline:"none",cursor:"pointer"},children:["English","Spanish","French","German","Japanese","Korean","Portuguese","Italian","Chinese"].map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{display:"block",fontSize:"0.7rem",color:"var(--text-secondary)",marginBottom:"4px",textTransform:"uppercase",fontWeight:"600"},children:"Style"}),r.jsx("select",{value:C,onChange:e=>z(e.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.85rem",outline:"none",cursor:"pointer"},children:["Modern Hip-Hop","90s Boom Bap","Trap","R&B / Soul","Pop","Rock","Electronic","Cinematic","Jazz","Lo-Fi"].map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{display:"block",fontSize:"0.7rem",color:"var(--text-secondary)",marginBottom:"4px",textTransform:"uppercase",fontWeight:"600"},children:"Model"}),r.jsx("select",{value:R,onChange:e=>B(e.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",fontSize:"0.85rem",outline:"none",cursor:"pointer"},children:["Gemini 2.0 Flash","Gemini 2.0 Pro (Exp)","Gemini 1.5 Flash","Gemini 1.5 Pro"].map(e=>r.jsx("option",{value:e,style:{background:"#1a1a1a"},children:e},e))})]})]}),Y.length>0&&!I&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginBottom:"8px"},children:"Try:"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:Y.map((e,t)=>r.jsx("button",{onClick:()=>w(e),style:{padding:"6px 12px",fontSize:"0.8rem",background:"var(--color-bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"20px",color:"var(--text-secondary)",cursor:"pointer",transition:"all 0.2s"},children:e.length>40?e.substring(0,40)+"...":e},t))})]}),r.jsxs("div",{style:{position:"relative",marginBottom:"16px"},children:[r.jsx("textarea",{value:j,onChange:e=>w(e.target.value),placeholder:m.example||`What do you want ${m.name} to create?`,style:{width:"100%",minHeight:"100px",padding:"16px",paddingRight:"48px",background:"var(--color-bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"12px",color:"var(--text-primary)",fontSize:"1rem",resize:"vertical",fontFamily:"inherit"},autoFocus:!0}),r.jsx("button",{onClick:()=>{O(e=>{w(t=>t+(t?" ":"")+e)})},style:{position:"absolute",right:"12px",top:"12px",background:H?"var(--color-purple)":"transparent",border:"none",color:H?"white":"var(--text-secondary)",cursor:"pointer",padding:"8px",borderRadius:"8px"},title:"Voice input",children:r.jsx(i,{size:18})})]}),r.jsx("button",{onClick:async()=>{if(j.trim()){T(!0),P(null);try{const e=await(async()=>{if(b)try{return await b.getIdToken()}catch(e){}return null})(),r={"Content-Type":"application/json"};e&&(r.Authorization=`Bearer ${e}`);const n={"Gemini 2.0 Flash":"gemini-2.0-flash","Gemini 2.0 Pro (Exp)":"gemini-2.0-flash-exp","Gemini 1.5 Flash":"gemini-1.5-flash","Gemini 1.5 Pro":"gemini-1.5-pro"}[R]||"gemini-2.0-flash",i=await fetch(`${o}/api/generate`,{method:"POST",headers:r,body:JSON.stringify({prompt:`[Language: ${S}] [Style: ${C}] ${j}`,systemInstruction:m.systemPrompt||`You are ${m.name}, a ${m.role||m.description}. ${m.howToUse||""} Please respond in ${S}.`,model:n})}),a=await i.json();if(a.output){if(P(a.output),t.success("Generated!"),E){const e=a.output.substring(0,200)+(a.output.length>200?"...":"");V(e)}}else a.error&&t.error(a.error)}catch(e){t.error("Failed to generate. Check connection.")}finally{T(!1)}}else t.error("Please enter a prompt")},disabled:G||!j.trim(),className:"cta-button-premium",style:{width:"100%",justifyContent:"center",opacity:G||!j.trim()?.6:1},children:G?r.jsxs(r.Fragment,{children:[r.jsx(a,{size:18,className:"spin"}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(s,{size:18}),m.getStarted||"Generate"]})}),I&&r.jsxs("div",{style:{marginTop:"24px"},className:"animate-fadeInUp",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[r.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Output"}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[E&&r.jsxs("button",{onClick:()=>{W?D():I&&V(I)},style:{background:W?"rgba(168, 85, 247, 0.2)":"none",border:"none",color:W?"var(--color-purple)":"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.8rem",padding:"4px 8px",borderRadius:"6px"},title:W?"Stop speaking":"Read aloud",children:[W?r.jsx(l,{size:14}):r.jsx(c,{size:14}),W?"Stop":"Listen"]}),r.jsxs("button",{onClick:()=>{I&&(navigator.clipboard.writeText(I),A(!0),t.success("Copied to clipboard"),setTimeout(()=>A(!1),2e3))},style:{background:"none",border:"none",color:U?"var(--color-green)":"var(--text-secondary)",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.8rem"},children:[U?r.jsx(d,{size:14}):r.jsx(p,{size:14}),U?"Copied!":"Copy"]})]})]}),r.jsx("div",{style:{background:"var(--color-bg-primary)",border:"1px solid var(--border-color)",borderRadius:"12px",padding:"16px",maxHeight:"200px",overflowY:"auto",whiteSpace:"pre-wrap",fontSize:"0.95rem",lineHeight:"1.6"},children:I}),r.jsx("div",{style:{marginTop:"16px"},children:N?r.jsxs("div",{className:"save-options animate-fadeIn",style:{background:"var(--color-bg-tertiary)",borderRadius:"12px",padding:"16px",border:"1px solid var(--border-color)"},children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"8px"},children:[r.jsx(u,{size:14,style:{verticalAlign:"middle",marginRight:"6px"}}),"Create new project"]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx("input",{type:"text",value:$,onChange:e=>L(e.target.value),placeholder:"Project name...",style:{flex:1,padding:"10px 12px",background:"var(--color-bg-primary)",border:"1px solid var(--border-color)",borderRadius:"8px",color:"var(--text-primary)",fontSize:"0.9rem"}}),r.jsx("button",{onClick:()=>{if(!$.trim())return void t.error("Please enter a project name");const e={id:Date.now(),type:"text",agent:m.id,agentName:m.name,prompt:j,output:I,createdAt:(new Date).toISOString()};v($.trim(),e),F(!1),L(""),t.success(`Created project "${$}"`)},disabled:!$.trim(),className:"cta-button-premium",style:{padding:"10px 16px"},children:"Create"})]})]}),y.length>0&&r.jsxs("div",{children:[r.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"8px"},children:"Or add to existing project"}),r.jsx("div",{style:{maxHeight:"150px",overflowY:"auto"},children:y.slice(0,5).map(e=>r.jsxs("button",{onClick:()=>(e=>{const r={id:Date.now(),type:"text",agent:m.id,agentName:m.name,prompt:j,output:I,createdAt:(new Date).toISOString()};f(e.id,r),F(!1),t.success(`Saved to ${e.name}`)})(e),style:{width:"100%",padding:"10px 12px",background:"var(--color-bg-primary)",border:"1px solid var(--border-color)",borderRadius:"8px",color:"var(--text-primary)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px",fontSize:"0.9rem"},children:[r.jsx("span",{children:e.name}),r.jsx(g,{size:16,style:{color:"var(--text-secondary)"}})]},e.id))})]}),r.jsx("button",{onClick:()=>F(!1),style:{marginTop:"12px",background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",fontSize:"0.85rem",width:"100%",textAlign:"center"},children:"Cancel"})]}):r.jsxs("button",{onClick:()=>F(!0),style:{width:"100%",padding:"12px",background:"var(--color-bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"10px",color:"var(--text-primary)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r.jsx(x,{size:16}),"Save to Project"]})})]})]})]})})}export{m as default};
